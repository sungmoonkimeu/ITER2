

<!DOCTYPE html>
<html class="writer-html4" lang="English" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Put in limits &mdash; Python polarization 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Python polarization
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">1. Python polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">3. Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">4. py_pol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">5. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">6. Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">7. History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python polarization</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Put in limits</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/source/development/2D/Utils.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">py_pol</span> <span class="k">import</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">py_pol.utils</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Put-in-limits">
<h1>Put in limits<a class="headerlink" href="#Put-in-limits" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Put in limits</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">put_in_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">4</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">put_in_limits</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;delta&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-89.06  62.22  66.68 -55.19  67.81  -8.37  76.22  42.18 -30.52 -77.22]
[89.06 62.22 66.68 55.19 67.81  8.37 76.22 42.18 30.52 77.22]

[ 143.48 -211.12 -322.06  156.24  322.33  198.9   213.7  -112.24 -235.96
  270.33]
[143.48 148.88  37.94 156.24 322.33 198.9  213.7  247.76 124.04 270.33]

</pre></div></div>
</div>
</div>
<div class="section" id="Transform-charac-angles-in-azimuth-and-ellipticity">
<h1>Transform charac angles in azimuth and ellipticity<a class="headerlink" href="#Transform-charac-angles-in-azimuth-and-ellipticity" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span><span class="o">=</span><span class="mi">100</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha: &#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta: &#39;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">az</span><span class="p">,</span> <span class="n">el</span> <span class="o">=</span> <span class="n">charac_angles_2_azimuth_elipt</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Azimuth: &#39;</span><span class="p">,</span> <span class="n">az</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ellipticity: &#39;</span><span class="p">,</span> <span class="n">el</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">alpha2</span><span class="p">,</span> <span class="n">delta2</span> <span class="o">=</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">(</span><span class="n">az</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New alpha: &#39;</span><span class="p">,</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New delta: &#39;</span><span class="p">,</span> <span class="n">delta2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">Amatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">alpha2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="n">Dmatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span> <span class="o">-</span> <span class="n">delta2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match alpha: &#39;</span><span class="p">,</span> <span class="n">Amatch</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match delta: &#39;</span><span class="p">,</span> <span class="n">Dmatch</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Alpha:  [73.61 69.58 58.24 38.43  7.9  20.47  3.1  71.4  62.36 28.67  0.6  79.21
 64.94 86.74 15.99 77.38  5.79 73.34 17.32 49.3  49.94 52.88 76.32 22.76
 64.4  18.98  7.71 41.75 13.88 55.83 77.35 42.2  50.76 72.44 20.55 80.92
 79.29 32.1  64.67 15.03 58.37  0.67 68.55 31.52 79.55 83.33 63.47 50.18
 38.54 23.11 19.46 65.98 10.22 22.72 26.42 45.3  48.6  38.01 76.3  60.43
 17.98 85.42 78.88 14.56 35.43 65.66 67.46 80.28 67.13 89.27 65.75 81.93
  1.93 63.97 39.59 82.38 88.22 72.59 20.81 22.54 49.44 48.64 10.79 32.87
 42.62 68.12 19.71  8.56 35.24  7.58 69.09  3.08 49.39 72.06 47.06 47.81
 81.66 81.61 10.02 21.76]
Delta:  [198.05 342.42 181.74  32.36  58.99 112.07  68.21 312.96  62.86 313.98
 245.42  53.57 226.82 341.88 228.9  184.27 200.82 348.17 108.74 143.54
 190.   325.78 234.24  93.87 212.82  45.3   86.47  37.49 291.13  77.05
 132.66 160.62 182.99 201.62 257.14  86.85  55.28 118.51 142.01 169.97
  65.43  76.21 326.24 276.87 192.87 176.27  97.39 153.18 272.96 329.99
  94.27 112.99 194.07 160.74 296.43 306.08 284.5  324.89 266.14 158.37
 108.5  220.55 116.86 282.41 157.18 314.92 325.04 358.8  198.71 199.28
 283.63 359.    22.35  82.8   98.36  56.2  309.25 208.09 121.72 261.98
 133.17 319.85 356.96 322.08 159.    85.96 237.43 189.69 290.03  63.53
  63.04   2.   194.08 206.89 175.91 269.23 165.3  321.7  250.5   83.08]

Azimuth:  [105.74  70.25 121.76  37.28   4.15 170.97   1.15  76.32  73.32  23.64
 179.75  83.39 109.66  86.9  168.84 102.59 174.58  73.62 173.74 129.68
 129.99  54.42  98.41 178.04 113.13  14.38   0.49  40.91   5.37  75.28
  98.88 137.97 129.23 106.59 174.51  89.48  83.7  157.69 111.94 165.16
  70.23   0.16  71.16   6.62 100.2   96.66  94.86 129.21   6.33  21.06
 178.28 101.74 170.06 158.11  15.21  45.5   58.38  36.54  91.   118.64
 173.52  93.49  95.24   3.41 145.31  70.62  70.3   80.29 112.09  90.69
  82.55  81.93   1.78  85.43 161.37  85.69  88.87 105.77 167.48 176.02
 128.57  49.75  10.77  30.13 137.55  88.07 168.07 171.55  22.     3.44
  78.96   3.08 130.48 106.41 132.93  93.9   98.08  83.34 176.53   3.26]
Ellipticity:  [ -4.83  -5.7   -0.78  15.71   6.75  18.69   2.87 -13.13  23.5  -18.64
  -0.54   8.6  -17.02  -1.01 -11.76  -0.91  -2.04  -3.23  16.28  17.99
  -4.93 -16.39 -10.95  22.69 -12.49  12.96   7.7   18.6  -12.88  32.46
   9.16   9.64  -1.46  -6.12 -19.93   9.06   8.73  26.15  14.21   2.5
  27.15   0.65 -11.11 -31.12  -2.28   0.43  26.21  13.17 -38.37 -10.59
  19.4   21.6   -2.44   6.8  -22.76 -26.96 -36.92 -16.96 -13.67   9.22
  16.92  -2.97   9.87 -14.19  10.75 -16.06 -11.97  -0.2   -6.64  -0.24
 -23.35  -0.14   0.73  25.74  38.18   6.31  -1.38  -7.8   17.2  -22.26
  23.05 -19.88  -0.56 -17.04  10.46  21.81 -16.18  -1.42 -31.16   6.77
  18.24   0.11  -6.95  -7.68   2.04 -42.17   2.09  -5.15  -9.42  21.57]

New alpha:  [73.61 69.58 58.24 38.43  7.9  20.47  3.1  71.4  62.36 28.67  0.6  79.21
 64.94 86.74 15.99 77.38  5.79 73.34 17.32 49.3  49.94 52.88 76.32 22.76
 64.4  18.98  7.71 41.75 13.88 55.83 77.35 42.2  50.76 72.44 20.55 80.92
 79.29 32.1  64.67 15.03 58.37  0.67 68.55 31.52 79.55 83.33 63.47 50.18
 38.54 23.11 19.46 65.98 10.22 22.72 26.42 45.3  48.6  38.01 76.3  60.43
 17.98 85.42 78.88 14.56 35.43 65.66 67.46 80.28 67.13 89.27 65.75 81.93
  1.93 63.97 39.59 82.38 88.22 72.59 20.81 22.54 49.44 48.64 10.79 32.87
 42.62 68.12 19.71  8.56 35.24  7.58 69.09  3.08 49.39 72.06 47.06 47.81
 81.66 81.61 10.02 21.76]
New delta:  [198.05 342.42 181.74  32.36  58.99 112.07  68.21 312.96  62.86 313.98
 245.42  53.57 226.82 341.88 228.9  184.27 200.82 348.17 108.74 143.54
 190.   325.78 234.24  93.87 212.82  45.3   86.47  37.49 291.13  77.05
 132.66 160.62 182.99 201.62 257.14  86.85  55.28 118.51 142.01 169.97
  65.43  76.21 326.24 276.87 192.87 176.27  97.39 153.18 272.96 329.99
  94.27 112.99 194.07 160.74 296.43 306.08 284.5  324.89 266.14 158.37
 108.5  220.55 116.86 282.41 157.18 314.92 325.04 358.8  198.71 199.28
 283.63 359.    22.35  82.8   98.36  56.2  309.25 208.09 121.72 261.98
 133.17 319.85 356.96 322.08 159.    85.96 237.43 189.69 290.03  63.53
  63.04   2.   194.08 206.89 175.91 269.23 165.3  321.7  250.5   83.08]

Match alpha:  [ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]
Match delta:  [ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha: &#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta: &#39;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">az</span><span class="p">,</span> <span class="n">el</span> <span class="o">=</span> <span class="n">charac_angles_2_azimuth_elipt</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Azimuth: &#39;</span><span class="p">,</span> <span class="n">az</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ellipticity: &#39;</span><span class="p">,</span> <span class="n">el</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">alpha2</span><span class="p">,</span> <span class="n">delta2</span> <span class="o">=</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">(</span><span class="n">az</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New alpha: &#39;</span><span class="p">,</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New delta: &#39;</span><span class="p">,</span> <span class="n">delta2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">Amatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">alpha2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="n">Dmatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta</span> <span class="o">-</span> <span class="n">delta2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match alpha: &#39;</span><span class="p">,</span> <span class="n">Amatch</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match delta: &#39;</span><span class="p">,</span> <span class="n">Dmatch</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Alpha:  [ 0. 45. 90.]
Delta:  360.0

Azimuth:  [ 0. 45. 90.]
Ellipticity:  [0. 0. 0.]

New alpha:  [ 0. 45. 90.]
New delta:  [0. 0. 0.]

Match alpha:  [ True  True  True]
Match delta:  [False False False]

</pre></div></div>
</div>
</div>
<div class="section" id="Transform-azimuth-and-ellipticity-in-charac-angles">
<h1>Transform azimuth and ellipticity in charac angles<a class="headerlink" href="#Transform-azimuth-and-ellipticity-in-charac-angles" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">az</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">el</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Azimuth: &#39;</span><span class="p">,</span> <span class="n">az</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ellipticity: &#39;</span><span class="p">,</span> <span class="n">el</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">(</span><span class="n">az</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha: &#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta: &#39;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">az2</span><span class="p">,</span> <span class="n">el2</span> <span class="o">=</span> <span class="n">charac_angles_2_azimuth_elipt</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New azimuth: &#39;</span><span class="p">,</span> <span class="n">az2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New ellipticity: &#39;</span><span class="p">,</span> <span class="n">el2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">Amatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">az</span> <span class="o">-</span> <span class="n">az2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="n">Dmatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">el2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match azimuth: &#39;</span><span class="p">,</span> <span class="n">Amatch</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match ellipticity: &#39;</span><span class="p">,</span> <span class="n">Dmatch</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Azimuth:  [105.62   9.16  63.77 162.27   2.97  40.17 126.   137.86  56.     8.22
  76.63  74.13  89.86 141.07  65.49  36.76  18.24  82.08  92.62 131.02
   0.65  37.94 111.53 160.28  79.17  85.57 133.43 124.3  116.55  90.96
 108.71  25.92 140.17 174.68  70.02  55.26 130.11 114.02  76.5  121.56
  33.6   63.86 120.72  63.    19.47  32.86  80.92   5.95  75.83  55.28
 108.43  28.11  49.68   9.65  31.59  27.58  45.62  32.17 161.76  62.18
 170.6   31.46  41.66  74.53 155.43 163.83 104.84 146.43 171.46  40.22
   5.95  88.78 133.4   10.74 176.46  64.98   0.95  95.9  165.57  86.11
  64.18 131.58   9.06 167.88  69.15 150.01   4.89  60.36  94.82  19.91
 130.84 113.78   8.17 104.44  47.32  54.27  91.58 145.55 116.93 171.49]
Ellipticity:  [ 24.92  22.48  42.47   4.9  -17.15 -25.71  22.76 -30.04 -42.67 -37.79
   6.28  -1.42 -38.03 -26.66  19.54  40.7   10.96  13.04 -30.96 -20.65
  -2.14 -39.74   9.39  -8.87 -41.2  -21.31  22.45 -13.98   0.05  -5.07
  -7.68  -5.52  14.96 -19.36  31.92  38.72  44.41   9.01 -37.5   27.62
  36.36 -10.31  36.58   1.91  31.63  40.83  14.88  -9.74  32.81 -33.76
  32.23  -9.63  38.97 -24.51  -8.31 -15.82 -43.95   3.67  20.48  27.39
 -27.58   7.4   22.82 -21.9    0.2  -26.08  39.7  -43.58  37.47  15.58
   1.08 -30.44  27.95  -4.98 -38.13   7.39 -14.34   1.06 -32.33 -41.07
 -31.27 -27.13 -20.16   3.97   0.02 -34.8    7.45  -7.22 -11.76  -4.02
   0.21  22.54 -15.12  20.59 -11.61 -39.73 -19.82  29.55  23.24 -17.21]

Alpha:  [61.73 23.9  46.54 18.3  17.37 42.   51.25 43.57 45.87 38.09 75.33 74.07
 51.97 41.39 60.3  43.79 20.88 74.89 58.98 47.98  2.24 43.72 66.89 21.33
 48.53 68.32 46.11 54.4  63.45 84.84 69.99 26.33 40.52 19.96 54.88 47.19
 45.1  64.74 51.67 52.47 41.69 62.47 48.98 62.95 34.76 43.29 72.79 11.35
 55.65 48.86 55.09 29.17 45.97 25.88 32.2  30.45 45.02 32.29 26.3  54.5
 28.63 31.94 42.67 64.12 24.57 29.39 49.6  44.45 37.81 40.91  6.05 59.55
 45.89 11.79 38.19 64.2  14.36 84.01 33.99 48.89 53.31 47.   21.78 12.72
 69.15 39.98  8.88 59.82 77.34 20.25 49.16 59.23 17.   65.61 47.14 46.67
 70.12 39.67 56.98 18.96]
Delta:  [113.65  72.53  85.98 163.43 278.63 308.19 133.04 240.2  274.33 274.16
  26.36 354.6  270.07 233.94  47.09  81.76  34.09  60.85 267.21 221.57
 286.91 280.21 153.51 206.73 272.82 279.5  135.06 209.68 179.88 259.41
 204.34 346.06 149.68 257.03  72.49  78.21  91.16 156.36 276.94 121.76
  74.   334.57 104.88   4.71  72.42  82.4   61.42 300.23  77.86 291.17
 106.   337.2   78.09 286.02 341.5  323.1  272.1    8.13 124.41  59.78
 257.36  16.52  45.84 298.19 179.47 247.44  95.29 267.38  94.52  31.51
  10.34 271.36 124.07 334.38 268.28  18.99 273.46 169.69 257.12 271.07
 292.18 234.46 290.11 161.22   0.07 252.16  57.43 343.32 248.94 347.57
 179.58 126.35 295.76 118.9  336.72 280.01 266.19 119.18 127.48 246.87]

New azimuth:  [105.62   9.16  63.77 162.27   2.97  40.17 126.   137.86  56.     8.22
  76.63  74.13  89.86 141.07  65.49  36.76  18.24  82.08  92.62 131.02
   0.65  37.94 111.53 160.28  79.17  85.57 133.43 124.3  116.55  90.96
 108.71  25.92 140.17 174.68  70.02  55.26 130.11 114.02  76.5  121.56
  33.6   63.86 120.72  63.    19.47  32.86  80.92   5.95  75.83  55.28
 108.43  28.11  49.68   9.65  31.59  27.58  45.62  32.17 161.76  62.18
 170.6   31.46  41.66  74.53 155.43 163.83 104.84 146.43 171.46  40.22
   5.95  88.78 133.4   10.74 176.46  64.98   0.95  95.9  165.57  86.11
  64.18 131.58   9.06 167.88  69.15 150.01   4.89  60.36  94.82  19.91
 130.84 113.78   8.17 104.44  47.32  54.27  91.58 145.55 116.93 171.49]
New ellipticity:  [ 24.92  22.48  42.47   4.9  -17.15 -25.71  22.76 -30.04 -42.67 -37.79
   6.28  -1.42 -38.03 -26.66  19.54  40.7   10.96  13.04 -30.96 -20.65
  -2.14 -39.74   9.39  -8.87 -41.2  -21.31  22.45 -13.98   0.05  -5.07
  -7.68  -5.52  14.96 -19.36  31.92  38.72  44.41   9.01 -37.5   27.62
  36.36 -10.31  36.58   1.91  31.63  40.83  14.88  -9.74  32.81 -33.76
  32.23  -9.63  38.97 -24.51  -8.31 -15.82 -43.95   3.67  20.48  27.39
 -27.58   7.4   22.82 -21.9    0.2  -26.08  39.7  -43.58  37.47  15.58
   1.08 -30.44  27.95  -4.98 -38.13   7.39 -14.34   1.06 -32.33 -41.07
 -31.27 -27.13 -20.16   3.97   0.02 -34.8    7.45  -7.22 -11.76  -4.02
   0.21  22.54 -15.12  20.59 -11.61 -39.73 -19.82  29.55  23.24 -17.21]

Match azimuth:  [ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]
Match ellipticity:  [ True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">az</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">el</span> <span class="o">=</span> <span class="mi">45</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Azimuth: &#39;</span><span class="p">,</span> <span class="n">az</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ellipticity: &#39;</span><span class="p">,</span> <span class="n">el</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">(</span><span class="n">az</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha: &#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta: &#39;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">az2</span><span class="p">,</span> <span class="n">el2</span> <span class="o">=</span> <span class="n">charac_angles_2_azimuth_elipt</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New azimuth: &#39;</span><span class="p">,</span> <span class="n">az2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New ellipticity: &#39;</span><span class="p">,</span> <span class="n">el2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">Amatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">az</span> <span class="o">-</span> <span class="n">az2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="n">Dmatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">el2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match azimuth: &#39;</span><span class="p">,</span> <span class="n">Amatch</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match ellipticity: &#39;</span><span class="p">,</span> <span class="n">Dmatch</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Azimuth:  [  0.  45.  90. 135. 180.]
Ellipticity:  45.0

Alpha:  [45. 45. 45. 45. 45.]
Delta:  [270. 270. 270. 270. 270.]

New azimuth:  [0. 0. 0. 0. 0.]
New ellipticity:  [45. 45. 45. 45. 45.]

Match azimuth:  [ True False False False False]
Match ellipticity:  [ True  True  True  True  True]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">az</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">el</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">])</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Azimuth: &#39;</span><span class="p">,</span> <span class="n">az</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ellipticity: &#39;</span><span class="p">,</span> <span class="n">el</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">(</span><span class="n">az</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha: &#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta: &#39;</span><span class="p">,</span> <span class="n">delta</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">az2</span><span class="p">,</span> <span class="n">el2</span> <span class="o">=</span> <span class="n">charac_angles_2_azimuth_elipt</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New azimuth: &#39;</span><span class="p">,</span> <span class="n">az2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;New ellipticity: &#39;</span><span class="p">,</span> <span class="n">el2</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">Amatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">az</span> <span class="o">-</span> <span class="n">az2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="n">Dmatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">el</span> <span class="o">-</span> <span class="n">el2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match azimuth: &#39;</span><span class="p">,</span> <span class="n">Amatch</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Match ellipticity: &#39;</span><span class="p">,</span> <span class="n">Dmatch</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Azimuth:  [nan nan nan]
Ellipticity:  [ 30.  45. -45.]

[False False False] [0. 0. 0.]
[False  True  True] [0.   1.57 4.71]
[False False False] [0.   1.57 4.71]
[ True False False] [ nan 1.57 4.71]
[False False False] [ nan 1.57 4.71]
Alpha:  [nan 45. 45.]
Delta:  [ nan  90. 270.]

New azimuth:  [nan  0.  0.]
New ellipticity:  [ nan -45.  45.]

Match azimuth:  [False False False]
Match ellipticity:  [False False False]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo\py_pol\py_pol\utils.py:662: RuntimeWarning: invalid value encountered in greater
  cond2 = cond1 * (azimuth &gt; np.pi / 2)
d:\codigo\py_pol\py_pol\utils.py:864: RuntimeWarning: invalid value encountered in greater
  q = q + 3 * (angle &gt; np.pi / 2) * (angle &lt; np.pi * 3 / 4)
d:\codigo\py_pol\py_pol\utils.py:864: RuntimeWarning: invalid value encountered in less
  q = q + 3 * (angle &gt; np.pi / 2) * (angle &lt; np.pi * 3 / 4)
d:\codigo\py_pol\py_pol\utils.py:865: RuntimeWarning: invalid value encountered in greater
  q = q + 3.5 * (angle == np.pi * 3 / 4)
d:\codigo\py_pol\py_pol\utils.py:865: RuntimeWarning: invalid value encountered in less
  q = q + 3.5 * (angle == np.pi * 3 / 4)
d:\codigo\py_pol\py_pol\utils.py:867: RuntimeWarning: invalid value encountered in greater
  q = q + 4.5 * (angle == np.pi)
d:\codigo\py_pol\py_pol\utils.py:867: RuntimeWarning: invalid value encountered in less
  q = q + 4.5 * (angle == np.pi)
d:\codigo\py_pol\py_pol\utils.py:869: RuntimeWarning: invalid value encountered in greater
  q = q + 1 * (angle &gt; 0) * (angle &lt; np.pi / 2)
d:\codigo\py_pol\py_pol\utils.py:869: RuntimeWarning: invalid value encountered in less
  q = q + 1 * (angle &gt; 0) * (angle &lt; np.pi / 2)
d:\codigo\py_pol\py_pol\utils.py:871: RuntimeWarning: invalid value encountered in greater
  q = q + 2 * (angle &gt; np.pi / 2) * (angle &lt; np.pi)
d:\codigo\py_pol\py_pol\utils.py:871: RuntimeWarning: invalid value encountered in less
  q = q + 2 * (angle &gt; np.pi / 2) * (angle &lt; np.pi)
d:\codigo\py_pol\py_pol\utils.py:738: RuntimeWarning: invalid value encountered in less
  cond2 = (alpha &lt; eps) + (np.abs(alpha - np.pi / 2) &lt; eps)
d:\codigo\py_pol\py_pol\utils.py:739: RuntimeWarning: invalid value encountered in less
  azimuth[cond2] = alpha[cond2]
d:\codigo\py_pol\py_pol\utils.py:740: RuntimeWarning: invalid value encountered in less
  # Calculate values using trigonometric functions
d:\codigo\py_pol\py_pol\utils.py:743: RuntimeWarning: invalid value encountered in less
  ellipticity[cond1] = 0.5 * np.arcsin(
d:\codigo\py_pol\py_pol\utils.py:874: RuntimeWarning: invalid value encountered in greater
  q = q + 3.5 * (angle == np.pi * 3 / 2)
d:\codigo\py_pol\py_pol\utils.py:874: RuntimeWarning: invalid value encountered in less
  q = q + 3.5 * (angle == np.pi * 3 / 2)
d:\codigo\py_pol\py_pol\utils.py:876: RuntimeWarning: invalid value encountered in greater
  return q
d:\codigo\py_pol\py_pol\utils.py:876: RuntimeWarning: invalid value encountered in less
  return q
d:\codigo\py_pol\py_pol\utils.py:878: RuntimeWarning: invalid value encountered in greater

d:\codigo\py_pol\py_pol\utils.py:878: RuntimeWarning: invalid value encountered in less

d:\codigo\py_pol\py_pol\utils.py:880: RuntimeWarning: invalid value encountered in greater
  &#34;&#34;&#34;When dealing with polarization elipse coordinates, make sure that they
d:\codigo\py_pol\py_pol\utils.py:880: RuntimeWarning: invalid value encountered in less
  &#34;&#34;&#34;When dealing with polarization elipse coordinates, make sure that they
C:\Users\Jesus\Anaconda3\lib\site-packages\ipykernel_launcher.py:14: RuntimeWarning: invalid value encountered in less

C:\Users\Jesus\Anaconda3\lib\site-packages\ipykernel_launcher.py:15: RuntimeWarning: invalid value encountered in less
  from ipykernel import kernelapp as app
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ True]
</pre></div></div>
</div>
</div>
<div class="section" id="Rotation-Jones">
<h1>Rotation Jones<a class="headerlink" href="#Rotation-Jones" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">angle</span> <span class="o">=</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rotation_matrix_Jones</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">))</span>

<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">rotation_matrix_Jones</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">rotation_matrix_Jones</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">py_pol.jones_matrix</span> <span class="k">import</span> <span class="n">Jones_matrix</span>
<span class="n">J1</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">J1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J1</span><span class="p">)</span>
<span class="n">J2</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">J2</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J2</span><span class="p">)</span>
<span class="n">J3</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
<span class="n">J3</span><span class="o">.</span><span class="n">diattenuator_perfect</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J3</span><span class="p">)</span>
<span class="n">J4</span> <span class="o">=</span> <span class="n">J2</span> <span class="o">*</span> <span class="p">(</span><span class="n">J3</span> <span class="o">*</span> <span class="n">J1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[[ 0.]
  [-1.]]

 [[ 1.]
  [ 0.]]]
[[[ 1.  0.]
  [ 0.  1.]]

 [[-0. -1.]
  [ 1.  0.]]]
 [[[ 1.  0.]
  [-0. -1.]]

 [[ 0.  1.]
  [ 1.  0.]]]
+ =
[+1.000 +0.000]   [+0.000 +1.000]
[-0.000 +1.000]   [-1.000 +0.000]

- =
[+1.000 -0.000]   [+0.000 -1.000]
[+0.000 +1.000]   [+1.000 +0.000]

P =
[+1.000 +0.000]
[+0.000 +0.000]

- * P * + =
[+1.000 +0.000]   [+0.000 +0.000]
[+0.000 +0.000]   [+0.000 +1.000]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">rotation_matrix_Jones</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">rotation_matrix_Jones</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">py_pol.jones_matrix</span> <span class="k">import</span> <span class="n">Jones_matrix</span>
<span class="n">J1</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">J1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J1</span><span class="p">)</span>
<span class="n">J2</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">J2</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J2</span><span class="p">)</span>
<span class="n">J3</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
<span class="n">J3</span><span class="o">.</span><span class="n">diattenuator_perfect</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J3</span><span class="p">)</span>
<span class="n">J4</span> <span class="o">=</span> <span class="n">J2</span> <span class="o">*</span> <span class="n">J3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[[ 1.  0.]
  [ 0.  1.]]

 [[-0. -1.]
  [ 1.  0.]]]
 [[[ 1.  0.]
  [-0. -1.]]

 [[ 0.  1.]
  [ 1.  0.]]]
[2 2 2]
0 1
+ =
[+1.000 +0.000]   [+0.000 +1.000]
[-0.000 +1.000]   [-1.000 +0.000]

[2 2 2]
0 1
- =
[+1.000 -0.000]   [+0.000 -1.000]
[+0.000 +1.000]   [+1.000 +0.000]

[2 2 1]
0 1
[2 2 1]
0 1
[2 2 1]
0 1
P =
[+1.000 +0.000]
[+0.000 +0.000]

[2 2 2]
0 1
[2 2 2]
0 1
- * P =
[+1.000 +0.000]   [+0.000 +0.000]
[+0.000 +1.000]   [+0.000 +0.000]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo\py_pol\py_pol\jones_matrix.py:514: ComplexWarning: Casting complex values to real discards the imaginary part
  self.M = np.array(self.M, dtype=float)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2
</pre></div></div>
</div>
</div>
<div class="section" id="Inverse_pypol">
<h1>Inverse_pypol<a class="headerlink" href="#Inverse_pypol" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">]]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">inv_pypol</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-5.  2.]
 [ 3. -1.]]
[[[-5.]
  [ 2.]]

 [[ 3.]
  [-1.]]]
</pre></div></div>
</div>
</div>
<div class="section" id="matmul_pypol">
<h1>matmul_pypol<a class="headerlink" href="#matmul_pypol" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">]]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">]]])</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">matmul_pypol</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">]]])</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">matmul_pypol</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[[ 20]
  [201]]

 [[ 50]
  [503]]]
(2, 2, 1) (2, 2, 1)
[[[2]]

 [[5]]]
(2, 2, 1) (2, 1, 1)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Luis Miguel Sanchez Brea / Jesus del Hoyo

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>