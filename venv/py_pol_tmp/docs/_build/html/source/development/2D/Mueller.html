

<!DOCTYPE html>
<html class="writer-html4" lang="English" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Create arrays &mdash; Python polarization 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Python polarization
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">1. Python polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">3. Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">4. py_pol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">5. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">6. Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">7. History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python polarization</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Create arrays</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/source/development/2D/Mueller.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">py_pol</span> <span class="k">import</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">py_pol.mueller</span> <span class="k">import</span> <span class="n">Mueller</span><span class="p">,</span> <span class="n">create_Mueller</span><span class="p">,</span> <span class="n">set_printoptions</span>
<span class="kn">from</span> <span class="nn">py_pol.stokes</span> <span class="k">import</span> <span class="n">Stokes</span>
<span class="kn">from</span> <span class="nn">py_pol.jones_matrix</span> <span class="k">import</span> <span class="n">Jones_matrix</span>
<span class="kn">from</span> <span class="nn">py_pol.utils</span> <span class="k">import</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">,</span> <span class="n">charac_angles_2_azimuth_elipt</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">linewidth</span> <span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Create-arrays">
<h1>Create arrays<a class="headerlink" href="#Create-arrays" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create several objectsat once</span>
<span class="nb">print</span><span class="p">(</span><span class="n">create_Mueller</span><span class="p">([</span><span class="s1">&#39;J1&#39;</span><span class="p">,</span> <span class="s1">&#39;J2&#39;</span><span class="p">,</span> <span class="s1">&#39;J3&#39;</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">create_Mueller</span><span class="p">([</span><span class="s1">&#39;J1&#39;</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">create_Mueller</span><span class="p">(</span><span class="s1">&#39;J1&#39;</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>

<span class="n">J1</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span> <span class="n">J3</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">([</span><span class="s1">&#39;J1&#39;</span><span class="p">,</span> <span class="s1">&#39;J2&#39;</span><span class="p">,</span> <span class="s1">&#39;J3&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J1</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span> <span class="n">J3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[J1 is empty
, J2 is empty
, J3 is empty
]
J1 is empty

[J1 is empty
, J1 is empty
, J1 is empty
]
J1 is empty
 J2 is empty
 J3 is empty

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># From_components</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_components</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span> <span class="p">,</span><span class="mi">9</span> <span class="p">,</span><span class="mi">12</span> <span class="p">,</span><span class="mi">13</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="mi">3</span><span class="o">+</span><span class="n">ind</span><span class="p">))</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="mi">6</span><span class="o">+</span><span class="n">ind</span><span class="p">))</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">ind</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.500 +0.500 +0.000]
[+1.000 +2.000 +3.000 +4.000]
[+5.000 +6.000 +7.000 +8.000]
[+9.000 +12.000 +13.000 +16.000]

M =
[+0.000 +1.000 +2.000 +3.000]   [+1.000 +2.000 +3.000 +4.000]   [+2.000 +3.000 +4.000 +5.000]
[+4.000 +5.000 +6.000 +7.000]   [+5.000 +6.000 +7.000 +8.000]   [+6.000 +7.000 +8.000 +9.000]
[+8.000 +9.000 +10.000 +11.000]   [+9.000 +10.000 +11.000 +12.000]   [+10.000 +11.000 +12.000 +13.000]
[+12.000 +13.000 +14.000 +15.000]   [+13.000 +14.000 +15.000 +16.000]   [+14.000 +15.000 +16.000 +17.000]

M M00 = [0 1 2 3 4 5]
  M01 = [1 2 3 4 5 6]
  M02 = [2 3 4 5 6 7]
  M03 = [3 4 5 6 7 8]
  M10 = [4 5 6 7 8 9]
  M11 = [ 5  6  7  8  9 10]
  M12 = [ 6  7  8  9 10 11]
  M13 = [ 7  8  9 10 11 12]
  M20 = [ 8  9 10 11 12 13]
  M21 = [ 9 10 11 12 13 14]
  M22 = [10 11 12 13 14 15]
  M23 = [11 12 13 14 15 16]
  M30 = [12 13 14 15 16 17]
  M31 = [13 14 15 16 17 18]
  M32 = [14 15 16 17 18 19]
  M33 = [15 16 17 18 19 20]

M M00 =
 [[0.274  0.1526 0.9541]
 [0.8719 0.2419 0.0543]
 [0.8259 0.8111 0.9266]]
M M01 =
 [[1.9574 1.1369 1.8594]
 [1.5649 1.4184 1.3793]
 [1.8469 1.4677 1.4219]]
M M02 =
 [[2.5042 2.0875 2.6735]
 [2.6469 2.9948 2.9809]
 [2.43   2.5668 2.6359]]
M M03 =
 [[3.5783 3.2012 3.1885]
 [3.7186 3.5537 3.7298]
 [3.5429 3.1787 3.3002]]
M M10 =
 [[4.3103 4.6988 4.8134]
 [4.8445 4.8603 4.8499]
 [4.5992 4.651  4.4735]]
M M11 =
 [[5.4921 5.7695 5.3468]
 [5.5582 5.8379 5.3274]
 [5.2723 5.1393 5.8344]]
M M12 =
 [[6.6652 6.8005 6.2697]
 [6.9179 6.7782 6.5298]
 [6.3444 6.1802 6.9733]]
M M13 =
 [[7.1759 7.4258 7.9192]
 [7.9272 7.2501 7.7619]
 [7.5073 7.7836 7.3598]]
M M20 =
 [[8.6593 8.4803 8.4605]
 [8.0813 8.3235 8.1016]
 [8.9375 8.9056 8.3073]]
M M21 =
 [[9.2021 9.6254 9.4063]
 [9.9107 9.0359 9.3639]
 [9.4547 9.1415 9.2668]]
M M22 =
 [[10.4005 10.9752 10.0386]
 [10.6432 10.1449 10.765 ]
 [10.9289 10.6219 10.5254]]
M M23 =
 [[11.772  11.383  11.3977]
 [11.4423 11.2052 11.8315]
 [11.3269 11.6275 11.3978]]
M M30 =
 [[12.2691 12.6281 12.0972]
 [12.3269 12.678  12.1067]
 [12.8577 12.0924 12.7107]]
M M31 =
 [[13.0677 13.8669 13.946 ]
 [13.2569 13.9232 13.7858]
 [13.1214 13.2722 13.0121]]
M M32 =
 [[14.7178 14.9436 14.7491]
 [14.8644 14.3246 14.704 ]
 [14.611  14.786  14.8906]]
M M33 =
 [[15.0406 15.4847 15.3343]
 [15.5751 15.9169 15.1397]
 [15.8534 15.3818 15.4602]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># From_matrix</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +1.000 +0.000]
[+0.000 +0.000 +0.000 +1.000]

M =
[+0.655 +0.399 +0.125 +0.210]   [+0.401 +0.130 +0.236 +0.606]   [+0.118 +0.916 +0.975 +0.761]
[+0.349 +0.262 +0.086 +0.323]   [+0.859 +0.269 +0.109 +0.711]   [+0.714 +0.128 +0.790 +0.361]
[+0.844 +0.058 +0.512 +0.874]   [+0.618 +0.760 +0.814 +0.879]   [+0.365 +0.586 +0.974 +0.274]
[+0.527 +0.361 +0.893 +0.925]   [+0.978 +0.064 +0.017 +0.669]   [+0.755 +0.416 +0.769 +0.766]

M M00 =
 [[0.5813 0.7944]
 [0.3007 0.3889]
 [0.6038 0.5251]]
M M01 =
 [[0.9615 0.5558]
 [0.3364 0.2783]
 [0.3319 0.8312]]
M M02 =
 [[0.3806 0.9304]
 [0.7088 0.2743]
 [0.8252 0.7121]]
M M03 =
 [[0.6721 0.7406]
 [0.39   0.2086]
 [0.6697 0.6104]]
M M10 =
 [[0.4974 0.8007]
 [0.6548 0.4655]
 [0.6749 0.9656]]
M M11 =
 [[0.0625 0.5932]
 [0.443  0.4058]
 [0.2689 0.0497]]
M M12 =
 [[0.2675 0.4025]
 [0.9467 0.0384]
 [0.8251 0.8576]]
M M13 =
 [[0.6061 0.3993]
 [0.4605 0.5696]
 [0.7873 0.2531]]
M M20 =
 [[0.4163 0.9482]
 [0.0228 0.7789]
 [0.4851 0.5208]]
M M21 =
 [[0.7482 0.1146]
 [0.671  0.2053]
 [0.0227 0.503 ]]
M M22 =
 [[0.5266 0.113 ]
 [0.4966 0.0848]
 [0.4327 0.6076]]
M M23 =
 [[0.0563 0.2067]
 [0.3573 0.3881]
 [0.8753 0.6566]]
M M30 =
 [[0.5379 0.419 ]
 [0.3232 0.9235]
 [0.0794 0.529 ]]
M M31 =
 [[0.8335 0.5134]
 [0.1885 0.7012]
 [0.6444 0.8532]]
M M32 =
 [[0.3977 0.5145]
 [0.8895 0.9787]
 [0.7866 0.2961]]
M M33 =
 [[0.7779 0.1184]
 [0.4338 0.1079]
 [0.5937 0.5355]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># From blocks</span>
<span class="n">M00</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">M00</span><span class="o">=</span><span class="n">M00</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M00</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">M00</span><span class="o">=</span><span class="n">M00</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M00</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">M00</span><span class="o">=</span><span class="n">M00</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +1.500 +2.500 +3.500]
[+1.000 +4.000 +5.000 +6.000]
[+2.000 +7.000 +8.000 +9.000]
[+3.000 +10.000 +11.000 +12.000]

M =
[+2.000 +14.000 +16.000 +18.000]   [+3.000 +30.000 +33.000 +36.000]
[+8.000 +0.196 +0.344 +0.789]   [+21.000 +1.052 +2.489 +0.703]
[+10.000 +1.962 +0.600 +1.181]   [+24.000 +2.906 +0.389 +0.494]
[+12.000 +1.887 +0.913 +1.350]   [+27.000 +0.465 +2.775 +1.256]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M M00 =
 [[0.5285 0.7942 0.6552 0.6805 0.8352]
 [0.8464 0.9097 0.6346 0.6954 0.9531]
 [0.7563 0.8305 0.1752 0.1885 0.3416]
 [0.0017 0.9687 0.8828 0.7295 0.6988]]
M M01 =
 [[0.11   0.4981 0.1705 0.4185 0.0089]
 [0.288  0.6775 0.5355 0.0693 0.2771]
 [0.0125 0.4992 0.0596 0.1361 0.0197]
 [0.001  0.4058 0.0943 0.6971 0.2939]]
M M02 =
 [[0.489  0.2703 0.5897 0.3199 0.0423]
 [0.4685 0.87   0.0208 0.2588 0.8799]
 [0.4603 0.0465 0.0257 0.17   0.069 ]
 [0.0005 0.2232 0.1327 0.1443 0.4751]]
M M03 =
 [[0.3326 0.2934 0.5362 0.4155 0.1101]
 [0.6665 0.4314 0.607  0.3706 0.7513]
 [0.4319 0.4862 0.1391 0.1188 0.0674]
 [0.0012 0.5347 0.0982 0.5941 0.5921]]
M M10 =
 [[0.4101 0.7574 0.3857 0.4977 0.6559]
 [0.0037 0.1087 0.6163 0.1714 0.4715]
 [0.3426 0.0829 0.1382 0.0221 0.1043]
 [0.0003 0.0761 0.1554 0.1642 0.6826]]
M M11 =
 [[0.5103 0.0165 0.1955 0.1651 0.6474]
 [0.6395 0.5512 0.0951 0.5034 0.0282]
 [0.5017 0.6479 0.1575 0.032  0.0878]
 [0.0009 0.9684 0.8721 0.3433 0.4338]]
M M12 =
 [[0.2945 0.5377 0.3052 0.0731 0.0644]
 [0.6212 0.4419 0.1081 0.422  0.7381]
 [0.0264 0.2454 0.1245 0.1015 0.0938]
 [0.0012 0.3146 0.6911 0.1445 0.3087]]
M M13 =
 [[0.4153 0.0252 0.1244 0.2976 0.5253]
 [0.4776 0.2969 0.3951 0.3521 0.1577]
 [0.0716 0.6642 0.0185 0.1883 0.0536]
 [0.0011 0.8736 0.8575 0.4284 0.2479]]
M M20 =
 [[0.052  0.7763 0.5765 0.0517 0.6064]
 [0.1825 0.5483 0.2567 0.2986 0.1971]
 [0.2267 0.2239 0.1648 0.1841 0.1989]
 [0.0002 0.1436 0.1194 0.7008 0.152 ]]
M M21 =
 [[0.1081 0.6048 0.0051 0.3677 0.562 ]
 [0.0016 0.2539 0.0874 0.1754 0.1402]
 [0.1289 0.1763 0.0027 0.036  0.0737]
 [0.0005 0.0419 0.4568 0.447  0.3793]]
M M22 =
 [[0.4688 0.4556 0.3114 0.583  0.8193]
 [0.5538 0.7887 0.524  0.4171 0.7748]
 [0.577  0.6549 0.0911 0.1361 0.3307]
 [0.0007 0.9164 0.3725 0.2694 0.343 ]]
M M23 =
 [[0.3709 0.5323 0.2553 0.405  0.645 ]
 [0.5222 0.2267 0.412  0.4116 0.1836]
 [0.4109 0.2478 0.0519 0.0167 0.0563]
 [0.0007 0.6315 0.5543 0.5393 0.2603]]
M M30 =
 [[0.3421 0.1937 0.0397 0.1938 0.2022]
 [0.3848 0.7448 0.1516 0.0948 0.7121]
 [0.6383 0.3588 0.0125 0.0677 0.3368]
 [0.0012 0.6242 0.2951 0.3817 0.4485]]
M M31 =
 [[0.2094 0.1241 0.6194 0.1257 0.0081]
 [0.2462 0.0396 0.257  0.177  0.2196]
 [0.0391 0.7262 0.0047 0.1082 0.09  ]
 [0.001  0.8144 0.1907 0.2584 0.5508]]
M M32 =
 [[0.1881 0.7587 0.5281 0.4223 0.4376]
 [0.7835 0.0759 0.2692 0.4562 0.5568]
 [0.3503 0.2417 0.0911 0.0817 0.205 ]
 [0.0013 0.5625 0.1736 0.1294 0.6873]]
M M33 =
 [[0.1459 0.158  0.3113 0.4974 0.7085]
 [0.3696 0.906  0.3304 0.1727 0.4646]
 [0.6712 0.6786 0.1631 0.0532 0.294 ]
 [0.0002 0.8929 0.8799 0.3505 0.3698]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># vacuum</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">vacuum</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +1.000 +0.000]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 +0.000 +1.000 +0.000]
[+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.000 +0.000 +1.000]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># filter_amplifier</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">filter_amplifier</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">filter_amplifier</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+3.000 +0.000 +0.000 +0.000]
[+0.000 +3.000 +0.000 +0.000]
[+0.000 +0.000 +3.000 +0.000]
[+0.000 +0.000 +0.000 +3.000]

M M00 =
 [[0.9969 0.8455 0.6759 0.903  0.713 ]
 [0.7031 0.3084 0.7511 0.7187 0.6255]
 [0.7093 0.3252 0.6363 0.758  0.1993]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[0.9969 0.8455 0.6759 0.903  0.713 ]
 [0.7031 0.3084 0.7511 0.7187 0.6255]
 [0.7093 0.3252 0.6363 0.758  0.1993]]
M M12 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M13 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M22 =
 [[0.9969 0.8455 0.6759 0.903  0.713 ]
 [0.7031 0.3084 0.7511 0.7187 0.6255]
 [0.7093 0.3252 0.6363 0.758  0.1993]]
M M23 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M32 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M33 =
 [[0.9969 0.8455 0.6759 0.903  0.713 ]
 [0.7031 0.3084 0.7511 0.7187 0.6255]
 [0.7093 0.3252 0.6363 0.758  0.1993]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># mirror</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">mirror</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 -1.000 +0.000]   [+0.000 +0.000 -1.000 +0.000]   [+0.000 +0.000 -1.000 +0.000]
[+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.000 +0.000 -1.000]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># depolarizer</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[0.747  0.3596 0.5565 0.8936 0.0522]
 [0.1139 0.3064 0.2927 0.4899 0.6948]
 [0.2474 0.3856 0.7388 0.902  0.6043]]
M M12 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M13 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M22 =
 [[0.747  0.3596 0.5565 0.8936 0.0522]
 [0.1139 0.3064 0.2927 0.4899 0.6948]
 [0.2474 0.3856 0.7388 0.902  0.6043]]
M M23 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M32 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M33 =
 [[0.747  0.3596 0.5565 0.8936 0.0522]
 [0.1139 0.3064 0.2927 0.4899 0.6948]
 [0.2474 0.3856 0.7388 0.902  0.6043]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator_perfect</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_perfect</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M M00 =
 [[0.5 0.5 0.5 0.5 0.5]
 [0.5 0.5 0.5 0.5 0.5]
 [0.5 0.5 0.5 0.5 0.5]]
M M01 =
 [[ 0.3295  0.4975 -0.37    0.3152  0.1195]
 [ 0.3887  0.4937 -0.4744  0.0329  0.4981]
 [-0.1621 -0.4446 -0.2369  0.4205  0.3077]]
M M02 =
 [[ 0.3761 -0.0504 -0.3363 -0.3881 -0.4855]
 [ 0.3146  0.0792  0.1579 -0.4989 -0.0436]
 [-0.473  -0.2288 -0.4403  0.2705 -0.3941]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[ 0.3295  0.4975 -0.37    0.3152  0.1195]
 [ 0.3887  0.4937 -0.4744  0.0329  0.4981]
 [-0.1621 -0.4446 -0.2369  0.4205  0.3077]]
M M11 =
 [[0.2171 0.4949 0.2738 0.1987 0.0285]
 [0.3021 0.4875 0.4501 0.0022 0.4962]
 [0.0525 0.3953 0.1122 0.3537 0.1893]]
M M12 =
 [[ 0.2478 -0.0502  0.2489 -0.2447 -0.116 ]
 [ 0.2445  0.0782 -0.1498 -0.0328 -0.0434]
 [ 0.1533  0.2035  0.2086  0.2275 -0.2425]]
M M13 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M20 =
 [[ 0.3761 -0.0504 -0.3363 -0.3881 -0.4855]
 [ 0.3146  0.0792  0.1579 -0.4989 -0.0436]
 [-0.473  -0.2288 -0.4403  0.2705 -0.3941]]
M M21 =
 [[ 0.2478 -0.0502  0.2489 -0.2447 -0.116 ]
 [ 0.2445  0.0782 -0.1498 -0.0328 -0.0434]
 [ 0.1533  0.2035  0.2086  0.2275 -0.2425]]
M M22 =
 [[0.2829 0.0051 0.2262 0.3013 0.4715]
 [0.1979 0.0125 0.0499 0.4978 0.0038]
 [0.4475 0.1047 0.3878 0.1463 0.3107]]
M M23 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M32 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M33 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator_linear</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.625 +0.375 +0.000 +0.000]
[+0.375 +0.625 +0.000 +0.000]
[+0.000 +0.000 +0.500 +0.000]
[+0.000 +0.000 +0.000 +0.500]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># from_Jones</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">]])</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">()</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_Jones</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +0.000 -1.000]
[+0.000 +0.000 +1.000 +0.000]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator_vector</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_vector</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_vector</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_vector</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.500 +0.000 +0.500 +0.000]
[+0.000 +0.000 +0.000 +0.000]
[+0.500 +0.000 +0.500 +0.000]
[+0.000 +0.000 +0.000 +0.000]

M =
[+0.500 +0.345 +0.052 +0.358]   [+0.500 +0.106 +0.324 +0.366]   [+0.500 +0.187 +0.332 +0.323]   [+0.500 +0.285 +0.226 +0.343]   [+0.574 +0.266 +0.168 +0.287]
[+0.345 +0.239 +0.036 +0.247]   [+0.106 +0.023 +0.069 +0.078]   [+0.187 +0.070 +0.124 +0.121]   [+0.285 +0.163 +0.129 +0.196]   [+0.266 +0.458 +0.047 +0.080]
[+0.052 +0.036 +0.005 +0.037]   [+0.324 +0.069 +0.210 +0.237]   [+0.332 +0.124 +0.221 +0.215]   [+0.226 +0.129 +0.102 +0.155]   [+0.168 +0.047 +0.414 +0.050]
[+0.358 +0.247 +0.037 +0.256]   [+0.366 +0.078 +0.237 +0.267]   [+0.323 +0.121 +0.215 +0.209]   [+0.343 +0.196 +0.155 +0.236]   [+0.287 +0.080 +0.050 +0.470]

M M00 =
 [[0.5    0.5    0.5    0.5    0.5   ]
 [0.5    0.5978 0.5354 0.5039 0.5   ]]
M M01 =
 [[0.2146 0.1038 0.2047 0.3181 0.0592]
 [0.1915 0.02   0.3088 0.233  0.361 ]]
M M02 =
 [[0.1437 0.2703 0.2241 0.3108 0.4095]
 [0.2233 0.3566 0.2391 0.0487 0.3393]]
M M03 =
 [[0.4281 0.4076 0.3974 0.2285 0.2808]
 [0.4043 0.1848 0.2517 0.4353 0.0675]]
M M10 =
 [[0.2146 0.1038 0.2047 0.3181 0.0592]
 [0.1915 0.02   0.3088 0.233  0.361 ]]
M M11 =
 [[0.0921 0.0216 0.0838 0.2024 0.007 ]
 [0.0733 0.4427 0.385  0.1796 0.2606]]
M M12 =
 [[0.0617 0.0561 0.0917 0.1977 0.0484]
 [0.0855 0.0069 0.0921 0.0192 0.245 ]]
M M13 =
 [[0.1838 0.0846 0.1626 0.1454 0.0332]
 [0.1548 0.0036 0.097  0.1714 0.0487]]
M M20 =
 [[0.1437 0.2703 0.2241 0.3108 0.4095]
 [0.2233 0.3566 0.2391 0.0487 0.3393]]
M M21 =
 [[0.0617 0.0561 0.0917 0.1977 0.0484]
 [0.0855 0.0069 0.0921 0.0192 0.245 ]]
M M22 =
 [[0.0413 0.1462 0.1004 0.1931 0.3353]
 [0.0998 0.5646 0.3373 0.0919 0.2303]]
M M23 =
 [[0.123  0.2204 0.1781 0.142  0.2299]
 [0.1806 0.0634 0.0751 0.0359 0.0458]]
M M30 =
 [[0.4281 0.4076 0.3974 0.2285 0.2808]
 [0.4043 0.1848 0.2517 0.4353 0.0675]]
M M31 =
 [[0.1838 0.0846 0.1626 0.1454 0.0332]
 [0.1548 0.0036 0.097  0.1714 0.0487]]
M M32 =
 [[0.123  0.2204 0.1781 0.142  0.2299]
 [0.1806 0.0634 0.0751 0.0359 0.0458]]
M M33 =
 [[0.3666 0.3323 0.3158 0.1044 0.1577]
 [0.3269 0.4752 0.345  0.4081 0.0091]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator_charac_angles</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="n">P1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.600 +0.000 +0.260 +0.150]
[+0.000 +0.520 +0.000 +0.000]
[+0.260 +0.000 +0.580 +0.035]
[+0.150 +0.000 +0.035 +0.540]

M =
[+0.529 +0.000 +0.321 +0.185]   [+0.587 +0.000 +0.271 +0.157]   [+0.561 +0.000 +0.294 +0.170]   [+0.766 +0.000 +0.116 +0.067]   [+0.665 +0.000 +0.203 +0.117]
[+0.000 +0.378 +0.000 +0.000]   [+0.000 +0.497 +0.000 +0.000]   [+0.000 +0.446 +0.000 +0.000]   [+0.000 +0.754 +0.000 +0.000]   [+0.000 +0.622 +0.000 +0.000]
[+0.321 +0.000 +0.491 +0.066]   [+0.271 +0.000 +0.564 +0.039]   [+0.294 +0.000 +0.532 +0.050]   [+0.116 +0.000 +0.763 +0.005]   [+0.203 +0.000 +0.654 +0.019]
[+0.185 +0.000 +0.066 +0.415]   [+0.157 +0.000 +0.039 +0.519]   [+0.170 +0.000 +0.050 +0.475]   [+0.067 +0.000 +0.005 +0.757]   [+0.117 +0.000 +0.019 +0.633]

M M00 =
 [[0.6 0.6 0.6 0.6 0.6]
 [0.6 0.6 0.6 0.6 0.6]
 [0.6 0.6 0.6 0.6 0.6]]
M M01 =
 [[ 0.2729  0.299   0.2962 -0.2865  0.0434]
 [ 0.1775  0.046   0.0055  0.2862 -0.3   ]
 [ 0.2513  0.0377  0.2906 -0.289   0.2931]]
M M02 =
 [[0.108  0.0209 0.041  0.0769 0.2571]
 [0.2094 0.2567 0.2598 0.078  0.0032]
 [0.1418 0.2577 0.0646 0.0697 0.0555]]
M M03 =
 [[0.0623 0.0121 0.0237 0.0444 0.1484]
 [0.1209 0.1482 0.15   0.045  0.0019]
 [0.0819 0.1488 0.0373 0.0402 0.032 ]]
M M10 =
 [[ 0.2729  0.299   0.2962 -0.2865  0.0434]
 [ 0.1775  0.046   0.0055  0.2862 -0.3   ]
 [ 0.2513  0.0377  0.2906 -0.289   0.2931]]
M M11 =
 [[0.5861 0.5995 0.598  0.593  0.5213]
 [0.5478 0.5215 0.5196 0.5928 0.6   ]
 [0.576  0.5209 0.595  0.5942 0.5963]]
M M12 =
 [[ 0.0263  0.0056  0.0109 -0.0197  0.01  ]
 [ 0.0332  0.0105  0.0013  0.0199 -0.0009]
 [ 0.0318  0.0087  0.0168 -0.018   0.0145]]
M M13 =
 [[ 0.0152  0.0032  0.0063 -0.0114  0.0057]
 [ 0.0192  0.0061  0.0007  0.0115 -0.0005]
 [ 0.0184  0.005   0.0097 -0.0104  0.0084]]
M M20 =
 [[0.108  0.0209 0.041  0.0769 0.2571]
 [0.2094 0.2567 0.2598 0.078  0.0032]
 [0.1418 0.2577 0.0646 0.0697 0.0555]]
M M21 =
 [[ 0.0263  0.0056  0.0109 -0.0197  0.01  ]
 [ 0.0332  0.0105  0.0013  0.0199 -0.0009]
 [ 0.0318  0.0087  0.0168 -0.018   0.0145]]
M M22 =
 [[0.53   0.52   0.5211 0.5249 0.5786]
 [0.5588 0.5785 0.5799 0.525  0.5196]
 [0.5376 0.579  0.5233 0.524  0.5224]]
M M23 =
 [[0.006  0.0002 0.0009 0.0031 0.0341]
 [0.0226 0.034  0.0348 0.0031 0.    ]
 [0.0104 0.0343 0.0021 0.0025 0.0016]]
M M30 =
 [[0.0623 0.0121 0.0237 0.0444 0.1484]
 [0.1209 0.1482 0.15   0.045  0.0019]
 [0.0819 0.1488 0.0373 0.0402 0.032 ]]
M M31 =
 [[ 0.0152  0.0032  0.0063 -0.0114  0.0057]
 [ 0.0192  0.0061  0.0007  0.0115 -0.0005]
 [ 0.0184  0.005   0.0097 -0.0104  0.0084]]
M M32 =
 [[0.006  0.0002 0.0009 0.0031 0.0341]
 [0.0226 0.034  0.0348 0.0031 0.    ]
 [0.0104 0.0343 0.0021 0.0025 0.0016]]
M M33 =
 [[0.5231 0.5197 0.5201 0.5214 0.5393]
 [0.5327 0.5392 0.5397 0.5214 0.5196]
 [0.5256 0.5394 0.5209 0.5211 0.5205]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator_azimuth_ellipticity</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="n">P1</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">Tmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Tmin</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.600 +0.000 +0.150 +0.260]
[+0.000 +0.520 +0.000 +0.000]
[+0.150 +0.000 +0.540 +0.035]
[+0.260 +0.000 +0.035 +0.580]

M =
[+0.529 +0.000 +0.186 +0.322]   [+0.926 -0.000 -0.013 -0.022]   [+0.904 -0.000 -0.002 -0.004]   [+0.833 +0.000 +0.033 +0.058]   [+0.667 +0.000 +0.116 +0.202]
[+0.000 +0.376 +0.000 +0.000]   [-0.000 +0.925 +0.000 +0.000]   [-0.000 +0.904 +0.000 +0.000]   [+0.000 +0.831 +0.000 +0.000]   [+0.000 +0.625 +0.000 +0.000]
[+0.186 +0.000 +0.414 +0.066]   [-0.013 +0.000 +0.925 +0.000]   [-0.002 +0.000 +0.904 +0.000]   [+0.033 +0.000 +0.831 +0.001]   [+0.116 +0.000 +0.636 +0.018]
[+0.322 +0.000 +0.066 +0.491]   [-0.022 +0.000 +0.000 +0.926]   [-0.004 +0.000 +0.000 +0.904]   [+0.058 +0.000 +0.001 +0.833]   [+0.202 +0.000 +0.018 +0.657]

M M00 =
 [[0.6 0.6 0.6 0.6 0.6]
 [0.6 0.6 0.6 0.6 0.6]
 [0.6 0.6 0.6 0.6 0.6]]
M M01 =
 [[-0.1318  0.1474 -0.086  -0.11   -0.1379]
 [-0.0142  0.0106 -0.1237  0.0367 -0.0921]
 [-0.1415  0.1378  0.1089 -0.0256 -0.0918]]
M M02 =
 [[0.0717 0.028  0.1229 0.102  0.0591]
 [0.1493 0.1496 0.0848 0.1454 0.1184]
 [0.0498 0.0593 0.1032 0.1478 0.1186]]
M M03 =
 [[0.2598 0.2598 0.2598 0.2598 0.2598]
 [0.2598 0.2598 0.2598 0.2598 0.2598]
 [0.2598 0.2598 0.2598 0.2598 0.2598]]
M M10 =
 [[-0.1318  0.1474 -0.086  -0.11   -0.1379]
 [-0.0142  0.0106 -0.1237  0.0367 -0.0921]
 [-0.1415  0.1378  0.1089 -0.0256 -0.0918]]
M M11 =
 [[0.5351 0.539  0.5262 0.5304 0.5366]
 [0.5198 0.5197 0.5333 0.5208 0.5272]
 [0.5375 0.5366 0.5302 0.5202 0.5271]]
M M12 =
 [[-0.0084  0.0037 -0.0094 -0.01   -0.0073]
 [-0.0019  0.0014 -0.0094  0.0048 -0.0097]
 [-0.0063  0.0073  0.01   -0.0034 -0.0097]]
M M13 =
 [[-0.0306  0.0342 -0.0199 -0.0255 -0.032 ]
 [-0.0033  0.0025 -0.0287  0.0085 -0.0214]
 [-0.0328  0.032   0.0253 -0.006  -0.0213]]
M M20 =
 [[0.0717 0.028  0.1229 0.102  0.0591]
 [0.1493 0.1496 0.0848 0.1454 0.1184]
 [0.0498 0.0593 0.1032 0.1478 0.1186]]
M M21 =
 [[-0.0084  0.0037 -0.0094 -0.01   -0.0073]
 [-0.0019  0.0014 -0.0094  0.0048 -0.0097]
 [-0.0063  0.0073  0.01   -0.0034 -0.0097]]
M M22 =
 [[0.5242 0.5203 0.5331 0.5289 0.5227]
 [0.5395 0.5396 0.526  0.5385 0.5321]
 [0.5218 0.5228 0.5291 0.5391 0.5322]]
M M23 =
 [[0.0166 0.0065 0.0285 0.0237 0.0137]
 [0.0347 0.0347 0.0197 0.0337 0.0275]
 [0.0115 0.0138 0.0239 0.0343 0.0275]]
M M30 =
 [[0.2598 0.2598 0.2598 0.2598 0.2598]
 [0.2598 0.2598 0.2598 0.2598 0.2598]
 [0.2598 0.2598 0.2598 0.2598 0.2598]]
M M31 =
 [[-0.0306  0.0342 -0.0199 -0.0255 -0.032 ]
 [-0.0033  0.0025 -0.0287  0.0085 -0.0214]
 [-0.0328  0.032   0.0253 -0.006  -0.0213]]
M M32 =
 [[0.0166 0.0065 0.0285 0.0237 0.0137]
 [0.0347 0.0347 0.0197 0.0337 0.0275]
 [0.0115 0.0138 0.0239 0.0343 0.0275]]
M M33 =
 [[0.5799 0.5799 0.5799 0.5799 0.5799]
 [0.5799 0.5799 0.5799 0.5799 0.5799]
 [0.5799 0.5799 0.5799 0.5799 0.5799]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retarder_vector</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_vector</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">135</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_vector</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;complete&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">135</span><span class="o">*</span><span class="n">degrees</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_vector</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;straight&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_vector</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;complete&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_vector</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;complete&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +0.000 +0.000 -1.000]
[+0.000 +0.000 +1.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]

M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 -0.707 +0.000 -0.707]
[+0.000 +0.000 +1.000 +0.000]
[+0.000 +0.707 +0.000 -0.707]

M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 -0.707 +0.000 -0.707]
[+0.000 +0.000 +1.000 +0.000]
[+0.000 +0.707 +0.000 -0.707]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +0.747 +0.441 -0.497]   [+0.000 +0.872 +0.163 -0.462]   [+0.000 +0.350 +0.831 -0.432]   [+0.000 +0.229 +0.780 -0.582]   [+0.000 +0.564 +0.814 -0.136]
[+0.000 +0.122 +0.644 +0.755]   [+0.000 +0.054 +0.906 +0.421]   [+0.000 -0.675 +0.544 +0.499]   [+0.000 -0.590 +0.587 +0.555]   [+0.000 -0.690 +0.555 +0.465]
[+0.000 +0.653 -0.625 +0.427]   [+0.000 +0.487 -0.392 +0.781]   [+0.000 +0.650 +0.116 +0.751]   [+0.000 +0.775 +0.216 +0.595]   [+0.000 +0.454 -0.168 +0.875]

M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[0.5355 0.602  0.6453 0.5727 0.864 ]
 [0.9033 0.5171 0.8804 0.8163 0.5944]
 [0.5528 0.4883 0.6845 0.5047 0.991 ]
 [0.6703 0.7072 0.3805 0.4796 0.8231]]
M M12 =
 [[0.782  0.45   0.6477 0.2588 0.0964]
 [0.0899 0.6761 0.4565 0.4913 0.6009]
 [0.8316 0.7085 0.7188 0.8139 0.105 ]
 [0.7415 0.5155 0.7547 0.84   0.3093]]
M M13 =
 [[-0.3189 -0.6596 -0.4051 -0.7779 -0.4943]
 [-0.4195 -0.5249 -0.1283 -0.3037 -0.5345]
 [ 0.0534 -0.5095 -0.1219 -0.2879 -0.0828]
 [-0.0287 -0.4838 -0.5344 -0.2537 -0.4763]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[-0.7764 -0.4173 -0.6117  0.098  -0.0854]
 [-0.0875 -0.3812 -0.4466 -0.2667 -0.1059]
 [-0.8298 -0.4154 -0.5922 -0.8078 -0.0949]
 [-0.483  -0.1613 -0.6679 -0.4567 -0.2315]]
M M22 =
 [[0.6045 0.8816 0.7557 0.9204 0.9953]
 [0.9958 0.731  0.8892 0.787  0.7173]
 [0.5435 0.7022 0.6457 0.5628 0.9885]
 [0.4654 0.7839 0.624  0.4858 0.9485]]
M M23 =
 [[0.1786 0.2206 0.2339 0.3784 0.0449]
 [0.0251 0.5661 0.0994 0.5563 0.6886]
 [0.127  0.5782 0.4821 0.1751 0.1179]
 [0.7417 0.5995 0.4057 0.7453 0.2161]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0.3324 0.6808 0.4577 0.8139 0.4963]
 [0.42   0.7664 0.1594 0.5124 0.7972]
 [0.0766 0.7674 0.4253 0.3046 0.0942]
 [0.5633 0.6884 0.6396 0.7493 0.5186]]
M M32 =
 [[ 0.152   0.1425  0.0969 -0.293   0.0034]
 [ 0.014  -0.0926 -0.0302 -0.3731 -0.3527]
 [-0.1145 -0.0707 -0.2578  0.1442 -0.109 ]
 [-0.4833 -0.3459  0.2026 -0.2416 -0.0676]]
M M33 =
 [[0.9308 0.7185 0.8838 0.5017 0.8682]
 [0.9074 0.6357 0.9867 0.7735 0.49  ]
 [0.9905 0.6372 0.8676 0.9415 0.9896]
 [0.6701 0.6376 0.7415 0.6166 0.8523]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retarder_linear</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +0.707 +0.707]
[+0.000 +0.000 -0.707 +0.707]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +0.854 +0.146 -0.500]   [+0.000 +0.707 +0.000 -0.707]   [+0.000 +0.854 -0.146 -0.500]   [+0.000 +1.000 -0.000 -0.000]
[+0.000 +0.000 +0.707 +0.707]   [+0.000 +0.146 +0.854 +0.500]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 -0.146 +0.854 -0.500]   [+0.000 -0.000 +0.707 -0.707]
[+0.000 +0.000 -0.707 +0.707]   [+0.000 +0.500 -0.500 +0.707]   [+0.000 +0.707 -0.000 +0.707]   [+0.000 +0.500 +0.500 +0.707]   [+0.000 +0.000 +0.707 +0.707]

M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[0.844  0.9662 0.9624 0.9711 0.9962]
 [0.7514 0.8411 0.7217 0.7317 0.8384]
 [0.9025 0.7159 0.9998 0.709  0.7629]]
M M12 =
 [[ 0.1461  0.0935  0.0979  0.0873  0.0332]
 [ 0.105   0.1459  0.0637  0.0813  0.1457]
 [ 0.138  -0.0499  0.008  -0.0237  0.115 ]]
M M13 =
 [[-0.516  -0.24   -0.2532 -0.222  -0.0808]
 [-0.6514 -0.5209 -0.6893 -0.6767 -0.5253]
 [-0.4081 -0.6964 -0.0193 -0.7048 -0.6361]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[ 0.1461  0.0935  0.0979  0.0873  0.0332]
 [ 0.105   0.1459  0.0637  0.0813  0.1457]
 [ 0.138  -0.0499  0.008  -0.0237  0.115 ]]
M M22 =
 [[0.8631 0.7409 0.7447 0.736  0.7109]
 [0.9557 0.866  0.9854 0.9754 0.8687]
 [0.8047 0.9912 0.7073 0.9981 0.9442]]
M M23 =
 [[ 0.4834  0.6651  0.6602  0.6714  0.7025]
 [ 0.2751  0.4782  0.1578  0.205   0.4734]
 [ 0.5775 -0.1223  0.7068 -0.0573  0.3087]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0.516  0.24   0.2532 0.222  0.0808]
 [0.6514 0.5209 0.6893 0.6767 0.5253]
 [0.4081 0.6964 0.0193 0.7048 0.6361]]
M M32 =
 [[-0.4834 -0.6651 -0.6602 -0.6714 -0.7025]
 [-0.2751 -0.4782 -0.1578 -0.205  -0.4734]
 [-0.5775  0.1223 -0.7068  0.0573 -0.3087]]
M M33 =
 [[0.7071 0.7071 0.7071 0.7071 0.7071]
 [0.7071 0.7071 0.7071 0.7071 0.7071]
 [0.7071 0.7071 0.7071 0.7071 0.7071]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator_retarder_linear</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_retarder_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_retarder_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_retarder_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.625 +0.625 +0.000 +0.000]
[+0.625 +0.625 +0.000 +0.000]
[+0.000 +0.000 +0.354 +0.354]
[+0.000 +0.000 -0.354 +0.354]

M =
[+0.625 +0.625 +0.000 +0.000]   [+0.625 +0.442 +0.442 +0.000]   [+0.625 +0.000 +0.625 +0.000]   [+0.625 -0.442 +0.442 +0.000]   [+0.625 -0.625 +0.000 +0.000]
[+0.625 +0.625 +0.000 +0.000]   [+0.442 +0.489 +0.136 -0.250]   [+0.000 +0.354 +0.000 -0.354]   [-0.442 +0.489 -0.136 -0.250]   [-0.625 +0.625 -0.000 -0.000]
[+0.000 +0.000 +0.354 +0.354]   [+0.442 +0.136 +0.489 +0.250]   [+0.625 +0.000 +0.625 +0.000]   [+0.442 -0.136 +0.489 -0.250]   [+0.000 -0.000 +0.354 -0.354]
[+0.000 +0.000 -0.354 +0.354]   [+0.000 +0.250 -0.250 +0.354]   [+0.000 +0.354 -0.000 +0.354]   [+0.000 +0.250 +0.250 +0.354]   [+0.000 +0.000 +0.354 +0.354]

M M00 =
 [[0.625 0.625 0.625 0.625 0.625]
 [0.625 0.625 0.625 0.625 0.625]
 [0.625 0.625 0.625 0.625 0.625]]
M M01 =
 [[-0.1599 -0.1241  0.5017  0.5378 -0.0882]
 [ 0.2341  0.1025  0.0978  0.2653 -0.1297]
 [ 0.187   0.0448  0.0457  0.6249  0.265 ]]
M M02 =
 [[0.6042 0.6126 0.3727 0.3185 0.6187]
 [0.5795 0.6165 0.6173 0.5659 0.6114]
 [0.5964 0.6234 0.6233 0.0092 0.5661]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[-0.1599 -0.1241  0.5017  0.5378 -0.0882]
 [ 0.2341  0.1025  0.0978  0.2653 -0.1297]
 [ 0.187   0.0448  0.0457  0.6249  0.265 ]]
M M11 =
 [[0.3713 0.3643 0.5285 0.5545 0.359 ]
 [0.3916 0.3609 0.3602 0.4024 0.3653]
 [0.3778 0.355  0.355  0.6249 0.4023]]
M M12 =
 [[-0.0671 -0.0528  0.1299  0.119  -0.0379]
 [ 0.0943  0.0439  0.0419  0.1043 -0.0551]
 [ 0.0775  0.0194  0.0198  0.004   0.1042]]
M M13 =
 [[-0.3418 -0.3465 -0.2109 -0.1802 -0.35  ]
 [-0.3278 -0.3488 -0.3492 -0.3201 -0.3459]
 [-0.3374 -0.3526 -0.3526 -0.0052 -0.3202]]
M M20 =
 [[0.6042 0.6126 0.3727 0.3185 0.6187]
 [0.5795 0.6165 0.6173 0.5659 0.6114]
 [0.5964 0.6234 0.6233 0.0092 0.5661]]
M M21 =
 [[-0.0671 -0.0528  0.1299  0.119  -0.0379]
 [ 0.0943  0.0439  0.0419  0.1043 -0.0551]
 [ 0.0775  0.0194  0.0198  0.004   0.1042]]
M M22 =
 [[0.6072 0.6143 0.4501 0.424  0.6196]
 [0.5869 0.6177 0.6184 0.5761 0.6133]
 [0.6007 0.6236 0.6236 0.3536 0.5762]]
M M23 =
 [[-0.0905 -0.0702  0.2838  0.3042 -0.0499]
 [ 0.1324  0.058   0.0553  0.1501 -0.0734]
 [ 0.1058  0.0254  0.0258  0.3535  0.1499]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0.3418 0.3465 0.2109 0.1802 0.35  ]
 [0.3278 0.3488 0.3492 0.3201 0.3459]
 [0.3374 0.3526 0.3526 0.0052 0.3202]]
M M32 =
 [[ 0.0905  0.0702 -0.2838 -0.3042  0.0499]
 [-0.1324 -0.058  -0.0553 -0.1501  0.0734]
 [-0.1058 -0.0254 -0.0258 -0.3535 -0.1499]]
M M33 =
 [[0.3536 0.3536 0.3536 0.3536 0.3536]
 [0.3536 0.3536 0.3536 0.3536 0.3536]
 [0.3536 0.3536 0.3536 0.3536 0.3536]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># quarter_waveplate</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">quarter_waveplate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">quarter_waveplate</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">quarter_waveplate</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +0.000 +1.000]
[+0.000 +0.000 -1.000 +0.000]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +0.500 +0.500 -0.707]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.500 -0.500 -0.707]   [+0.000 +1.000 -0.000 -0.000]
[+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.500 +0.500 +0.707]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 -0.500 +0.500 -0.707]   [+0.000 -0.000 +0.000 -1.000]
[+0.000 +0.000 -1.000 +0.000]   [+0.000 +0.707 -0.707 +0.000]   [+0.000 +1.000 -0.000 +0.000]   [+0.000 +0.707 +0.707 +0.000]   [+0.000 +0.000 +1.000 +0.000]

M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[0.0171 0.19   0.0559 0.6296 0.5151]
 [0.019  0.0603 0.7105 0.0513 0.2996]
 [0.0228 0.4408 0.3946 0.5015 0.1659]]
M M12 =
 [[ 0.1297  0.3923  0.2297  0.4829  0.4998]
 [ 0.1366  0.2381  0.4535 -0.2207  0.4581]
 [-0.1492  0.4965  0.4888  0.5     0.372 ]]
M M13 =
 [[-0.9914 -0.9    -0.9717 -0.6086 -0.6964]
 [-0.9904 -0.9694 -0.538  -0.974  -0.8369]
 [-0.9885 -0.7478 -0.7781 -0.7061 -0.9133]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[ 0.1297  0.3923  0.2297  0.4829  0.4998]
 [ 0.1366  0.2381  0.4535 -0.2207  0.4581]
 [-0.1492  0.4965  0.4888  0.5     0.372 ]]
M M22 =
 [[0.9829 0.81   0.9441 0.3704 0.4849]
 [0.981  0.9397 0.2895 0.9487 0.7004]
 [0.9772 0.5592 0.6054 0.4985 0.8341]]
M M23 =
 [[ 0.1308  0.4359  0.2364  0.7935  0.7177]
 [ 0.1379  0.2456  0.8429 -0.2266  0.5474]
 [-0.1509  0.664   0.6282  0.7081  0.4073]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0.9914 0.9    0.9717 0.6086 0.6964]
 [0.9904 0.9694 0.538  0.974  0.8369]
 [0.9885 0.7478 0.7781 0.7061 0.9133]]
M M32 =
 [[-0.1308 -0.4359 -0.2364 -0.7935 -0.7177]
 [-0.1379 -0.2456 -0.8429  0.2266 -0.5474]
 [ 0.1509 -0.664  -0.6282 -0.7081 -0.4073]]
M M33 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># half_waveplate</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">half_waveplate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">half_waveplate</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">half_waveplate</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 -1.000 +0.000]
[+0.000 +0.000 +0.000 -1.000]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 -1.000 +0.000 +0.000]   [+0.000 -0.000 -1.000 +0.000]   [+0.000 +1.000 -0.000 +0.000]
[+0.000 +0.000 -1.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 -1.000 +0.000 +0.000]   [+0.000 -0.000 -1.000 +0.000]
[+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.000 +0.000 -1.000]

M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[-0.8644 -0.9557 -0.8795 -0.9301 -0.8899]
 [-0.9995  0.6795  0.7024  0.6002  0.2448]
 [ 0.7926 -0.4836  0.778  -0.9657  0.9368]]
M M12 =
 [[-0.5028 -0.2944  0.476   0.3673  0.4561]
 [ 0.0324  0.7337  0.7118  0.7998  0.9696]
 [ 0.6097  0.8753  0.6282  0.2595  0.3499]]
M M13 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[-0.5028 -0.2944  0.476   0.3673  0.4561]
 [ 0.0324  0.7337  0.7118  0.7998  0.9696]
 [ 0.6097  0.8753  0.6282  0.2595  0.3499]]
M M22 =
 [[ 0.8644  0.9557  0.8795  0.9301  0.8899]
 [ 0.9995 -0.6795 -0.7024 -0.6002 -0.2448]
 [-0.7926  0.4836 -0.778   0.9657 -0.9368]]
M M23 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M32 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M33 =
 [[-1. -1. -1. -1. -1.]
 [-1. -1. -1. -1. -1.]
 [-1. -1. -1. -1. -1.]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retarder_charac_angles</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">delay</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">360</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +0.000 +1.000]
[+0.000 +0.000 -1.000 +0.000]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +0.500 +0.500 -0.707]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.500 -0.500 -0.707]   [+0.000 +1.000 -0.000 -0.000]
[+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.500 +0.500 +0.707]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 -0.500 +0.500 -0.707]   [+0.000 -0.000 +0.000 -1.000]
[+0.000 +0.000 -1.000 +0.000]   [+0.000 +0.707 -0.707 +0.000]   [+0.000 +1.000 -0.000 +0.000]   [+0.000 +0.707 +0.707 +0.000]   [+0.000 +0.000 +1.000 +0.000]

M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[1.     0.9505 0.8117 0.6113 0.3887]
 [0.1883 0.0495 0.     0.0495 0.1883]
 [0.3887 0.6113 0.8117 0.9505 1.    ]]
M M12 =
 [[ 0.      0.3087 -0.5475 -0.1836  0.3031]
 [-0.2419  0.448  -0.5979  0.3224 -0.9608]
 [ 0.1506 -0.6326  0.4795 -0.2494 -0.    ]]
M M13 =
 [[ 0.      0.0357  0.2032 -0.7698 -0.8701]
 [-0.9519 -0.8926 -0.8016 -0.9453  0.2036]
 [-0.909  -0.4755 -0.3334 -0.1854 -0.    ]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[ 0.     -0.0435 -0.1452  0.7914  0.6479]
 [ 0.8604 -0.0272  0.5979 -0.6928  0.8051]
 [-0.8825 -0.3089 -0.3815 -0.179  -0.    ]]
M M22 =
 [[0.     0.0185 0.1478 0.1511 0.5815]
 [0.508  0.894  0.6425 0.6928 0.0322]
 [0.3444 0.3625 0.003  0.0483 0.    ]]
M M23 =
 [[ 1.      0.9989  0.9783  0.5923  0.492 ]
 [ 0.0411  0.4472 -0.4793  0.2    -0.5923]
 [-0.3203 -0.8793 -0.9244 -0.9827 -1.    ]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[ 0.      0.3077 -0.5657  0.0076  0.6551]
 [ 0.4736  0.9984  0.8016  0.7194  0.5625]
 [ 0.2648  0.7287 -0.4422  0.254   0.    ]]
M M32 =
 [[-1.     -0.951  -0.8236 -0.9713 -0.755 ]
 [-0.8267  0.0022 -0.4793  0.645   0.2755]
 [ 0.9266  0.6844  0.8776  0.9672  1.    ]]
M M33 =
 [[0.     0.031  0.0405 0.2376 0.0297]
 [0.3038 0.0565 0.3575 0.2576 0.7795]
 [0.2668 0.0262 0.1853 0.0012 0.    ]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retarder_azimuth_ellipticity</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +0.000 +1.000]
[+0.000 +0.000 -1.000 +0.000]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]   [+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]   [+0.000 +0.500 +0.500 -0.707]   [+0.000 +0.000 +0.000 -1.000]   [+0.000 +0.500 -0.500 -0.707]   [+0.000 +1.000 -0.000 -0.000]
[+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.500 +0.500 +0.707]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 -0.500 +0.500 -0.707]   [+0.000 -0.000 +0.000 -1.000]
[+0.000 +0.000 -1.000 +0.000]   [+0.000 +0.707 -0.707 +0.000]   [+0.000 +1.000 -0.000 +0.000]   [+0.000 +0.707 +0.707 +0.000]   [+0.000 +0.000 +1.000 +0.000]

M M00 =
 [[1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1.]]
M M01 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M02 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M03 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M10 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M11 =
 [[0.8798 0.326  0.2494 0.0124 0.0966]
 [0.1773 0.0444 0.     0.0437 0.1   ]
 [0.0192 0.1665 0.0985 0.5693 0.2397]]
M M12 =
 [[0.3467 0.885  0.9524 0.9997 0.988 ]
 [0.6094 0.5172 0.7505 0.151  0.4769]
 [0.951  0.7202 0.89   0.5034 0.872 ]]
M M13 =
 [[ 0.3252  0.3325  0.1752  0.0214 -0.1203]
 [-0.7727 -0.8547 -0.6609 -0.9876 -0.8732]
 [-0.3085 -0.6734 -0.4453 -0.65   -0.4269]]
M M20 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M21 =
 [[-0.3467 -0.7362 -0.7123 -0.9799 -0.7458]
 [ 0.1269 -0.1286 -0.7505 -0.534  -0.8923]
 [-0.9991 -0.9858 -0.9848 -0.7632 -0.872 ]]
M M22 =
 [[0.     0.017  0.0578 0.0079 0.1519]
 [0.7645 0.8514 0.4368 0.839  0.4313]
 [0.0301 0.1059 0.0228 0.0297 0.    ]]
M M23 =
 [[ 0.938   0.6766  0.6995  0.1995  0.6486]
 [ 0.632   0.5086  0.496   0.1047  0.1333]
 [ 0.0308 -0.1305 -0.1721 -0.6455 -0.4895]]
M M30 =
 [[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
M M31 =
 [[ 0.3252  0.5931  0.6561  0.1992  0.6591]
 [ 0.9759  0.9907  0.6609  0.8443  0.4402]
 [ 0.0386 -0.0227 -0.143  -0.3056 -0.4269]]
M M32 =
 [[-0.938  -0.4653 -0.2992 -0.0235  0.0271]
 [-0.2101  0.0874  0.496   0.5228  0.7659]
 [ 0.3076  0.6856  0.4555  0.8636  0.4895]]
M M33 =
 [[0.1202 0.657  0.6928 0.9797 0.7516]
 [0.0582 0.1043 0.5632 0.1173 0.4687]
 [0.9507 0.7276 0.8787 0.4011 0.7603]]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># depolarizer_states</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Stokes</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_states</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">S</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="o">.</span><span class="mi">7</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
S =
[+1.000]   [+1.000]   [+1.000]
[+1.000]   [+0.000]   [+0.000]
[+0.000]   [+1.000]   [+0.000]
[+0.000]   [+0.000]   [+1.000]

M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +0.700 +0.000 +0.000]
[+0.000 +0.000 +0.600 +0.000]
[+0.000 +0.000 +0.000 +0.500]

</pre></div></div>
</div>
</div>
<div class="section" id="Operations">
<h1>Operations<a class="headerlink" href="#Operations" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M00</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">D</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">M00</span><span class="o">=</span><span class="n">M00</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">blocks</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The block components of M are:
  - M_00 of M is:
2.0

  - Diattenuation vector of M is:
  D[0]
[0.75]
  D[1]
[1.25]
  D[2]
[1.75]

  - Polarizance vector of M is:
  P[0]
[0.5]
  P[1]
[1.]
  P[2]
[1.5]

  - Small matrix of M is:
  m[0,0]
[2.]
  m[0,1]
[2.5]
  m[0,2]
[3.]
  m[1,0]
[3.5]
  m[1,1]
[4.]
  m[1,2]
[4.5]
  m[2,0]
[5.]
  m[2,1]
[5.5]
  m[2,2]
[6.]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Sum</span>
<span class="n">M1</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">((</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">))</span>
<span class="n">M1</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
<span class="n">M2</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">+</span> <span class="n">M2</span><span class="p">)</span>


<span class="n">M2</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">+</span> <span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M1 + M2 =
[+2.000 +0.000 +0.000 +0.000]
[+0.000 +1.500 +0.000 +0.000]
[+0.000 +0.000 -0.500 +0.000]
[+0.000 +0.000 +0.000 -0.500]

M1 + M2 =
[+2.000 +0.000 +0.000 +0.000]   [+2.000 +0.000 +0.000 +0.000]
[+0.000 +1.500 +0.000 +0.000]   [+0.000 +1.300 +0.000 +0.000]
[+0.000 +0.000 -0.500 +0.000]   [+0.000 +0.000 -0.700 +0.000]
[+0.000 +0.000 +0.000 -0.500]   [+0.000 +0.000 +0.000 -0.700]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Multiply by number, right</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Multiply by array, right</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3 * M =
[+3.000 +0.000 +0.000 +0.000]
[+0.000 +1.500 +0.000 +0.000]
[+0.000 +0.000 +1.500 +0.000]
[+0.000 +0.000 +0.000 +1.500]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.500 +0.000 +0.000 +0.000]   [+2.000 +0.000 +0.000 +0.000]   [+2.500 +0.000 +0.000 +0.000]   [+3.000 +0.000 +0.000 +0.000]
[+0.000 +0.500 +0.000 +0.000]   [+0.000 +0.750 +0.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]   [+0.000 +1.250 +0.000 +0.000]   [+0.000 +1.500 +0.000 +0.000]
[+0.000 +0.000 +0.500 +0.000]   [+0.000 +0.000 +0.750 +0.000]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 +0.000 +1.250 +0.000]   [+0.000 +0.000 +1.500 +0.000]
[+0.000 +0.000 +0.000 +0.500]   [+0.000 +0.000 +0.000 +0.750]   [+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.000 +0.000 +1.250]   [+0.000 +0.000 +0.000 +1.500]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Divide by number, right</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Divide by array, right</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M / 3 =
[+0.333 +0.000 +0.000 +0.000]
[+0.000 +0.167 +0.000 +0.000]
[+0.000 +0.000 +0.167 +0.000]
[+0.000 +0.000 +0.000 +0.167]

M =
[+1.000 +0.000 +0.000 +0.000]   [+0.667 +0.000 +0.000 +0.000]   [+0.500 +0.000 +0.000 +0.000]   [+0.400 +0.000 +0.000 +0.000]   [+0.333 +0.000 +0.000 +0.000]
[+0.000 +0.500 +0.000 +0.000]   [+0.000 +0.333 +0.000 +0.000]   [+0.000 +0.250 +0.000 +0.000]   [+0.000 +0.200 +0.000 +0.000]   [+0.000 +0.167 +0.000 +0.000]
[+0.000 +0.000 +0.500 +0.000]   [+0.000 +0.000 +0.333 +0.000]   [+0.000 +0.000 +0.250 +0.000]   [+0.000 +0.000 +0.200 +0.000]   [+0.000 +0.000 +0.167 +0.000]
[+0.000 +0.000 +0.000 +0.500]   [+0.000 +0.000 +0.000 +0.333]   [+0.000 +0.000 +0.000 +0.250]   [+0.000 +0.000 +0.000 +0.200]   [+0.000 +0.000 +0.000 +0.167]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Multiply by number, left</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">M1</span><span class="p">)</span>

<span class="c1"># Multiply by array, left</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">depolarizer_diagonal</span><span class="p">(</span><span class="n">d</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3 * M =
[+3.000 +0.000 +0.000 +0.000]
[+0.000 +1.500 +0.000 +0.000]
[+0.000 +0.000 +1.500 +0.000]
[+0.000 +0.000 +0.000 +1.500]

M =
[+1.000 +0.000 +0.000 +0.000]   [+1.500 +0.000 +0.000 +0.000]   [+2.000 +0.000 +0.000 +0.000]   [+2.500 +0.000 +0.000 +0.000]   [+3.000 +0.000 +0.000 +0.000]
[+0.000 +0.500 +0.000 +0.000]   [+0.000 +0.750 +0.000 +0.000]   [+0.000 +1.000 +0.000 +0.000]   [+0.000 +1.250 +0.000 +0.000]   [+0.000 +1.500 +0.000 +0.000]
[+0.000 +0.000 +0.500 +0.000]   [+0.000 +0.000 +0.750 +0.000]   [+0.000 +0.000 +1.000 +0.000]   [+0.000 +0.000 +1.250 +0.000]   [+0.000 +0.000 +1.500 +0.000]
[+0.000 +0.000 +0.000 +0.500]   [+0.000 +0.000 +0.000 +0.750]   [+0.000 +0.000 +0.000 +1.000]   [+0.000 +0.000 +0.000 +1.250]   [+0.000 +0.000 +0.000 +1.500]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Multiply two matrices</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_components</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">)</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_components</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">*</span> <span class="n">M2</span><span class="p">)</span>

<span class="c1"># Multiply two matrices, 1D</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_components</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">)</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_components</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span> <span class="o">*</span> <span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M1 * M2 =
[+34.000 +34.000 +34.000 +34.000]
[+30.000 +30.000 +30.000 +30.000]
[+30.000 +30.000 +30.000 +30.000]
[+30.000 +30.000 +30.000 +30.000]

M1 * M2 =
[+34.000 +34.000 +34.000 +34.000]   [+34.000 +34.000 +34.000 +34.000]   [+34.000 +34.000 +34.000 +34.000]
[+30.000 +30.000 +30.000 +30.000]   [+30.000 +30.000 +30.000 +30.000]   [+30.000 +30.000 +30.000 +30.000]
[+30.000 +30.000 +30.000 +30.000]   [+30.000 +30.000 +30.000 +30.000]   [+30.000 +30.000 +30.000 +30.000]
[+30.000 +30.000 +30.000 +30.000]   [+30.000 +30.000 +30.000 +30.000]   [+30.000 +30.000 +30.000 +30.000]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># getitem</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">J2</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J2</span><span class="p">)</span>

<span class="n">J2</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J2</span><span class="p">)</span>

<span class="n">J3</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J3</span><span class="p">)</span>

<span class="n">J3</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J3</span><span class="p">)</span>

<span class="n">J4</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J4</span><span class="p">)</span>

<span class="n">aux</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">J4</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">aux</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Test M00 =
 [[0.6588 0.8837 0.1692 0.5712 0.2819]
 [0.5036 0.935  0.8497 0.7735 0.9581]
 [0.3946 0.8034 0.1833 0.5875 0.7022]]
Test M01 =
 [[0.6607 0.9449 0.4244 0.5709 0.1811]
 [0.3574 0.0327 0.3578 0.4634 0.3529]
 [0.747  0.4397 0.5041 0.9573 0.2223]]
Test M02 =
 [[0.3338 0.1721 0.7653 0.0707 0.5304]
 [0.641  0.4543 0.3302 0.2991 0.2568]
 [0.6977 0.9743 0.7071 0.4392 0.5347]]
Test M03 =
 [[0.8116 0.2569 0.0064 0.2703 0.429 ]
 [0.8287 0.6338 0.8691 0.1997 0.1325]
 [0.1248 0.6555 0.3371 0.0434 0.301 ]]
Test M10 =
 [[0.2799 0.4486 0.2787 0.2174 0.9582]
 [0.7181 0.9301 0.6465 0.5358 0.2301]
 [0.5121 0.3044 0.4561 0.8314 0.2523]]
Test M11 =
 [[0.1772 0.6663 0.9965 0.5981 0.9978]
 [0.8711 0.8344 0.906  0.1229 0.1428]
 [0.6331 0.996  0.2302 0.5583 0.8974]]
Test M12 =
 [[0.2135 0.8581 0.18   0.8658 0.4819]
 [0.4154 0.5306 0.6379 0.7574 0.1779]
 [0.6141 0.8016 0.4272 0.9187 0.2435]]
Test M13 =
 [[0.7457 0.4875 0.9056 0.3388 0.0969]
 [0.993  0.1603 0.1414 0.8982 0.3782]
 [0.7896 0.7573 0.0159 0.4997 0.7182]]
Test M20 =
 [[0.6387 0.7892 0.5377 0.6355 0.0421]
 [0.9918 0.6041 0.7106 0.5367 0.8764]
 [0.8513 0.716  0.419  0.9575 0.6114]]
Test M21 =
 [[0.1884 0.591  0.941  0.7169 0.3315]
 [0.8788 0.3475 0.0826 0.978  0.1541]
 [0.4913 0.7575 0.9096 0.385  0.9602]]
Test M22 =
 [[0.6786 0.2985 0.3613 0.8194 0.544 ]
 [0.7001 0.2734 0.4474 0.9592 0.4464]
 [0.6609 0.8257 0.3868 0.9376 0.6506]]
Test M23 =
 [[0.8013 0.784  0.8857 0.0717 0.4914]
 [0.6512 0.6835 0.0743 0.9544 0.5244]
 [0.1963 0.3675 0.5504 0.1011 0.5026]]
Test M30 =
 [[0.4362 0.4937 0.6939 0.5101 0.2648]
 [0.1951 0.1548 0.7411 0.3027 0.3887]
 [0.0111 0.5771 0.0381 0.4812 0.2434]]
Test M31 =
 [[0.2148 0.1914 0.4923 0.0195 0.2357]
 [0.6009 0.9427 0.6521 0.1432 0.6172]
 [0.1126 0.942  0.0428 0.4006 0.8344]]
Test M32 =
 [[0.0834 0.1849 0.1614 0.5876 0.498 ]
 [0.4082 0.3544 0.6059 0.352  0.6585]
 [0.7968 0.5663 0.6991 0.5744 0.0162]]
Test M33 =
 [[0.4746 0.41   0.746  0.833  0.4   ]
 [0.9619 0.5932 0.7591 0.0421 0.2766]
 [0.579  0.4541 0.9754 0.9157 0.9237]]

Test_picked =
[+0.659 +0.661 +0.334 +0.812]
[+0.280 +0.177 +0.214 +0.746]
[+0.639 +0.188 +0.679 +0.801]
[+0.436 +0.215 +0.083 +0.475]

Test_picked =
[+0.659 +0.661 +0.334 +0.812]   [+0.884 +0.945 +0.172 +0.257]   [+0.169 +0.424 +0.765 +0.006]
[+0.280 +0.177 +0.214 +0.746]   [+0.449 +0.666 +0.858 +0.488]   [+0.279 +0.997 +0.180 +0.906]
[+0.639 +0.188 +0.679 +0.801]   [+0.789 +0.591 +0.298 +0.784]   [+0.538 +0.941 +0.361 +0.886]
[+0.436 +0.215 +0.083 +0.475]   [+0.494 +0.191 +0.185 +0.410]   [+0.694 +0.492 +0.161 +0.746]

Test_picked =
[+0.935 +0.033 +0.454 +0.634]
[+0.930 +0.834 +0.531 +0.160]
[+0.604 +0.348 +0.273 +0.684]
[+0.155 +0.943 +0.354 +0.593]

Test_picked M00 =
 [[0.6588 0.8837]
 [0.5036 0.935 ]
 [0.3946 0.8034]]
Test_picked M01 =
 [[0.6607 0.9449]
 [0.3574 0.0327]
 [0.747  0.4397]]
Test_picked M02 =
 [[0.3338 0.1721]
 [0.641  0.4543]
 [0.6977 0.9743]]
Test_picked M03 =
 [[0.8116 0.2569]
 [0.8287 0.6338]
 [0.1248 0.6555]]
Test_picked M10 =
 [[0.2799 0.4486]
 [0.7181 0.9301]
 [0.5121 0.3044]]
Test_picked M11 =
 [[0.1772 0.6663]
 [0.8711 0.8344]
 [0.6331 0.996 ]]
Test_picked M12 =
 [[0.2135 0.8581]
 [0.4154 0.5306]
 [0.6141 0.8016]]
Test_picked M13 =
 [[0.7457 0.4875]
 [0.993  0.1603]
 [0.7896 0.7573]]
Test_picked M20 =
 [[0.6387 0.7892]
 [0.9918 0.6041]
 [0.8513 0.716 ]]
Test_picked M21 =
 [[0.1884 0.591 ]
 [0.8788 0.3475]
 [0.4913 0.7575]]
Test_picked M22 =
 [[0.6786 0.2985]
 [0.7001 0.2734]
 [0.6609 0.8257]]
Test_picked M23 =
 [[0.8013 0.784 ]
 [0.6512 0.6835]
 [0.1963 0.3675]]
Test_picked M30 =
 [[0.4362 0.4937]
 [0.1951 0.1548]
 [0.0111 0.5771]]
Test_picked M31 =
 [[0.2148 0.1914]
 [0.6009 0.9427]
 [0.1126 0.942 ]]
Test_picked M32 =
 [[0.0834 0.1849]
 [0.4082 0.3544]
 [0.7968 0.5663]]
Test_picked M33 =
 [[0.4746 0.41  ]
 [0.9619 0.5932]
 [0.579  0.4541]]

Test_picked =
[+0.169 +0.424 +0.765 +0.006]   [+0.282 +0.181 +0.530 +0.429]   [+0.935 +0.033 +0.454 +0.634]
[+0.279 +0.997 +0.180 +0.906]   [+0.958 +0.998 +0.482 +0.097]   [+0.930 +0.834 +0.531 +0.160]
[+0.538 +0.941 +0.361 +0.886]   [+0.042 +0.332 +0.544 +0.491]   [+0.604 +0.348 +0.273 +0.684]
[+0.694 +0.492 +0.161 +0.746]   [+0.265 +0.236 +0.498 +0.400]   [+0.155 +0.943 +0.354 +0.593]

Test_picked M00 = [0.6588 0.8837 0.5712 0.5036 0.935  0.8497 0.7735 0.9581 0.8034 0.5875 0.7022]
            M01 = [0.6607 0.9449 0.5709 0.3574 0.0327 0.3578 0.4634 0.3529 0.4397 0.9573 0.2223]
            M02 = [0.3338 0.1721 0.0707 0.641  0.4543 0.3302 0.2991 0.2568 0.9743 0.4392 0.5347]
            M03 = [0.8116 0.2569 0.2703 0.8287 0.6338 0.8691 0.1997 0.1325 0.6555 0.0434 0.301 ]
            M10 = [0.2799 0.4486 0.2174 0.7181 0.9301 0.6465 0.5358 0.2301 0.3044 0.8314 0.2523]
            M11 = [0.1772 0.6663 0.5981 0.8711 0.8344 0.906  0.1229 0.1428 0.996  0.5583 0.8974]
            M12 = [0.2135 0.8581 0.8658 0.4154 0.5306 0.6379 0.7574 0.1779 0.8016 0.9187 0.2435]
            M13 = [0.7457 0.4875 0.3388 0.993  0.1603 0.1414 0.8982 0.3782 0.7573 0.4997 0.7182]
            M20 = [0.6387 0.7892 0.6355 0.9918 0.6041 0.7106 0.5367 0.8764 0.716  0.9575 0.6114]
            M21 = [0.1884 0.591  0.7169 0.8788 0.3475 0.0826 0.978  0.1541 0.7575 0.385  0.9602]
            M22 = [0.6786 0.2985 0.8194 0.7001 0.2734 0.4474 0.9592 0.4464 0.8257 0.9376 0.6506]
            M23 = [0.8013 0.784  0.0717 0.6512 0.6835 0.0743 0.9544 0.5244 0.3675 0.1011 0.5026]
            M30 = [0.4362 0.4937 0.5101 0.1951 0.1548 0.7411 0.3027 0.3887 0.5771 0.4812 0.2434]
            M31 = [0.2148 0.1914 0.0195 0.6009 0.9427 0.6521 0.1432 0.6172 0.942  0.4006 0.8344]
            M32 = [0.0834 0.1849 0.5876 0.4082 0.3544 0.6059 0.352  0.6585 0.5663 0.5744 0.0162]
            M33 = [0.4746 0.41   0.833  0.9619 0.5932 0.7591 0.0421 0.2766 0.4541 0.9157 0.9237]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># setitem</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">)</span>
<span class="n">J2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;New&#39;</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">J2</span><span class="o">.</span><span class="n">vacuum</span><span class="p">()</span>
<span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">J2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">J2</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">J2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">J2</span><span class="o">.</span><span class="n">vacuum</span><span class="p">()</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">J2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">J2</span><span class="o">.</span><span class="n">vacuum</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">J2</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">J2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">J2</span><span class="o">.</span><span class="n">vacuum</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">J</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)]</span> <span class="o">=</span> <span class="n">J2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

<span class="n">J2</span><span class="o">.</span><span class="n">vacuum</span><span class="p">()</span>
<span class="n">aux</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">J</span><span class="p">[</span><span class="n">aux</span><span class="p">]</span> <span class="o">=</span> <span class="n">J2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Test M00 =
 [[0.6051 0.1379 0.272  0.618  0.4614]
 [0.0011 0.4945 0.8436 0.7047 0.8906]
 [0.9127 0.3338 0.0512 0.9281 0.4791]]
Test M01 =
 [[0.9857 0.0884 0.6332 0.0082 0.6005]
 [0.3627 0.8002 0.9557 0.9153 0.2622]
 [0.1034 0.8207 0.3188 0.4986 0.0425]]
Test M02 =
 [[0.0663 0.0814 0.3693 0.7627 0.8711]
 [0.4976 0.91   0.46   0.9855 0.2721]
 [0.4553 0.6856 0.7396 0.0703 0.5153]]
Test M03 =
 [[0.006  0.507  0.471  0.7833 0.6981]
 [0.768  0.2331 0.6684 0.8446 0.4255]
 [0.2584 0.0035 0.0397 0.4329 0.6912]]
Test M10 =
 [[0.8096 0.65   0.203  0.4162 0.091 ]
 [0.1202 0.5832 0.6279 0.1721 0.9498]
 [0.9652 0.3473 0.7482 0.7576 0.1258]]
Test M11 =
 [[0.6707 0.7799 0.4978 0.5709 0.8322]
 [0.6507 0.8383 0.298  0.8879 0.0408]
 [0.2699 0.9791 0.1847 0.0775 0.1749]]
Test M12 =
 [[0.9722 0.1981 0.9    0.099  0.9006]
 [0.0105 0.031  0.0152 0.8254 0.0699]
 [0.1349 0.9859 0.5375 0.9203 0.0969]]
Test M13 =
 [[0.0257 0.8075 0.0025 0.4043 0.417 ]
 [0.6365 0.3725 0.0133 0.8135 0.011 ]
 [0.5366 0.9857 0.9541 0.1278 0.5689]]
Test M20 =
 [[0.4723 0.6396 0.0789 0.4871 0.2265]
 [0.1508 0.705  0.6495 0.4073 0.5975]
 [0.2426 0.6745 0.6856 0.5683 0.7383]]
Test M21 =
 [[0.5205 0.009  0.362  0.5255 0.9881]
 [0.9946 0.3082 0.8308 0.0461 0.6554]
 [0.947  0.3613 0.0158 0.1698 0.1764]]
Test M22 =
 [[0.1001 0.3148 0.1315 0.8688 0.675 ]
 [0.7837 0.7604 0.5942 0.9783 0.9509]
 [0.4354 0.5464 0.5252 0.421  0.1681]]
Test M23 =
 [[0.702  0.7691 0.0534 0.3903 0.6846]
 [0.2524 0.2728 0.8212 0.6709 0.7101]
 [0.4394 0.0388 0.3597 0.4721 0.0689]]
Test M30 =
 [[0.6608 0.8521 0.9039 0.143  0.0755]
 [0.4058 0.5597 0.2166 0.7801 0.1069]
 [0.8905 0.7848 0.2349 0.7011 0.9657]]
Test M31 =
 [[0.22   0.1069 0.8112 0.4255 0.7375]
 [0.7729 0.5595 0.3963 0.9714 0.8025]
 [0.5091 0.5045 0.8174 0.6682 0.2618]]
Test M32 =
 [[0.8538 0.422  0.4301 0.3162 0.6675]
 [0.6237 0.195  0.3565 0.2729 0.9542]
 [0.8202 0.668  0.557  0.8837 0.6586]]
Test M33 =
 [[0.0793 0.6396 0.639  0.2568 0.9025]
 [0.485  0.0909 0.2346 0.8342 0.658 ]
 [0.7521 0.716  0.8943 0.1415 0.7813]]

Test M00 =
 [[1.     0.1379 0.272  0.618  0.4614]
 [0.0011 0.4945 0.8436 0.7047 0.8906]
 [0.9127 0.3338 0.0512 0.9281 0.4791]]
Test M01 =
 [[0.     0.0884 0.6332 0.0082 0.6005]
 [0.3627 0.8002 0.9557 0.9153 0.2622]
 [0.1034 0.8207 0.3188 0.4986 0.0425]]
Test M02 =
 [[0.     0.0814 0.3693 0.7627 0.8711]
 [0.4976 0.91   0.46   0.9855 0.2721]
 [0.4553 0.6856 0.7396 0.0703 0.5153]]
Test M03 =
 [[0.     0.507  0.471  0.7833 0.6981]
 [0.768  0.2331 0.6684 0.8446 0.4255]
 [0.2584 0.0035 0.0397 0.4329 0.6912]]
Test M10 =
 [[0.     0.65   0.203  0.4162 0.091 ]
 [0.1202 0.5832 0.6279 0.1721 0.9498]
 [0.9652 0.3473 0.7482 0.7576 0.1258]]
Test M11 =
 [[1.     0.7799 0.4978 0.5709 0.8322]
 [0.6507 0.8383 0.298  0.8879 0.0408]
 [0.2699 0.9791 0.1847 0.0775 0.1749]]
Test M12 =
 [[0.     0.1981 0.9    0.099  0.9006]
 [0.0105 0.031  0.0152 0.8254 0.0699]
 [0.1349 0.9859 0.5375 0.9203 0.0969]]
Test M13 =
 [[0.     0.8075 0.0025 0.4043 0.417 ]
 [0.6365 0.3725 0.0133 0.8135 0.011 ]
 [0.5366 0.9857 0.9541 0.1278 0.5689]]
Test M20 =
 [[0.     0.6396 0.0789 0.4871 0.2265]
 [0.1508 0.705  0.6495 0.4073 0.5975]
 [0.2426 0.6745 0.6856 0.5683 0.7383]]
Test M21 =
 [[0.     0.009  0.362  0.5255 0.9881]
 [0.9946 0.3082 0.8308 0.0461 0.6554]
 [0.947  0.3613 0.0158 0.1698 0.1764]]
Test M22 =
 [[1.     0.3148 0.1315 0.8688 0.675 ]
 [0.7837 0.7604 0.5942 0.9783 0.9509]
 [0.4354 0.5464 0.5252 0.421  0.1681]]
Test M23 =
 [[0.     0.7691 0.0534 0.3903 0.6846]
 [0.2524 0.2728 0.8212 0.6709 0.7101]
 [0.4394 0.0388 0.3597 0.4721 0.0689]]
Test M30 =
 [[0.     0.8521 0.9039 0.143  0.0755]
 [0.4058 0.5597 0.2166 0.7801 0.1069]
 [0.8905 0.7848 0.2349 0.7011 0.9657]]
Test M31 =
 [[0.     0.1069 0.8112 0.4255 0.7375]
 [0.7729 0.5595 0.3963 0.9714 0.8025]
 [0.5091 0.5045 0.8174 0.6682 0.2618]]
Test M32 =
 [[0.     0.422  0.4301 0.3162 0.6675]
 [0.6237 0.195  0.3565 0.2729 0.9542]
 [0.8202 0.668  0.557  0.8837 0.6586]]
Test M33 =
 [[1.     0.6396 0.639  0.2568 0.9025]
 [0.485  0.0909 0.2346 0.8342 0.658 ]
 [0.7521 0.716  0.8943 0.1415 0.7813]]

Test M00 =
 [[0.5    0.5    0.5    0.618  0.4614]
 [0.0011 0.4945 0.8436 0.7047 0.8906]
 [0.9127 0.3338 0.0512 0.9281 0.4791]]
Test M01 =
 [[ 0.5     0.     -0.5     0.0082  0.6005]
 [ 0.3627  0.8002  0.9557  0.9153  0.2622]
 [ 0.1034  0.8207  0.3188  0.4986  0.0425]]
Test M02 =
 [[0.     0.5    0.     0.7627 0.8711]
 [0.4976 0.91   0.46   0.9855 0.2721]
 [0.4553 0.6856 0.7396 0.0703 0.5153]]
Test M03 =
 [[0.     0.     0.     0.7833 0.6981]
 [0.768  0.2331 0.6684 0.8446 0.4255]
 [0.2584 0.0035 0.0397 0.4329 0.6912]]
Test M10 =
 [[ 0.5     0.     -0.5     0.4162  0.091 ]
 [ 0.1202  0.5832  0.6279  0.1721  0.9498]
 [ 0.9652  0.3473  0.7482  0.7576  0.1258]]
Test M11 =
 [[0.5    0.     0.5    0.5709 0.8322]
 [0.6507 0.8383 0.298  0.8879 0.0408]
 [0.2699 0.9791 0.1847 0.0775 0.1749]]
Test M12 =
 [[ 0.      0.     -0.      0.099   0.9006]
 [ 0.0105  0.031   0.0152  0.8254  0.0699]
 [ 0.1349  0.9859  0.5375  0.9203  0.0969]]
Test M13 =
 [[0.     0.     0.     0.4043 0.417 ]
 [0.6365 0.3725 0.0133 0.8135 0.011 ]
 [0.5366 0.9857 0.9541 0.1278 0.5689]]
Test M20 =
 [[0.     0.5    0.     0.4871 0.2265]
 [0.1508 0.705  0.6495 0.4073 0.5975]
 [0.2426 0.6745 0.6856 0.5683 0.7383]]
Test M21 =
 [[ 0.      0.     -0.      0.5255  0.9881]
 [ 0.9946  0.3082  0.8308  0.0461  0.6554]
 [ 0.947   0.3613  0.0158  0.1698  0.1764]]
Test M22 =
 [[0.     0.5    0.     0.8688 0.675 ]
 [0.7837 0.7604 0.5942 0.9783 0.9509]
 [0.4354 0.5464 0.5252 0.421  0.1681]]
Test M23 =
 [[0.     0.     0.     0.3903 0.6846]
 [0.2524 0.2728 0.8212 0.6709 0.7101]
 [0.4394 0.0388 0.3597 0.4721 0.0689]]
Test M30 =
 [[0.     0.     0.     0.143  0.0755]
 [0.4058 0.5597 0.2166 0.7801 0.1069]
 [0.8905 0.7848 0.2349 0.7011 0.9657]]
Test M31 =
 [[0.     0.     0.     0.4255 0.7375]
 [0.7729 0.5595 0.3963 0.9714 0.8025]
 [0.5091 0.5045 0.8174 0.6682 0.2618]]
Test M32 =
 [[0.     0.     0.     0.3162 0.6675]
 [0.6237 0.195  0.3565 0.2729 0.9542]
 [0.8202 0.668  0.557  0.8837 0.6586]]
Test M33 =
 [[0.     0.     0.     0.2568 0.9025]
 [0.485  0.0909 0.2346 0.8342 0.658 ]
 [0.7521 0.716  0.8943 0.1415 0.7813]]

Test M00 =
 [[0.6051 0.1379 0.272  0.618  0.4614]
 [0.0011 1.     0.8436 0.7047 0.8906]
 [0.9127 0.3338 0.0512 0.9281 0.4791]]
Test M01 =
 [[0.9857 0.0884 0.6332 0.0082 0.6005]
 [0.3627 0.     0.9557 0.9153 0.2622]
 [0.1034 0.8207 0.3188 0.4986 0.0425]]
Test M02 =
 [[0.0663 0.0814 0.3693 0.7627 0.8711]
 [0.4976 0.     0.46   0.9855 0.2721]
 [0.4553 0.6856 0.7396 0.0703 0.5153]]
Test M03 =
 [[0.006  0.507  0.471  0.7833 0.6981]
 [0.768  0.     0.6684 0.8446 0.4255]
 [0.2584 0.0035 0.0397 0.4329 0.6912]]
Test M10 =
 [[0.8096 0.65   0.203  0.4162 0.091 ]
 [0.1202 0.     0.6279 0.1721 0.9498]
 [0.9652 0.3473 0.7482 0.7576 0.1258]]
Test M11 =
 [[0.6707 0.7799 0.4978 0.5709 0.8322]
 [0.6507 1.     0.298  0.8879 0.0408]
 [0.2699 0.9791 0.1847 0.0775 0.1749]]
Test M12 =
 [[0.9722 0.1981 0.9    0.099  0.9006]
 [0.0105 0.     0.0152 0.8254 0.0699]
 [0.1349 0.9859 0.5375 0.9203 0.0969]]
Test M13 =
 [[0.0257 0.8075 0.0025 0.4043 0.417 ]
 [0.6365 0.     0.0133 0.8135 0.011 ]
 [0.5366 0.9857 0.9541 0.1278 0.5689]]
Test M20 =
 [[0.4723 0.6396 0.0789 0.4871 0.2265]
 [0.1508 0.     0.6495 0.4073 0.5975]
 [0.2426 0.6745 0.6856 0.5683 0.7383]]
Test M21 =
 [[0.5205 0.009  0.362  0.5255 0.9881]
 [0.9946 0.     0.8308 0.0461 0.6554]
 [0.947  0.3613 0.0158 0.1698 0.1764]]
Test M22 =
 [[0.1001 0.3148 0.1315 0.8688 0.675 ]
 [0.7837 1.     0.5942 0.9783 0.9509]
 [0.4354 0.5464 0.5252 0.421  0.1681]]
Test M23 =
 [[0.702  0.7691 0.0534 0.3903 0.6846]
 [0.2524 0.     0.8212 0.6709 0.7101]
 [0.4394 0.0388 0.3597 0.4721 0.0689]]
Test M30 =
 [[0.6608 0.8521 0.9039 0.143  0.0755]
 [0.4058 0.     0.2166 0.7801 0.1069]
 [0.8905 0.7848 0.2349 0.7011 0.9657]]
Test M31 =
 [[0.22   0.1069 0.8112 0.4255 0.7375]
 [0.7729 0.     0.3963 0.9714 0.8025]
 [0.5091 0.5045 0.8174 0.6682 0.2618]]
Test M32 =
 [[0.8538 0.422  0.4301 0.3162 0.6675]
 [0.6237 0.     0.3565 0.2729 0.9542]
 [0.8202 0.668  0.557  0.8837 0.6586]]
Test M33 =
 [[0.0793 0.6396 0.639  0.2568 0.9025]
 [0.485  1.     0.2346 0.8342 0.658 ]
 [0.7521 0.716  0.8943 0.1415 0.7813]]

Test M00 =
 [[1.     1.     0.272  0.618  0.4614]
 [1.     1.     0.8436 0.7047 0.8906]
 [1.     1.     0.0512 0.9281 0.4791]]
Test M01 =
 [[0.     0.     0.6332 0.0082 0.6005]
 [0.     0.     0.9557 0.9153 0.2622]
 [0.     0.     0.3188 0.4986 0.0425]]
Test M02 =
 [[0.     0.     0.3693 0.7627 0.8711]
 [0.     0.     0.46   0.9855 0.2721]
 [0.     0.     0.7396 0.0703 0.5153]]
Test M03 =
 [[0.     0.     0.471  0.7833 0.6981]
 [0.     0.     0.6684 0.8446 0.4255]
 [0.     0.     0.0397 0.4329 0.6912]]
Test M10 =
 [[0.     0.     0.203  0.4162 0.091 ]
 [0.     0.     0.6279 0.1721 0.9498]
 [0.     0.     0.7482 0.7576 0.1258]]
Test M11 =
 [[1.     1.     0.4978 0.5709 0.8322]
 [1.     1.     0.298  0.8879 0.0408]
 [1.     1.     0.1847 0.0775 0.1749]]
Test M12 =
 [[0.     0.     0.9    0.099  0.9006]
 [0.     0.     0.0152 0.8254 0.0699]
 [0.     0.     0.5375 0.9203 0.0969]]
Test M13 =
 [[0.     0.     0.0025 0.4043 0.417 ]
 [0.     0.     0.0133 0.8135 0.011 ]
 [0.     0.     0.9541 0.1278 0.5689]]
Test M20 =
 [[0.     0.     0.0789 0.4871 0.2265]
 [0.     0.     0.6495 0.4073 0.5975]
 [0.     0.     0.6856 0.5683 0.7383]]
Test M21 =
 [[0.     0.     0.362  0.5255 0.9881]
 [0.     0.     0.8308 0.0461 0.6554]
 [0.     0.     0.0158 0.1698 0.1764]]
Test M22 =
 [[1.     1.     0.1315 0.8688 0.675 ]
 [1.     1.     0.5942 0.9783 0.9509]
 [1.     1.     0.5252 0.421  0.1681]]
Test M23 =
 [[0.     0.     0.0534 0.3903 0.6846]
 [0.     0.     0.8212 0.6709 0.7101]
 [0.     0.     0.3597 0.4721 0.0689]]
Test M30 =
 [[0.     0.     0.9039 0.143  0.0755]
 [0.     0.     0.2166 0.7801 0.1069]
 [0.     0.     0.2349 0.7011 0.9657]]
Test M31 =
 [[0.     0.     0.8112 0.4255 0.7375]
 [0.     0.     0.3963 0.9714 0.8025]
 [0.     0.     0.8174 0.6682 0.2618]]
Test M32 =
 [[0.     0.     0.4301 0.3162 0.6675]
 [0.     0.     0.3565 0.2729 0.9542]
 [0.     0.     0.557  0.8837 0.6586]]
Test M33 =
 [[1.     1.     0.639  0.2568 0.9025]
 [1.     1.     0.2346 0.8342 0.658 ]
 [1.     1.     0.8943 0.1415 0.7813]]

Test M00 =
 [[0.6051 0.1379 1.     0.618  1.    ]
 [0.0011 1.     0.8436 0.7047 0.8906]
 [0.9127 0.3338 0.0512 0.9281 0.4791]]
Test M01 =
 [[0.9857 0.0884 0.     0.0082 0.    ]
 [0.3627 0.     0.9557 0.9153 0.2622]
 [0.1034 0.8207 0.3188 0.4986 0.0425]]
Test M02 =
 [[0.0663 0.0814 0.     0.7627 0.    ]
 [0.4976 0.     0.46   0.9855 0.2721]
 [0.4553 0.6856 0.7396 0.0703 0.5153]]
Test M03 =
 [[0.006  0.507  0.     0.7833 0.    ]
 [0.768  0.     0.6684 0.8446 0.4255]
 [0.2584 0.0035 0.0397 0.4329 0.6912]]
Test M10 =
 [[0.8096 0.65   0.     0.4162 0.    ]
 [0.1202 0.     0.6279 0.1721 0.9498]
 [0.9652 0.3473 0.7482 0.7576 0.1258]]
Test M11 =
 [[0.6707 0.7799 1.     0.5709 1.    ]
 [0.6507 1.     0.298  0.8879 0.0408]
 [0.2699 0.9791 0.1847 0.0775 0.1749]]
Test M12 =
 [[0.9722 0.1981 0.     0.099  0.    ]
 [0.0105 0.     0.0152 0.8254 0.0699]
 [0.1349 0.9859 0.5375 0.9203 0.0969]]
Test M13 =
 [[0.0257 0.8075 0.     0.4043 0.    ]
 [0.6365 0.     0.0133 0.8135 0.011 ]
 [0.5366 0.9857 0.9541 0.1278 0.5689]]
Test M20 =
 [[0.4723 0.6396 0.     0.4871 0.    ]
 [0.1508 0.     0.6495 0.4073 0.5975]
 [0.2426 0.6745 0.6856 0.5683 0.7383]]
Test M21 =
 [[0.5205 0.009  0.     0.5255 0.    ]
 [0.9946 0.     0.8308 0.0461 0.6554]
 [0.947  0.3613 0.0158 0.1698 0.1764]]
Test M22 =
 [[0.1001 0.3148 1.     0.8688 1.    ]
 [0.7837 1.     0.5942 0.9783 0.9509]
 [0.4354 0.5464 0.5252 0.421  0.1681]]
Test M23 =
 [[0.702  0.7691 0.     0.3903 0.    ]
 [0.2524 0.     0.8212 0.6709 0.7101]
 [0.4394 0.0388 0.3597 0.4721 0.0689]]
Test M30 =
 [[0.6608 0.8521 0.     0.143  0.    ]
 [0.4058 0.     0.2166 0.7801 0.1069]
 [0.8905 0.7848 0.2349 0.7011 0.9657]]
Test M31 =
 [[0.22   0.1069 0.     0.4255 0.    ]
 [0.7729 0.     0.3963 0.9714 0.8025]
 [0.5091 0.5045 0.8174 0.6682 0.2618]]
Test M32 =
 [[0.8538 0.422  0.     0.3162 0.    ]
 [0.6237 0.     0.3565 0.2729 0.9542]
 [0.8202 0.668  0.557  0.8837 0.6586]]
Test M33 =
 [[0.0793 0.6396 1.     0.2568 1.    ]
 [0.485  1.     0.2346 0.8342 0.658 ]
 [0.7521 0.716  0.8943 0.1415 0.7813]]

Test M00 =
 [[1.     0.1379 0.272  1.     0.4614]
 [0.0011 0.4945 1.     1.     1.    ]
 [1.     0.3338 0.0512 1.     0.4791]]
Test M01 =
 [[0.     0.0884 0.6332 0.     0.6005]
 [0.3627 0.8002 0.     0.     0.    ]
 [0.     0.8207 0.3188 0.     0.0425]]
Test M02 =
 [[0.     0.0814 0.3693 0.     0.8711]
 [0.4976 0.91   0.     0.     0.    ]
 [0.     0.6856 0.7396 0.     0.5153]]
Test M03 =
 [[0.     0.507  0.471  0.     0.6981]
 [0.768  0.2331 0.     0.     0.    ]
 [0.     0.0035 0.0397 0.     0.6912]]
Test M10 =
 [[0.     0.65   0.203  0.     0.091 ]
 [0.1202 0.5832 0.     0.     0.    ]
 [0.     0.3473 0.7482 0.     0.1258]]
Test M11 =
 [[1.     0.7799 0.4978 1.     0.8322]
 [0.6507 0.8383 1.     1.     1.    ]
 [1.     0.9791 0.1847 1.     0.1749]]
Test M12 =
 [[0.     0.1981 0.9    0.     0.9006]
 [0.0105 0.031  0.     0.     0.    ]
 [0.     0.9859 0.5375 0.     0.0969]]
Test M13 =
 [[0.     0.8075 0.0025 0.     0.417 ]
 [0.6365 0.3725 0.     0.     0.    ]
 [0.     0.9857 0.9541 0.     0.5689]]
Test M20 =
 [[0.     0.6396 0.0789 0.     0.2265]
 [0.1508 0.705  0.     0.     0.    ]
 [0.     0.6745 0.6856 0.     0.7383]]
Test M21 =
 [[0.     0.009  0.362  0.     0.9881]
 [0.9946 0.3082 0.     0.     0.    ]
 [0.     0.3613 0.0158 0.     0.1764]]
Test M22 =
 [[1.     0.3148 0.1315 1.     0.675 ]
 [0.7837 0.7604 1.     1.     1.    ]
 [1.     0.5464 0.5252 1.     0.1681]]
Test M23 =
 [[0.     0.7691 0.0534 0.     0.6846]
 [0.2524 0.2728 0.     0.     0.    ]
 [0.     0.0388 0.3597 0.     0.0689]]
Test M30 =
 [[0.     0.8521 0.9039 0.     0.0755]
 [0.4058 0.5597 0.     0.     0.    ]
 [0.     0.7848 0.2349 0.     0.9657]]
Test M31 =
 [[0.     0.1069 0.8112 0.     0.7375]
 [0.7729 0.5595 0.     0.     0.    ]
 [0.     0.5045 0.8174 0.     0.2618]]
Test M32 =
 [[0.     0.422  0.4301 0.     0.6675]
 [0.6237 0.195  0.     0.     0.    ]
 [0.     0.668  0.557  0.     0.6586]]
Test M33 =
 [[1.     0.6396 0.639  1.     0.9025]
 [0.485  0.0909 1.     1.     1.    ]
 [1.     0.716  0.8943 1.     0.7813]]

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Manipulations">
<h1>Manipulations<a class="headerlink" href="#Manipulations" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Reciprocal</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reciprocal of M =
[+0.064 +0.269 -0.057 +0.410]
[+0.291 +0.611 -0.503 +0.262]
[-0.279 -0.869 +0.216 -0.403]
[+0.525 +0.491 -0.191 +0.489]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Covariance</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0299</span><span class="p">,</span> <span class="mf">0.0027</span><span class="p">,</span> <span class="mf">0.0058</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">0.0186</span><span class="p">,</span> <span class="mf">0.9956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0361</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">0.0129</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.2207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9656</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.028</span><span class="p">,</span> <span class="mf">0.9706</span><span class="p">,</span> <span class="mf">0.2231</span><span class="p">]])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 -0.030 +0.003 +0.006]
[-0.019 +0.996 -0.036 +0.032]
[-0.013 +0.039 +0.221 -0.966]
[+0.001 +0.028 +0.971 +0.223]

Covariant of M =
[+0.487+0.000j -0.008+0.009j +0.007-0.007j +0.111-0.484j]
[-0.008-0.009j +0.004+0.000j -0.001-0.001j -0.013+0.007j]
[+0.007+0.007j -0.001+0.001j -0.002+0.000j +0.010-0.007j]
[+0.111+0.484j -0.013-0.007j +0.010+0.007j +0.511+0.000j]

M =
[+1.000 -0.030 +0.003 +0.006]   [+1.000 -0.030 +0.003 +0.006]
[-0.019 +0.996 -0.036 +0.032]   [-0.019 +0.996 -0.036 +0.032]
[-0.013 +0.039 +0.221 -0.966]   [-0.013 +0.039 +0.221 -0.966]
[+0.001 +0.028 +0.971 +0.223]   [+0.001 +0.028 +0.971 +0.223]

Covariant of M =
[+0.487+0.000j -0.008+0.009j +0.007-0.007j +0.111-0.484j]   [+0.487+0.000j -0.008+0.009j +0.007-0.007j +0.111-0.484j]
[-0.008-0.009j +0.004+0.000j -0.001-0.001j -0.013+0.007j]   [-0.008-0.009j +0.004+0.000j -0.001-0.001j -0.013+0.007j]
[+0.007+0.007j -0.001+0.001j -0.002+0.000j +0.010-0.007j]   [+0.007+0.007j -0.001+0.001j -0.002+0.000j +0.010-0.007j]
[+0.111+0.484j -0.013-0.007j +0.010+0.007j +0.511+0.000j]   [+0.111+0.484j -0.013-0.007j +0.010+0.007j +0.511+0.000j]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Inverse</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_inv</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0.4978 0.52   0.1718 0.8654]
 [0.6095 0.7815 0.3387 0.7412]
 [0.9696 0.644  0.8155 0.8598]
 [0.8997 0.9383 0.5053 0.1119]]
[[ 5.6029 -7.0221  0.0626  2.701 ]
 [-2.6702  4.3405 -1.0046 -0.3803]
 [-5.1413  4.3161  1.7032 -1.9148]
 [ 0.558   0.5742  0.2294 -0.9449]]
Inverse of M =
[+5.603 -7.022 +0.063 +2.701]
[-2.670 +4.341 -1.005 -0.380]
[-5.141 +4.316 +1.703 -1.915]
[+0.558 +0.574 +0.229 -0.945]

M =
[+0.498 +0.520 +0.172 +0.865]   [+0.498 +0.520 +0.172 +0.865]
[+0.609 +0.781 +0.339 +0.741]   [+0.609 +0.781 +0.339 +0.741]
[+0.970 +0.644 +0.816 +0.860]   [+0.970 +0.644 +0.816 +0.860]
[+0.900 +0.938 +0.505 +0.112]   [+0.900 +0.938 +0.505 +0.112]

Inverse of M =
[+5.603 -7.022 +0.063 +2.701]   [+5.603 -7.022 +0.063 +2.701]
[-2.670 +4.341 -1.005 -0.380]   [-2.670 +4.341 -1.005 -0.380]
[-5.141 +4.316 +1.703 -1.915]   [-5.141 +4.316 +1.703 -1.915]
[+0.558 +0.574 +0.229 -0.945]   [+0.558 +0.574 +0.229 -0.945]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Sum</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">M_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_sum</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">M_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_sum</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[4.258  2.7375 3.0953 4.6762]
 [3.3477 3.4765 2.7943 3.7375]
 [2.4513 2.6773 2.7286 5.4701]
 [3.2378 4.0904 2.2318 2.7313]]
Sum of M =
[+4.258 +2.738 +3.095 +4.676]
[+3.348 +3.476 +2.794 +3.737]
[+2.451 +2.677 +2.729 +5.470]
[+3.238 +4.090 +2.232 +2.731]

[[[2.6284 3.7821]
  [3.0079 4.4521]
  [3.7883 3.6465]
  [4.4181 4.4818]]

 [[3.2038 2.2931]
  [4.4659 2.3319]
  [4.3016 4.5303]
  [3.963  3.6659]]

 [[3.5643 4.1571]
  [3.5755 4.4377]
  [4.4975 3.2886]
  [2.5316 2.4611]]

 [[3.9021 3.0414]
  [3.1234 2.9692]
  [3.8462 3.0058]
  [4.9228 3.2883]]]
Sum of M =
[+2.628 +3.008 +3.788 +4.418]   [+3.782 +4.452 +3.647 +4.482]
[+3.204 +4.466 +4.302 +3.963]   [+2.293 +2.332 +4.530 +3.666]
[+3.564 +3.576 +4.497 +2.532]   [+4.157 +4.438 +3.289 +2.461]
[+3.902 +3.123 +3.846 +4.923]   [+3.041 +2.969 +3.006 +3.288]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Prod</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Prod of M =
[+18.838 +33.817 +23.625 +23.326]
[+19.571 +35.135 +24.545 +24.235]
[+19.535 +35.075 +24.503 +24.194]
[+15.579 +27.977 +19.544 +19.299]

Prod of M =
[+28.878 +44.642 +15.768 +31.358]   [+24.549 +40.501 +26.525 +20.235]
[+21.220 +32.804 +11.586 +23.043]   [+36.563 +60.323 +39.506 +30.137]
[+19.492 +30.130 +10.647 +21.160]   [+34.712 +57.269 +37.506 +28.611]
[+17.205 +26.595 +9.397 +18.679]   [+41.116 +67.835 +44.426 +33.890]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rotation</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M @ 45.00 deg @ -45.00 deg =
[+0.500 +0.500 +0.000 +0.000]
[+0.500 +0.500 +0.000 +0.000]
[+0.000 +0.000 -0.000 +0.000]
[+0.000 +0.000 +0.000 +0.000]

M =
[+0.500 +0.500 +0.000 +0.000]   [+0.500 +0.354 +0.354 +0.000]   [+0.500 +0.000 +0.500 +0.000]   [+0.500 -0.354 +0.354 +0.000]   [+0.500 -0.500 +0.000 +0.000]
[+0.500 +0.500 +0.000 +0.000]   [+0.354 +0.250 +0.250 +0.000]   [+0.000 +0.000 +0.000 +0.000]   [-0.354 +0.250 -0.250 +0.000]   [-0.500 +0.500 -0.000 +0.000]
[+0.000 +0.000 +0.000 +0.000]   [+0.354 +0.250 +0.250 +0.000]   [+0.500 +0.000 +0.500 +0.000]   [+0.354 -0.250 +0.250 +0.000]   [+0.000 -0.000 +0.000 +0.000]
[+0.000 +0.000 +0.000 +0.000]   [+0.000 +0.000 +0.000 +0.000]   [+0.000 +0.000 +0.000 +0.000]   [+0.000 +0.000 +0.000 +0.000]   [+0.000 +0.000 +0.000 +0.000]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Transpose</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M M00 =
 [[0.6911 0.1145 0.6827 0.9796 0.4412]
 [0.3695 0.1666 0.5248 0.7615 0.7215]
 [0.2727 0.8463 0.5781 0.492  0.3702]]
M M01 =
 [[0.3528 0.2982 0.6915 0.1553 0.4533]
 [0.9151 0.8994 0.7778 0.5599 0.2437]
 [0.587  0.7331 0.2989 0.2921 0.0176]]
M M02 =
 [[0.1834 0.5844 0.7942 0.7081 0.2038]
 [0.876  0.3831 0.7564 0.7376 0.0656]
 [0.6749 0.4997 0.7845 0.026  0.4812]]
M M03 =
 [[0.1923 0.2564 0.0922 0.7918 0.3508]
 [0.2894 0.7356 0.5774 0.7657 0.9606]
 [0.2219 0.2043 0.0827 0.1359 0.9943]]
M M10 =
 [[0.2047 0.4324 0.3322 0.9304 0.8392]
 [0.0774 0.3566 0.5225 0.2166 0.5159]
 [0.7202 0.0343 0.4197 0.2068 0.076 ]]
M M11 =
 [[0.4515 0.7766 0.3912 0.4663 0.519 ]
 [0.6766 0.2885 0.2852 0.4591 0.4679]
 [0.3283 0.1528 0.9993 0.6379 0.9936]]
M M12 =
 [[0.4685 0.4969 0.3027 0.6232 0.9848]
 [0.3985 0.2489 0.9318 0.5894 0.2407]
 [0.0741 0.8076 0.7412 0.4468 0.7972]]
M M13 =
 [[0.8232 0.5218 0.9742 0.7417 0.1483]
 [0.8531 0.7992 0.1435 0.9364 0.1097]
 [0.9096 0.3715 0.9414 0.3253 0.073 ]]
M M20 =
 [[0.1448 0.9742 0.3415 0.1773 0.0849]
 [0.2243 0.9629 0.2837 0.3469 0.9908]
 [0.7252 0.6473 0.15   0.9798 0.3755]]
M M21 =
 [[0.7842 0.0261 0.4437 0.7264 0.7747]
 [0.6917 0.0332 0.9895 0.7923 0.6556]
 [0.9928 0.5082 0.0271 0.5888 0.2913]]
M M22 =
 [[0.8783 0.9521 0.2003 0.9892 0.7705]
 [0.9601 0.1325 0.4016 0.9842 0.7562]
 [0.7876 0.4648 0.66   0.0358 0.5976]]
M M23 =
 [[0.4636 0.3746 0.5477 0.7924 0.1094]
 [0.2565 0.314  0.9879 0.0931 0.6662]
 [0.3236 0.3572 0.05   0.0072 0.1319]]
M M30 =
 [[0.2924 0.3308 0.107  0.8289 0.159 ]
 [0.6222 0.0566 0.7629 0.6997 0.6678]
 [0.7677 0.4093 0.9884 0.8976 0.6551]]
M M31 =
 [[0.8507 0.2303 0.3895 0.9155 0.4602]
 [0.0672 0.134  0.1346 0.5928 0.4037]
 [0.9829 0.5225 0.4357 0.0102 0.7111]]
M M32 =
 [[0.4666 0.5085 0.5419 0.9158 0.324 ]
 [0.7453 0.9494 0.8464 0.9075 0.3709]
 [0.2558 0.9422 0.5278 0.6838 0.8763]]
M M33 =
 [[0.4243 0.7792 0.4469 0.4133 0.0916]
 [0.0207 0.8937 0.1062 0.3003 0.0178]
 [0.4203 0.5321 0.9847 0.8033 0.649 ]]
 Transpose of M M00 =
 [[0.6911 0.1145 0.6827 0.9796 0.4412]
 [0.3695 0.1666 0.5248 0.7615 0.7215]
 [0.2727 0.8463 0.5781 0.492  0.3702]]
Transpose of M M01 =
 [[0.2047 0.4324 0.3322 0.9304 0.8392]
 [0.0774 0.3566 0.5225 0.2166 0.5159]
 [0.7202 0.0343 0.4197 0.2068 0.076 ]]
Transpose of M M02 =
 [[0.1448 0.9742 0.3415 0.1773 0.0849]
 [0.2243 0.9629 0.2837 0.3469 0.9908]
 [0.7252 0.6473 0.15   0.9798 0.3755]]
Transpose of M M03 =
 [[0.2924 0.3308 0.107  0.8289 0.159 ]
 [0.6222 0.0566 0.7629 0.6997 0.6678]
 [0.7677 0.4093 0.9884 0.8976 0.6551]]
Transpose of M M10 =
 [[0.3528 0.2982 0.6915 0.1553 0.4533]
 [0.9151 0.8994 0.7778 0.5599 0.2437]
 [0.587  0.7331 0.2989 0.2921 0.0176]]
Transpose of M M11 =
 [[0.4515 0.7766 0.3912 0.4663 0.519 ]
 [0.6766 0.2885 0.2852 0.4591 0.4679]
 [0.3283 0.1528 0.9993 0.6379 0.9936]]
Transpose of M M12 =
 [[0.7842 0.0261 0.4437 0.7264 0.7747]
 [0.6917 0.0332 0.9895 0.7923 0.6556]
 [0.9928 0.5082 0.0271 0.5888 0.2913]]
Transpose of M M13 =
 [[0.8507 0.2303 0.3895 0.9155 0.4602]
 [0.0672 0.134  0.1346 0.5928 0.4037]
 [0.9829 0.5225 0.4357 0.0102 0.7111]]
Transpose of M M20 =
 [[0.1834 0.5844 0.7942 0.7081 0.2038]
 [0.876  0.3831 0.7564 0.7376 0.0656]
 [0.6749 0.4997 0.7845 0.026  0.4812]]
Transpose of M M21 =
 [[0.4685 0.4969 0.3027 0.6232 0.9848]
 [0.3985 0.2489 0.9318 0.5894 0.2407]
 [0.0741 0.8076 0.7412 0.4468 0.7972]]
Transpose of M M22 =
 [[0.8783 0.9521 0.2003 0.9892 0.7705]
 [0.9601 0.1325 0.4016 0.9842 0.7562]
 [0.7876 0.4648 0.66   0.0358 0.5976]]
Transpose of M M23 =
 [[0.4666 0.5085 0.5419 0.9158 0.324 ]
 [0.7453 0.9494 0.8464 0.9075 0.3709]
 [0.2558 0.9422 0.5278 0.6838 0.8763]]
Transpose of M M30 =
 [[0.1923 0.2564 0.0922 0.7918 0.3508]
 [0.2894 0.7356 0.5774 0.7657 0.9606]
 [0.2219 0.2043 0.0827 0.1359 0.9943]]
Transpose of M M31 =
 [[0.8232 0.5218 0.9742 0.7417 0.1483]
 [0.8531 0.7992 0.1435 0.9364 0.1097]
 [0.9096 0.3715 0.9414 0.3253 0.073 ]]
Transpose of M M32 =
 [[0.4636 0.3746 0.5477 0.7924 0.1094]
 [0.2565 0.314  0.9879 0.0931 0.6662]
 [0.3236 0.3572 0.05   0.0072 0.1319]]
Transpose of M M33 =
 [[0.4243 0.7792 0.4469 0.4133 0.0916]
 [0.0207 0.8937 0.1062 0.3003 0.0178]
 [0.4203 0.5321 0.9847 0.8033 0.649 ]]

</pre></div></div>
</div>
</div>
<div class="section" id="Parameters">
<h1>Parameters<a class="headerlink" href="#Parameters" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Global phase</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">124</span><span class="p">),</span> <span class="n">global_phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">global_phase</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The global phase of M is (deg):
The mean value is 178.31886584887582 +- 104.08458763278169
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_45_1.png" src="../../../_images/source_development_2D_Mueller_45_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># mean_transmission</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">124</span><span class="p">),</span> <span class="n">global_phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mean_transmission</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The mean transmission of M is:
The mean value is 0.498656008760468 +- 0.28723555913455234
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_46_1.png" src="../../../_images/source_development_2D_Mueller_46_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuation_vector</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span>
<span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation_vector</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The diattenuation vector of M is:
The mean value of param D[0] is 0.5045384860031636 +- 0.28874103194810136
The mean value of param D[1] is 0.505371453056251 +- 0.2887020152568286
The mean value of param D[2] is 0.5029680956543261 +- 0.2895479443047954
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_47_1.png" src="../../../_images/source_development_2D_Mueller_47_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarizance_vector</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span>
<span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance_vector</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The polarizance vector of M is:
The mean value of param P[0] is 0.49985642806304226 +- 0.2899195192723353
The mean value of param P[1] is 0.504944751921371 +- 0.28723672280524615
The mean value of param P[2] is 0.498756528427543 +- 0.289148827288694
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_48_1.png" src="../../../_images/source_development_2D_Mueller_48_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># small_matrix</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span>
<span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">small_matrix</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The small matrix of M is:
The mean value of param m[0,0] is 0.5037760951638504 +- 0.2882812764524644
The mean value of param m[0,1] is 0.49825226213531004 +- 0.2886481304937016
The mean value of param m[0,2] is 0.4993038820421767 +- 0.2876519766921012
The mean value of param m[1,0] is 0.5037317606077482 +- 0.287665407842948
The mean value of param m[1,1] is 0.5000525144594085 +- 0.2867451542784519
The mean value of param m[1,2] is 0.498645229529864 +- 0.28784126080261274
The mean value of param m[2,0] is 0.49919122228402 +- 0.2881309893353218
The mean value of param m[2,1] is 0.5000379701109429 +- 0.2890532364926544
The mean value of param m[2,2] is 0.5001198250902718 +- 0.287975906920769
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_49_1.png" src="../../../_images/source_development_2D_Mueller_49_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># blocks</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span>
<span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">blocks</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The block components of M are:
  - M_00 of M is:
The mean value is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_50_1.png" src="../../../_images/source_development_2D_Mueller_50_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  - Diattenuation vector of M is:
The mean value of param D[0] is 0.5000631035798999 +- 0.28939733575528515
The mean value of param D[1] is 0.49568341514437475 +- 0.28810993500718146
The mean value of param D[2] is 0.498730973759547 +- 0.28925059718326124
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_50_3.png" src="../../../_images/source_development_2D_Mueller_50_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  - Polarizance vector of M is:
The mean value of param P[0] is 0.5031678827387109 +- 0.28951897288040257
The mean value of param P[1] is 0.49978400566887954 +- 0.2879636002595626
The mean value of param P[2] is 0.5002423574026172 +- 0.2897899128244004
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_50_5.png" src="../../../_images/source_development_2D_Mueller_50_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

  - Small matrix of M is:
The mean value of param m[0,0] is 0.5021280500782109 +- 0.2882095498081859
The mean value of param m[0,1] is 0.501897823775156 +- 0.2896617726607494
The mean value of param m[0,2] is 0.5017115193206271 +- 0.28712659465064083
The mean value of param m[1,0] is 0.4986991804175475 +- 0.2880901994459931
The mean value of param m[1,1] is 0.5013071219294618 +- 0.28758623399244393
The mean value of param m[1,2] is 0.500921349425058 +- 0.289233140332088
The mean value of param m[2,0] is 0.49803407749760603 +- 0.2890578034390688
The mean value of param m[2,1] is 0.49854710495542526 +- 0.28946061798636036
The mean value of param m[2,2] is 0.497766348311522 +- 0.2892552955421516
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_50_7.png" src="../../../_images/source_development_2D_Mueller_50_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># inhomogeneity</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">inhomogeneity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span> <span class="mi">124</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span><span class="mi">124</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">124</span><span class="p">,</span><span class="mi">124</span><span class="p">),</span> <span class="n">global_phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">inhomogeneity</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.530 +0.280 +0.000 +0.000]
[+0.280 +0.530 +0.000 +0.000]
[+0.000 +0.000 +0.450 +0.000]
[+0.000 +0.000 +0.000 +0.450]

The inhomogeneity parameter of M is:
0.0

The inhomogeneity parameter of M is:
The mean value is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_51_1.png" src="../../../_images/source_development_2D_Mueller_51_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuation</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The diattenuation of M is:
0.11724137931034477

The diattenuation of M is:
The mean value is 0.5716185551374121 +- 0.32159220319724
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_52_1.png" src="../../../_images/source_development_2D_Mueller_52_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuation_linear</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation_linear</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation_linear</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The linear diattenuation of M is:
0.11724137931034477

The linear diattenuation of M is:
The mean value is 0.5721154447580993 +- 0.32262582401695944
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_53_1.png" src="../../../_images/source_development_2D_Mueller_53_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuation_circular</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation_circular</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">diattenuation_circular</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The circular diattenuation of M is:
0.0

The circular diattenuation of M is:
The mean value is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_54_1.png" src="../../../_images/source_development_2D_Mueller_54_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarizance</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The polarizance of M is:
0.11724137931034477

The polarizance of M is:
The mean value is 0.572770125188474 +- 0.3208023480506758
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_55_1.png" src="../../../_images/source_development_2D_Mueller_55_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarizance_linear</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance_linear</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance_linear</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The linear polarizance of M is:
0.11724137931034477

The linear polarizance of M is:
The mean value is 0.5727094390509356 +- 0.3208132494308323
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_56_1.png" src="../../../_images/source_development_2D_Mueller_56_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarizance_circular</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance_circular</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarizance_circular</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The circular polarizance of M is:
0.0

The circular polarizance of M is:
The mean value is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_57_1.png" src="../../../_images/source_development_2D_Mueller_57_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># degree_polarizance</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_polarizance</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_polarizance</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The degree of polarizance of M is:
0.11724137931034477

The degree of polarizance of M is:
The mean value is 0.5700355357146681 +- 0.31934635806361567
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_58_1.png" src="../../../_images/source_development_2D_Mueller_58_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># spheric_purity</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">spheric_purity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">spheric_purity</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The degree of spherical purity of M is:
0.9954076079601455

The degree of spherical purity of M is:
The mean value is 0.8305426306369194 +- 0.14765751566921745
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_59_1.png" src="../../../_images/source_development_2D_Mueller_59_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retardance</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">retardance</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">retardance</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The retardance of M is:
1.5707963267948966

The retardance of M is:
The mean value is 1.5710688980745018 +- 0.9124794261910893
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_60_1.png" src="../../../_images/source_development_2D_Mueller_60_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

1.8951311264374816e-12
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eig</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">vect</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The eigenvalues of M are:
  v1
0.81
  v2
0.25
  v3
0.45
  v4
0.45

The eigenvectors of M are:
  e1 I
[0.7071]
  e1 Q
[0.7071]
  e1 U
[0.]
  e1 V
[0.]
  e2 I
[-0.7071]
  e2 Q
[0.7071]
  e2 U
[0.]
  e2 V
[0.]
  e3 I
[0.]
  e3 Q
[0.]
  e3 U
[1.]
  e3 V
[0.]
  e4 I
[0.]
  e4 Q
[0.]
  e4 U
[0.]
  e4 V
[1.]

The eigenvalues of M are:
The mean value of param v1 is 0.6555411030176901 +- 0.2502787075504062
The mean value of param v2 is 0.40445889698231013 +- 0.2502787075504063
The mean value of param v3 is 0.45000000000000007 +- 9.38924331535911e-17
The mean value of param v4 is 0.4500000000000002 +- 1.6653345369377348e-16
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_61_1.png" src="../../../_images/source_development_2D_Mueller_61_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

The eigenvectors of M are:
The mean value of param e1 I is 0.2017020253826872 +- 0.6777287753640994
The mean value of param e1 Q is 0.31902326606047027 +- 0.31999195923734497
The mean value of param e1 U is 0.3876191346300722 +- 0.3815504006080843
The mean value of param e1 V is 0.0 +- 0.0
The mean value of param e2 I is 0.3987133059890327 +- 0.5839757697261899
The mean value of param e2 Q is -0.11091029160126126 +- 0.43802922902629177
The mean value of param e2 U is -0.07642018366391444 +- 0.5385065062414096
The mean value of param e2 V is 0.0 +- 0.0
The mean value of param e3 I is 3.798867848767834e-19 +- 3.097693089552745e-16
The mean value of param e3 Q is -0.2944614811026573 +- 0.7105990709379943
The mean value of param e3 U is 0.5475204932414153 +- 0.3294885521676982
The mean value of param e3 V is 0.0 +- 0.0
The mean value of param e4 I is 0.0 +- 0.0
The mean value of param e4 Q is 0.0 +- 0.0
The mean value of param e4 U is 0.0 +- 0.0
The mean value of param e4 V is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_61_3.png" src="../../../_images/source_development_2D_Mueller_61_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

(4, 124, 124)
(4, 124, 124)
(4, 124, 124)
(4, 124, 124)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eig</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">values_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">vect</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">values_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">vect</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 1) (4, 4, 1)
(4, 124, 124) (4, 4, 124, 124)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eigenvalues</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The eigenvalues of M are:
  v1
0.81
  v2
0.25
  v3
0.45
  v4
0.45

(0.81, 0.25, 0.45, 0.45)
The eigenvalues of M are:
The mean value of param v1 is 0.6551040582726327 +- 0.2504974542859023
The mean value of param v2 is 0.40489594172736737 +- 0.2504974542859024
The mean value of param v3 is 0.45000000000000007 +- 9.468417854216093e-17
The mean value of param v4 is 0.4500000000000002 +- 1.6653345369377348e-16
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_63_1.png" src="../../../_images/source_development_2D_Mueller_63_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eigenvectors</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The eigenvectors of M are:
  e1 I
[0.7071]
  e1 Q
[0.7071]
  e1 U
[0.]
  e1 V
[0.]
  e2 I
[-0.7071]
  e2 Q
[0.7071]
  e2 U
[0.]
  e2 V
[0.]
  e3 I
[0.]
  e3 Q
[0.]
  e3 U
[1.]
  e3 V
[0.]
  e4 I
[0.]
  e4 Q
[0.]
  e4 U
[0.]
  e4 V
[1.]

The eigenvectors of M are:
The mean value of param e1 I is 0.19563164978977457 +- 0.6795058922485743
The mean value of param e1 Q is 0.31620248479215074 +- 0.32204466470858056
The mean value of param e1 U is 0.3899111686606028 +- 0.3798322038713021
The mean value of param e1 V is 0.0 +- 0.0
The mean value of param e2 I is 0.3938386104371483 +- 0.5872743387284481
The mean value of param e2 Q is -0.10747799100047259 +- 0.43834376795672
The mean value of param e2 U is -0.07113305867543752 +- 0.5396696308923491
The mean value of param e2 V is 0.0 +- 0.0
The mean value of param e3 I is -4.504101859228661e-19 +- 3.124319678272183e-16
The mean value of param e3 Q is -0.2822474874886892 +- 0.7162002519507638
The mean value of param e3 U is 0.5468544059134464 +- 0.32915621465352346
The mean value of param e3 V is 0.0 +- 0.0
The mean value of param e4 I is 0.0 +- 0.0
The mean value of param e4 Q is 0.0 +- 0.0
The mean value of param e4 U is 0.0 +- 0.0
The mean value of param e4 V is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_64_1.png" src="../../../_images/source_development_2D_Mueller_64_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[[0.1182 0.423 ]
  [0.8484 0.8905]]

 [[0.3381 0.3041]
  [0.3288 0.9494]]

 [[0.05   0.9693]
  [0.7651 0.0544]]

 [[0.5028 0.4147]
  [0.9216 0.3065]]

 [[0.2008 0.8874]
  [0.5355 0.7669]]]
(2, 5)
(5, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">(</span><span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vect</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenvectors</span><span class="p">(</span><span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vect</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 4, 1)
(4, 4, 124, 124)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eigenstates</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eigenstates</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\jones_matrix.py:513: ComplexWarning: Casting complex values to real discards the imaginary part
  self.M = np.array(self.M, dtype=float)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The eigenstates of M are:
  S1 I
1.0
  S1 Q
-1.0
  S1 U
0.0
  S1 V
-0.0
  S2 I
1.0
  S2 Q
1.0
  S2 U
0.0
  S2 V
-0.0

The eigenstates of M are:
The mean value of param S1 I is 1.0 +- 1.4976571345165623e-16
The mean value of param S1 Q is -0.45073253791548035 +- 0.4478476789992204
The mean value of param S1 U is -0.7089421956062785 +- 0.3060614300565011
The mean value of param S1 V is 0.0 +- 0.0
The mean value of param S2 I is 1.0 +- 1.4976571345165623e-16
The mean value of param S2 Q is 0.45073253791548035 +- 0.4478476789992204
The mean value of param S2 U is 0.7089421956062785 +- 0.3060614300565011
The mean value of param S2 V is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_67_2.png" src="../../../_images/source_development_2D_Mueller_67_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eigenstates</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transmissions</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="mi">124</span>
<span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">angles</span><span class="p">)</span>
<span class="n">vect</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transmissions</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The transmissions of M are:
  Maximum
0.8099999999999999
  Minimum
0.25

The transmissions of M are:
The mean value of param Maximum is 0.81 +- 1.0342256097088707e-16
The mean value of param Minimum is 0.25 +- 2.5363609911654436e-17
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_68_1.png" src="../../../_images/source_development_2D_Mueller_68_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retardance_vector</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">half_waveplate</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">retardance_vector</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">90</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">retardance_vector</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The retardance vector (norm) components components of M are:
  r0
[-1.]
  r1
[0.]
  r2
[-0.]

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\jones_vector.py:455: ComplexWarning: Casting complex values to real discards the imaginary part
  self.M = np.array(self.M, dtype=float)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The retardance vector (norm) components components of M are:
The mean value of param r0 is -0.012313252524700107 +- 0.7066163874856244
The mean value of param r1 is 0.0032569004440678455 +- 0.49926128158704397
The mean value of param r2 is 0.004348875370423008 +- 0.5012487579432007
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_69_3.png" src="../../../_images/source_development_2D_Mueller_69_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarimetric_purity</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarimetric_purity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarimetric_purity</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The degree of polarimetric purity of M is:
1.0

The degree of polarimetric purity of M is:
The mean value is 1.0 +- 7.45018529403474e-17
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_70_1.png" src="../../../_images/source_development_2D_Mueller_70_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># depolarization_index</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">depolarization_index</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">depolarization_index</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The depolarization index of M is:
0.0

The depolarization index of M is:
The mean value is nan +- nan
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:3577: RuntimeWarning: invalid value encountered in sqrt
  DI = sqrt(1. - PP**2)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_71_2.png" src="../../../_images/source_development_2D_Mueller_71_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarimetric_purity_indices</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarimetric_purity_indices</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">124</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c1"># print(p1, &#39;\n&#39;, p2)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarimetric_purity_indices</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The polarimetric purity indices of M are:
  P1
0.9999999999999999
  P2
0.9999999999999999
  P3
0.9999999999999999

The polarimetric purity indices of M are:
The mean value of param P1 is 1.0 +- 2.458685698380979e-16
The mean value of param P2 is 1.0 +- 2.481807498792184e-16
The mean value of param P3 is 1.0 +- 2.48093523250557e-16
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_72_1.png" src="../../../_images/source_development_2D_Mueller_72_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[94]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 4, 5, 6)
</pre></div></div>
</div>
</div>
<div class="section" id="Checks">
<h1>Checks<a class="headerlink" href="#Checks" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[95]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># is_physical</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_physical</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_physical</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is physically realizable:
True

M is physically realizable:
The mean value is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_75_1.png" src="../../../_images/source_development_2D_Mueller_75_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_physical</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is physically realizable:
The mean value of param Physical is 1.0 +- 0.0
The mean value of param Real elements is 1.0 +- 0.0
The mean value of param M00 &gt;= 0 is 1.0 +- 0.0
The mean value of param M00 &lt;= 1 is 1.0 +- 0.0
The mean value of param abs(Mij) &lt;= M00 is 1.0 +- 0.0
The mean value of param D &lt;= 1 is 1.0 +- 0.0
The mean value of param P &lt;= 1 is 1.0 +- 0.0
The mean value of param Tmax &lt;= 1 is 1.0 +- 0.0
The mean value of param Recip Tmax &lt;= 1 is 1.0 +- 0.0
The mean value of param Tr(M*M^T) &lt;= 4*M00^2 is 1.0 +- 0.0
The mean value of param m cond (D) is 1.0 +- 0.0
The mean value of param m cond (P) is 1.0 +- 0.0
The mean value of param Real eigenvalues is 1.0 +- 0.0
The mean value of param Eigenvalues &gt;= 0 is 1.0 +- 0.0
The mean value of param Eigenvalues &lt;= 1 is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_76_1.png" src="../../../_images/source_development_2D_Mueller_76_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># is_non_depolarizing</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_non_depolarizing</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_non_depolarizing</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is pure (non-depolarizing):
True

M is pure (non-depolarizing):
The mean value is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_77_1.png" src="../../../_images/source_development_2D_Mueller_77_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># is_homogeneous</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is homogeneous:
True

M is homogeneous:
The mean value is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_78_1.png" src="../../../_images/source_development_2D_Mueller_78_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># is_retarder</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_retarder</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_retarder</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is a retarder:
True

M is a retarder:
The mean value is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_79_1.png" src="../../../_images/source_development_2D_Mueller_79_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[101]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># is_diattenuator</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_diattenuator</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_diattenuator</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:6222: RuntimeWarning: invalid value encountered in true_divide
  (1, Dv[0, :] / par, Dv[1, :] / par, Dv[2, :] / par))
d:\codigo_ucm\py_pol\py_pol\mueller.py:6224: RuntimeWarning: invalid value encountered in true_divide
  (1, -Dv[0, :] / par, -Dv[1, :] / par, -Dv[2, :] / par))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is a diattenuator:
[False]

M is a diattenuator:
The mean value is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_80_2.png" src="../../../_images/source_development_2D_Mueller_80_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[102]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># is_singular</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M</span><span class="o">.</span><span class="n">retarder_linear</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_singular</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_linear</span><span class="p">(</span><span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_singular</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M is singular:
False

M is singular:
The mean value is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_81_1.png" src="../../../_images/source_development_2D_Mueller_81_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
</div>
<div class="section" id="Analysis">
<h1>Analysis<a class="headerlink" href="#Analysis" title="Permalink to this headline">Â¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[103]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># filter_purify_number</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229</span><span class="p">,</span> <span class="mf">0.0027</span><span class="p">,</span> <span class="mf">0.0058</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0186</span><span class="p">,</span> <span class="mf">0.9956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0361</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0129</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.2207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9656</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.028</span><span class="p">,</span> <span class="mf">0.9706</span><span class="p">,</span> <span class="mf">0.2231</span><span class="p">]])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="c1"># H = M1.covariance_matrix(keep=True)</span>
<span class="c1"># print(H)</span>
<span class="c1"># M_test = Mueller()</span>
<span class="c1"># M_test.from_covariance(H)</span>
<span class="c1"># print(np.linalg.norm(M1.M-M_test.M))</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_purify_number</span><span class="p">(</span><span class="n">Neig</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="c1"># H2 = M2.covariance_matrix(keep=True)</span>
<span class="c1"># l = H2.parameters.eigenvalues(verbose=True)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 -0.023 +0.003 +0.006]
[-0.019 +0.996 -0.036 +0.032]
[-0.013 +0.039 +0.221 -0.966]
[+0.001 +0.028 +0.971 +0.223]

Covariant of M =
[+0.996 -0.021 +0.001 +0.009]
[-0.021 +0.995 -0.036 +0.032]
[-0.009 +0.039 +0.222 -0.970]
[+0.002 +0.028 +0.970 +0.223]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:1483: ComplexWarning: Casting complex values to real discards the imaginary part
  np.array(elem.parameters.trace(shape=False), dtype=float)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[104]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_purify_number</span><span class="p">(</span><span class="n">Neig</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[5, 3]
[5, 3]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[105]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># filter_purify_threshold</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229</span><span class="p">,</span> <span class="mf">0.0027</span><span class="p">,</span> <span class="mf">0.0058</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0186</span><span class="p">,</span> <span class="mf">0.9956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0361</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0129</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.2207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9656</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.028</span><span class="p">,</span> <span class="mf">0.9706</span><span class="p">,</span> <span class="mf">0.2231</span><span class="p">]])</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_purify_threshold</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 -0.023 +0.003 +0.006]
[-0.019 +0.996 -0.036 +0.032]
[-0.013 +0.039 +0.221 -0.966]
[+0.001 +0.028 +0.971 +0.223]

Covariant of M =
[+0.996 -0.021 +0.001 +0.009]
[-0.021 +0.995 -0.036 +0.032]
[-0.009 +0.039 +0.222 -0.970]
[+0.002 +0.028 +0.970 +0.223]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[106]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># filter_physical_conditions</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_physical_conditions</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+0.604 +0.436 +0.276 +0.482]
[+0.593 +0.116 +0.716 +0.283]
[+0.937 +0.193 +0.996 +0.305]
[+0.656 +0.699 +0.257 +0.267]

M =
[+0.604 +0.436 +0.276 +0.482]
[+0.593 +0.116 +0.604 +0.283]
[+0.604 +0.193 +0.604 +0.305]
[+0.604 +0.604 +0.257 +0.267]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[107]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># filter_physical_conditions</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_physical_conditions</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[3, 5]
[3, 5]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[108]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">)</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">diattenuator</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.7362] [0.0541] [14.0297] [-6.8708]

Analysis of M as diattenuator:

- Transmissions of M are:
  Max. transmission
0.5419833070638488
  Min. transmission
0.00293127702385731
  p1
0.7361951555558137
  p2
0.05414126913785186

- Angles of M are:
  Alpha
[15.4981]
  Delay
[332.5313]
  Azimuth
[14.0297]
  Ellipticity angle
[-6.8708]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[109]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># diattenuator</span>
<span class="n">N</span><span class="o">=</span><span class="mi">16</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">)</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">diattenuator</span><span class="p">(</span><span class="n">draw</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Analysis of M as diattenuator:

- Transmissions of M are:
The mean value of param Max. transmission is 0.6091634969735578 +- 0.2170696375611575
The mean value of param Min. transmission is 0.0817197753937291 +- 0.07299402043109195
The mean value of param p1 is 0.7672879261037282 +- 0.14294311955808647
The mean value of param p2 is 0.24783199193418864 +- 0.14247483696309798
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_89_1.png" src="../../../_images/source_development_2D_Mueller_89_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of M are:
The mean value of param Alpha is 43.75797180080921 +- 17.379529263922265
The mean value of param Delay is 183.5871925470519 +- 98.4325198821828
The mean value of param Azimuth is 89.70224282755203 +- 53.112895133051055
The mean value of param Ellipticity angle is -2.1149447970592914 +- 26.618480026380162
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_89_3.png" src="../../../_images/source_development_2D_Mueller_89_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[110]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># polarizer</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">)</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">polarizer</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.8077] [0.1302] [91.21] [-21.6268]

Analysis of M as polarizer:

- Transmissions of M are:
  Max. transmission
0.652400317740094
  Min. transmission
0.016960216176171855
  p1
0.8077130169435763
  p2
0.13023139474094506

- Angles of M are:
  Alpha
[68.346]
  Delay
[267.4304]
  Azimuth
[91.21]
  Ellipticity angle
[-21.6268]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[111]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span><span class="o">=</span><span class="mi">16</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">)</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">polarizer</span><span class="p">(</span><span class="n">draw</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Analysis of M as polarizer:

- Transmissions of M are:
The mean value of param Max. transmission is 0.5729581711550997 +- 0.21387161681698302
The mean value of param Min. transmission is 0.08763020817080973 +- 0.0743550959139198
The mean value of param p1 is 0.7435095764666698 +- 0.1419566161101796
The mean value of param p2 is 0.26115667444823265 +- 0.13938220676237537
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_91_1.png" src="../../../_images/source_development_2D_Mueller_91_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of M are:
The mean value of param Alpha is 45.019650882455856 +- 16.381030793872473
The mean value of param Delay is 190.1583541507964 +- 97.26819408230287
The mean value of param Azimuth is 94.60718479289709 +- 51.67330300932497
The mean value of param Ellipticity angle is -1.5904432742895913 +- 25.474416032916906
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_91_3.png" src="../../../_images/source_development_2D_Mueller_91_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retarder</span>
<span class="n">N</span><span class="o">=</span><span class="mi">1</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="n">azimuth_elipt_2_charac_angles</span><span class="p">(</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">)</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">retarder</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">trans</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">azimuth</span><span class="o">-</span><span class="n">angles</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">ellipticity</span><span class="o">-</span><span class="n">angles</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">alpha</span><span class="o">-</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">((</span><span class="n">delay</span><span class="o">-</span><span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[157.8921] [152.2053] [-29.5416]

Analysis of M as retarder:

- Retardance of M is:
157.89209514216734

- Angles of M are:
  Alpha
[36.5604]
  Delay
[243.7066]
  Azimuth
[152.2053]
  Ellipticity angle
[-29.5416]

[0.]
[0.]
[0.]
[0.]
[0.]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span><span class="o">=</span><span class="mi">16</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">)</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">retarder</span><span class="p">(</span><span class="n">draw</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Analysis of M as retarder:

- Retardance of M is:
The mean value is 95.38820107714469 +- 54.481151647015466
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_93_1.png" src="../../../_images/source_development_2D_Mueller_93_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of M are:
The mean value of param Alpha is 43.23874635564478 +- 16.18363601655687
The mean value of param Delay is 182.38524939361824 +- 104.50003334015464
The mean value of param Azimuth is 86.53343969038741 +- 52.958597211887025
The mean value of param Ellipticity angle is -0.3673241927827955 +- 25.618696628808262
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_93_3.png" src="../../../_images/source_development_2D_Mueller_93_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># depolarizer</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">depolarizer</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Analysis of M as depolarizer:
- Transmissions of M from diattenuation are:
  Max. transmission
1.4095851454222854
  Min. transmission
0.5904148545777146
  p1
1.1872595105629962
  p2
0.7683845746614872

- Transmissions of M from polarizance are:
  Max. transmission
1.2005878585291772
  Min. transmission
0.799412141470823
  p1
1.0957134016380274
  p2
0.8940985076996958

- Angles of M from diattenuation are:
  Alpha
[38.8318]
  Delay
[55.5119]
  Azimuth
[34.4408]
  Ellipticity angle
[26.8154]

- Angles of M from polarizance are:
  Alpha
[40.5811]
  Delay
[35.752]
  Azimuth
[39.5772]
  Ellipticity angle
[17.6318]

- Depolarization index of M is:
0.8907720781397545

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">depolarizer</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Analysis of M as depolarizer:
- Transmissions of M from diattenuation are:
The mean value of param Max. transmission is 1.3137546812887173 +- 0.08657113353971481
The mean value of param Min. transmission is 0.6862453187112825 +- 0.0865711335397148
The mean value of param p1 is 1.145568479610343 +- 0.03778279783134784
The mean value of param p2 is 0.8267222089206042 +- 0.052684988267241765
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_95_1.png" src="../../../_images/source_development_2D_Mueller_95_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Transmissions of M from polarizance are:
The mean value of param Max. transmission is 1.3205703423744783 +- 0.09142936120465019
The mean value of param Min. transmission is 0.6794296576255218 +- 0.09142936120465019
The mean value of param p1 is 1.1484495365638148 +- 0.040422819555757
The mean value of param p2 is 0.822475234711468 +- 0.05444397039009182
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_95_3.png" src="../../../_images/source_development_2D_Mueller_95_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of M from diattenuation are:
The mean value of param Alpha is 28.06496713859344 +- 9.771559018491057
The mean value of param Delay is 42.28247955995026 +- 23.13266727604921
The mean value of param Azimuth is 22.77027334366744 +- 11.927301445043886
The mean value of param Ellipticity angle is 15.519732083481793 +- 9.018164389976295
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_95_5.png" src="../../../_images/source_development_2D_Mueller_95_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of M from polarizance are:
The mean value of param Alpha is 27.830946737405775 +- 9.690862151324836
The mean value of param Delay is 42.797711718494725 +- 24.120032587562164
The mean value of param Azimuth is 22.519402470883236 +- 11.837981211965037
The mean value of param Ellipticity angle is 15.378310539420385 +- 9.414464638324443
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_95_7.png" src="../../../_images/source_development_2D_Mueller_95_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Depolarization index of M is:
The mean value is 0.9055194383125834 +- 0.022563234809650192
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_95_9.png" src="../../../_images/source_development_2D_Mueller_95_9.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># decompose_pure</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_pure</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Mr2</span><span class="o">*</span><span class="n">Md2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Md</span><span class="p">,</span> <span class="n">Md2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mr</span><span class="p">,</span> <span class="n">Mr2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.51];   - p2 = [0.3145];   - alphaD = [68.3744];   - delayD = [11.949]
- R = [97.4816];   - alphaR = [35.8709];   - delayR = [45.7486]

------------------------------------------------------
Pure decomposition of Test as M = Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
0.2601208734784714
  Min. transmission
0.09892216563320923
  p1
0.5100204637840244
  p2
0.31451894320248697

- Angles of Diattenuator of Test are:
  Alpha
[68.3744]
  Delay
[11.949]
  Azimuth
[68.6874]
  Ellipticity angle
[4.0778]

Diattenuator of Test =
[+0.180 -0.059 +0.054 +0.011]
[-0.059 +0.171 -0.009 -0.002]
[+0.054 -0.009 +0.169 +0.002]
[+0.011 -0.002 +0.002 +0.161]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
97.48161203189805

- Angles of Retarder of Test are:
  Alpha
[35.8709]
  Delay
[45.7486]
  Azimuth
[32.348]
  Ellipticity angle
[21.4305]

Retarder of Test =
[+1.000 +0.000 +0.000 -0.000]
[+0.000 -0.019 +0.909 -0.416]
[-0.000 -0.440 +0.366 +0.820]
[+0.000 +0.898 +0.199 +0.393]

Test decomposition mean square error:
[0.]

------------------------------------------------------

3.892572694516993e-18
Test =
[+0.180 -0.059 +0.054 +0.011]
[+0.045 -0.011 +0.153 -0.065]
[+0.055 -0.080 +0.067 +0.133]
[-0.037 +0.151 +0.026 +0.062]
 Retarder of Test * Diattenuator of Test =
[+0.180 -0.059 +0.054 +0.011]
[+0.045 -0.011 +0.153 -0.065]
[+0.055 -0.080 +0.067 +0.133]
[-0.037 +0.151 +0.026 +0.062]

M =
[+0.180 -0.059 +0.054 +0.011]
[-0.059 +0.171 -0.009 -0.002]
[+0.054 -0.009 +0.169 +0.002]
[+0.011 -0.002 +0.002 +0.161]
 Diattenuator of Test =
[+0.180 -0.059 +0.054 +0.011]
[-0.059 +0.171 -0.009 -0.002]
[+0.054 -0.009 +0.169 +0.002]
[+0.011 -0.002 +0.002 +0.161]

M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 -0.019 +0.909 -0.416]
[+0.000 -0.440 +0.366 +0.820]
[+0.000 +0.898 +0.199 +0.393]
 Retarder of Test =
[+1.000 +0.000 +0.000 -0.000]
[+0.000 -0.019 +0.909 -0.416]
[-0.000 -0.440 +0.366 +0.820]
[+0.000 +0.898 +0.199 +0.393]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[132]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># decompose_pure</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_pure</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Mr2</span><span class="o">*</span><span class="n">Md2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Md</span><span class="p">,</span> <span class="n">Md2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mr</span><span class="p">,</span> <span class="n">Mr2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.7556 0.8678 0.985  0.9485 0.6873 0.7286 0.8737 0.9696 0.9022 0.9445];   - p2 = 0;   - alphaD = [51.995   5.4234 42.8556  5.0603 19.0729 55.3779 61.3427 68.3889  0.4742 76.2516];   - delayD = [134.077   92.204  181.6026 109.8021   9.0853 286.4862   6.5079 300.9883 247.1243 189.0844]
- R = [178.318   93.3589 150.3036  63.1347   2.8432 179.2115 116.6172  55.7263  71.3127 124.4358];   - alphaR = [77.3259 36.5461 75.7875 81.2079 60.3097 61.4665 42.8621 63.5614 49.8291 21.1167];   - delayR = [222.1883 339.8417 132.328   24.3589  63.3987  33.2669 106.1683 219.6644 164.5671  14.4456]
M * M M00 = [0.2855 0.3766 0.4851 0.4499 0.2362 0.2654 0.3817 0.4701 0.407  0.4461]
      M01 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
      M02 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
      M03 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
      M10 = [-0.0473 -0.0591 -0.3124  0.3985  0.1906  0.1066  0.3672 -0.4673  0.1318 -0.2862]
      M11 = [ 0.0114 -0.058  -0.0234  0.3923  0.1499 -0.0378 -0.1983  0.3405  0.1318  0.2539]
      M12 = [ 0.0319  0.0004  0.3114 -0.0237  0.1162  0.0283  0.3071 -0.1648 -0.0008  0.1305]
      M13 = [-0.033  -0.0111  0.0087  0.0659  0.0186 -0.0956  0.035   0.2743 -0.002   0.0209]
      M20 = [ 0.1447  0.2202  0.3487 -0.188   0.1362 -0.0807  0.0637  0.0211 -0.0574 -0.2891]
      M21 = [-0.035   0.2163  0.0261 -0.185   0.1071  0.0286 -0.0344 -0.0154 -0.0574  0.2564]
      M22 = [-0.0977 -0.0016 -0.3476  0.0112  0.0831 -0.0214  0.0533  0.0074  0.0004  0.1318]
      M23 = [ 0.1009  0.0414 -0.0097 -0.0311  0.0133  0.0723  0.0061 -0.0124  0.0009  0.0211]
      M30 = [-0.2415  0.2997 -0.1269  0.0909  0.0302  0.2293 -0.0823  0.0464 -0.3808 -0.1829]
      M31 = [ 0.0584  0.2943 -0.0095  0.0894  0.0237 -0.0813  0.0444 -0.0338 -0.3807  0.1623]
      M32 = [ 0.163  -0.0022  0.1265 -0.0054  0.0184  0.0608 -0.0688  0.0164  0.0024  0.0834]
      M33 = [-0.1683  0.0564  0.0035  0.015   0.0029 -0.2056 -0.0078 -0.0273  0.0058  0.0133]


------------------------------------------------------
Pure decomposition of Test as M = Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
[0.5709 0.7531 0.9702 0.8997 0.4723 0.5308 0.7633 0.9401 0.814  0.8921]
  Min. transmission
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  p1
[0.7556 0.8678 0.985  0.9485 0.6873 0.7286 0.8737 0.9696 0.9022 0.9445]
  p2
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Max. transmission is 0.7606682786393697 +- 0.1695937503050198
The mean value of param Min. transmission is 2.269728096854788e-17 +- 2.377857314515613e-17
The mean value of param p1 is 0.8662800517086099 +- 0.1011293758069218
The mean value of param p2 is 3.3442609227635196e-09 +- 3.393110644972364e-09

- Angles of Diattenuator of Test are:
  Alpha
[51.995   5.4234 42.8556  5.0603 19.0729 55.3779 61.3427 68.3889  0.4742 76.2516]
  Delay
[134.077   92.204  181.6026 109.8021   9.0853 286.4862   6.5079 300.9883 247.1243 189.0844]
  Azimuth
[125.1473 179.7889 137.1453 178.2698  18.8975  71.5869  61.427   77.0896 179.8157 103.6008]
  Ellipticity angle
[ 22.0973   5.4194  -0.7991   4.7582   2.7985 -31.861    2.737  -17.9752  -0.4369  -2.0902]
The mean value of param Alpha is 38.62424154530315 +- 27.13255848407754
The mean value of param Delay is 155.69620098104534 +- 99.35675102065765
The mean value of param Azimuth is 113.27687917827288 +- 53.40694190017089
The mean value of param Ellipticity angle is -1.535199834466071 +- 13.6948284055414

Diattenuator of Test M00 = [0.2855 0.3766 0.4851 0.4499 0.2362 0.2654 0.3817 0.4701 0.407  0.4461]
                     M01 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
                     M02 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
                     M03 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
                     M10 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
                     M11 = [0.0167 0.3632 0.0027 0.436  0.1461 0.0333 0.1113 0.2496 0.4069 0.351 ]
                     M12 = [ 0.0466 -0.0027 -0.0362 -0.0264  0.1133 -0.025  -0.1724 -0.1208 -0.0026  0.1804]
                     M13 = [-0.0481  0.0695 -0.001   0.0732  0.0181  0.0843 -0.0197  0.2011 -0.0062  0.0288]
                     M20 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
                     M21 = [ 0.0466 -0.0027 -0.0362 -0.0264  0.1133 -0.025  -0.1724 -0.1208 -0.0026  0.1804]
                     M22 = [0.1301 0.     0.482  0.0016 0.0879 0.0187 0.2669 0.0584 0.     0.0927]
                     M23 = [-0.1343 -0.0005  0.0135 -0.0044  0.014  -0.0631  0.0304 -0.0973  0.      0.0148]
                     M30 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
                     M31 = [-0.0481  0.0695 -0.001   0.0732  0.0181  0.0843 -0.0197  0.2011 -0.0062  0.0288]
                     M32 = [-0.1343 -0.0005  0.0135 -0.0044  0.014  -0.0631  0.0304 -0.0973  0.      0.0148]
                     M33 = [0.1387 0.0133 0.0004 0.0123 0.0022 0.2134 0.0035 0.162  0.0001 0.0024]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
[153.0988  90.4974 139.2422  21.5235   2.8315 176.0325 113.6116  46.9798  70.1811  26.5436]
The mean value is 84.05421129712678 +- 57.06986150271053

- Angles of Retarder of Test are:
  Alpha
[59.3751 41.6774 57.7344 49.4736 58.0201 25.6104 38.8177 47.3996 45.1177 54.109 ]
  Delay
[ 36.2208 324.7562  93.6497  81.6893  60.6147 358.7591  88.4222 205.8629 171.5007 318.3072]
  Azimuth
[ 62.1088  40.9407  93.8061  68.7228  67.4393  25.6071   3.5796 132.3348 134.8809  56.8931]
  Ellipticity angle
[ 15.601  -17.4861  32.1441  38.9058  25.7628  -0.4837  38.7684 -12.8828   4.2496 -19.5914]
The mean value of param Alpha is 47.73350296318941 +- 9.987946016878489
The mean value of param Delay is 173.9782787105354 +- 115.260458085856
The mean value of param Azimuth is 68.63130828745327 +- 40.14007503451209
The mean value of param Ellipticity angle is 10.498772442691571 +- 21.745368267038277

Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [-0.4541  0.0048 -0.4325  0.932   0.999  -0.214  -0.3363  0.6845  0.3391  0.9049]
                 M12 = [-0.4092 -0.4785  0.6317  0.3571  0.0384  0.9739  0.9028 -0.294   0.1417 -0.3057]
                 M13 = [-0.7914 -0.8781 -0.6434 -0.063  -0.0222 -0.075   0.2682  0.6671  0.93   -0.2961]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [-0.878   0.6678 -0.5448 -0.3602 -0.0389  0.9763 -0.8866  0.3416 -0.1364  0.259 ]
                 M22 = [ 0.0546  0.6551 -0.7517  0.9317  0.999   0.2158 -0.3995  0.9377  0.9856  0.9476]
                 M23 = [ 0.4756 -0.3533 -0.3717 -0.0473 -0.0213  0.0171  0.233   0.0627 -0.1005 -0.1869]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [-0.1514  0.7443 -0.7184  0.0418  0.0214  0.0328  0.3175 -0.644  -0.9308  0.3378]
                 M32 = [ 0.9108 -0.5847  0.1897  0.0668  0.0221 -0.0696 -0.1594  0.185  -0.0927  0.0925]
                 M33 = [-0.3841  0.3227  0.6692  0.9969  0.9995 -0.997   0.9348  0.7423  0.3535  0.9367]

Test decomposition mean square error:
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
The mean value is 3.569256759336967e-10 +- 3.5738899470329085e-10

------------------------------------------------------

[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Test M00 = [0.2855 0.3766 0.4851 0.4499 0.2362 0.2654 0.3817 0.4701 0.407  0.4461]
     M01 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
     M02 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
     M03 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
     M10 = [-0.0473 -0.0591 -0.3124  0.3985  0.1906  0.1066  0.3672 -0.4673  0.1318 -0.2862]
     M11 = [ 0.0114 -0.058  -0.0234  0.3923  0.1499 -0.0378 -0.1983  0.3405  0.1318  0.2539]
     M12 = [ 0.0319  0.0004  0.3114 -0.0237  0.1162  0.0283  0.3071 -0.1648 -0.0008  0.1305]
     M13 = [-0.033  -0.0111  0.0087  0.0659  0.0186 -0.0956  0.035   0.2743 -0.002   0.0209]
     M20 = [ 0.1447  0.2202  0.3487 -0.188   0.1362 -0.0807  0.0637  0.0211 -0.0574 -0.2891]
     M21 = [-0.035   0.2163  0.0261 -0.185   0.1071  0.0286 -0.0344 -0.0154 -0.0574  0.2564]
     M22 = [-0.0977 -0.0016 -0.3476  0.0112  0.0831 -0.0214  0.0533  0.0074  0.0004  0.1318]
     M23 = [ 0.1009  0.0414 -0.0097 -0.0311  0.0133  0.0723  0.0061 -0.0124  0.0009  0.0211]
     M30 = [-0.2415  0.2997 -0.1269  0.0909  0.0302  0.2293 -0.0823  0.0464 -0.3808 -0.1829]
     M31 = [ 0.0584  0.2943 -0.0095  0.0894  0.0237 -0.0813  0.0444 -0.0338 -0.3807  0.1623]
     M32 = [ 0.163  -0.0022  0.1265 -0.0054  0.0184  0.0608 -0.0688  0.0164  0.0024  0.0834]
     M33 = [-0.1683  0.0564  0.0035  0.015   0.0029 -0.2056 -0.0078 -0.0273  0.0058  0.0133]
 Retarder of Test * Diattenuator of Test M00 = [0.2855 0.3766 0.4851 0.4499 0.2362 0.2654 0.3817 0.4701 0.407  0.4461]
                                        M01 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
                                        M02 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
                                        M03 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
                                        M10 = [-0.0473 -0.0591 -0.3124  0.3985  0.1906  0.1066  0.3672 -0.4673  0.1318 -0.2862]
                                        M11 = [ 0.0114 -0.058  -0.0234  0.3923  0.1499 -0.0378 -0.1983  0.3405  0.1318  0.2539]
                                        M12 = [ 0.0319  0.0004  0.3114 -0.0237  0.1162  0.0283  0.3071 -0.1648 -0.0008  0.1305]
                                        M13 = [-0.033  -0.0111  0.0087  0.0659  0.0186 -0.0956  0.035   0.2743 -0.002   0.0209]
                                        M20 = [ 0.1447  0.2202  0.3487 -0.188   0.1362 -0.0807  0.0637  0.0211 -0.0574 -0.2891]
                                        M21 = [-0.035   0.2163  0.0261 -0.185   0.1071  0.0286 -0.0344 -0.0154 -0.0574  0.2564]
                                        M22 = [-0.0977 -0.0016 -0.3476  0.0112  0.0831 -0.0214  0.0533  0.0074  0.0004  0.1318]
                                        M23 = [ 0.1009  0.0414 -0.0097 -0.0311  0.0133  0.0723  0.0061 -0.0124  0.0009  0.0211]
                                        M30 = [-0.2415  0.2997 -0.1269  0.0909  0.0302  0.2293 -0.0823  0.0464 -0.3808 -0.1829]
                                        M31 = [ 0.0584  0.2943 -0.0095  0.0894  0.0237 -0.0813  0.0444 -0.0338 -0.3807  0.1623]
                                        M32 = [ 0.163  -0.0022  0.1265 -0.0054  0.0184  0.0608 -0.0688  0.0164  0.0024  0.0834]
                                        M33 = [-0.1683  0.0564  0.0035  0.015   0.0029 -0.2056 -0.0078 -0.0273  0.0058  0.0133]

M M00 = [0.2855 0.3766 0.4851 0.4499 0.2362 0.2654 0.3817 0.4701 0.407  0.4461]
  M01 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
  M02 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
  M03 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
  M10 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
  M11 = [0.0167 0.3632 0.0027 0.436  0.1461 0.0333 0.1113 0.2496 0.4069 0.351 ]
  M12 = [ 0.0466 -0.0027 -0.0362 -0.0264  0.1133 -0.025  -0.1724 -0.1208 -0.0026  0.1804]
  M13 = [-0.0481  0.0695 -0.001   0.0732  0.0181  0.0843 -0.0197  0.2011 -0.0062  0.0288]
  M20 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
  M21 = [ 0.0466 -0.0027 -0.0362 -0.0264  0.1133 -0.025  -0.1724 -0.1208 -0.0026  0.1804]
  M22 = [0.1301 0.     0.482  0.0016 0.0879 0.0187 0.2669 0.0584 0.     0.0927]
  M23 = [-0.1343 -0.0005  0.0135 -0.0044  0.014  -0.0631  0.0304 -0.0973  0.      0.0148]
  M30 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
  M31 = [-0.0481  0.0695 -0.001   0.0732  0.0181  0.0843 -0.0197  0.2011 -0.0062  0.0288]
  M32 = [-0.1343 -0.0005  0.0135 -0.0044  0.014  -0.0631  0.0304 -0.0973  0.      0.0148]
  M33 = [0.1387 0.0133 0.0004 0.0123 0.0022 0.2134 0.0035 0.162  0.0001 0.0024]
 Diattenuator of Test M00 = [0.2855 0.3766 0.4851 0.4499 0.2362 0.2654 0.3817 0.4701 0.407  0.4461]
                     M01 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
                     M02 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
                     M03 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
                     M10 = [-0.069   0.3698  0.0363  0.4429  0.1857 -0.0941 -0.2061 -0.3425  0.407  -0.3957]
                     M11 = [0.0167 0.3632 0.0027 0.436  0.1461 0.0333 0.1113 0.2496 0.4069 0.351 ]
                     M12 = [ 0.0466 -0.0027 -0.0362 -0.0264  0.1133 -0.025  -0.1724 -0.1208 -0.0026  0.1804]
                     M13 = [-0.0481  0.0695 -0.001   0.0732  0.0181  0.0843 -0.0197  0.2011 -0.0062  0.0288]
                     M20 = [-0.1927 -0.0027 -0.4836 -0.0268  0.144   0.0704  0.3192  0.1657 -0.0026 -0.2034]
                     M21 = [ 0.0466 -0.0027 -0.0362 -0.0264  0.1133 -0.025  -0.1724 -0.1208 -0.0026  0.1804]
                     M22 = [0.1301 0.     0.482  0.0016 0.0879 0.0187 0.2669 0.0584 0.     0.0927]
                     M23 = [-0.1343 -0.0005  0.0135 -0.0044  0.014  -0.0631  0.0304 -0.0973  0.      0.0148]
                     M30 = [ 0.199   0.0708 -0.0135  0.0744  0.023  -0.238   0.0364 -0.276  -0.0062 -0.0325]
                     M31 = [-0.0481  0.0695 -0.001   0.0732  0.0181  0.0843 -0.0197  0.2011 -0.0062  0.0288]
                     M32 = [-0.1343 -0.0005  0.0135 -0.0044  0.014  -0.0631  0.0304 -0.0973  0.      0.0148]
                     M33 = [0.1387 0.0133 0.0004 0.0123 0.0022 0.2134 0.0035 0.162  0.0001 0.0024]

M M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  M11 = [ 0.6335  0.0309  0.5766  0.95    0.9991 -0.4088 -0.44    0.7223  0.3395  0.2927]
  M12 = [ 0.5648 -0.0526  0.7011 -0.0326  0.0379 -0.7567  0.8263 -0.2587  0.3569  0.8928]
  M13 = [ 0.5289 -0.9981 -0.4195 -0.3106 -0.0196 -0.5102  0.3517  0.6414  0.8703 -0.3425]
  M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  M21 = [ 0.5817  0.6057  0.3524 -0.255  -0.0384 -0.7693 -0.8862  0.5824 -0.1402  0.6162]
  M22 = [-0.7984  0.7954 -0.6767  0.4934  0.999  -0.015  -0.3364  0.7277  0.9341  0.0978]
  M23 = [ 0.1558 -0.0232 -0.6465 -0.8316 -0.0249  0.6387 -0.3185 -0.3623 -0.3283  0.7815]
  M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  M31 = [ 0.5102  0.7951 -0.7371  0.1804  0.0186 -0.4909 -0.1449 -0.373  -0.9301  0.7312]
  M32 = [ 0.2089 -0.6038  0.2249  0.8692  0.0256  0.6536 -0.4518  0.6352 -0.0105 -0.4398]
  M33 = [-0.8343  0.0565 -0.6372  0.4604  0.9995 -0.576   0.8803  0.6763  0.3672 -0.5215]
 Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [-0.4541  0.0048 -0.4325  0.932   0.999  -0.214  -0.3363  0.6845  0.3391  0.9049]
                 M12 = [-0.4092 -0.4785  0.6317  0.3571  0.0384  0.9739  0.9028 -0.294   0.1417 -0.3057]
                 M13 = [-0.7914 -0.8781 -0.6434 -0.063  -0.0222 -0.075   0.2682  0.6671  0.93   -0.2961]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [-0.878   0.6678 -0.5448 -0.3602 -0.0389  0.9763 -0.8866  0.3416 -0.1364  0.259 ]
                 M22 = [ 0.0546  0.6551 -0.7517  0.9317  0.999   0.2158 -0.3995  0.9377  0.9856  0.9476]
                 M23 = [ 0.4756 -0.3533 -0.3717 -0.0473 -0.0213  0.0171  0.233   0.0627 -0.1005 -0.1869]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [-0.1514  0.7443 -0.7184  0.0418  0.0214  0.0328  0.3175 -0.644  -0.9308  0.3378]
                 M32 = [ 0.9108 -0.5847  0.1897  0.0668  0.0221 -0.0696 -0.1594  0.185  -0.0927  0.0925]
                 M33 = [-0.3841  0.3227  0.6692  0.9969  0.9995 -0.997   0.9348  0.7423  0.3535  0.9367]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:5061: RuntimeWarning: divide by zero encountered in true_divide
  p2=1 / p2,
d:\codigo_ucm\py_pol\py_pol\mueller.py:1880: RuntimeWarning: invalid value encountered in true_divide
  cte = (Tmax - Tmin) / (Tmax + Tmin)
d:\codigo_ucm\py_pol\py_pol\mueller.py:1940: RuntimeWarning: invalid value encountered in true_divide
  cte = (1 - skd) / d**2
d:\codigo_ucm\py_pol\py_pol\utils.py:671: RuntimeWarning: invalid value encountered in multiply
  cte * np.take(D, 2, axis=ind).flatten(),
d:\codigo_ucm\py_pol\py_pol\utils.py:672: RuntimeWarning: invalid value encountered in multiply
  ])
d:\codigo_ucm\py_pol\py_pol\utils.py:673: RuntimeWarning: invalid value encountered in multiply
  shape2 = np.delete(shape2, ind)
d:\codigo_ucm\py_pol\py_pol\utils.py:697: RuntimeWarning: invalid value encountered in multiply
  cte * np.take(P, 2, axis=ind).flatten(),
d:\codigo_ucm\py_pol\py_pol\utils.py:698: RuntimeWarning: invalid value encountered in multiply
  ])
d:\codigo_ucm\py_pol\py_pol\utils.py:699: RuntimeWarning: invalid value encountered in multiply
  shape3 = np.delete(shape3, ind)
d:\codigo_ucm\py_pol\py_pol\utils.py:730: RuntimeWarning: invalid value encountered in multiply
  ],
d:\codigo_ucm\py_pol\py_pol\utils.py:731: RuntimeWarning: invalid value encountered in multiply
  [
d:\codigo_ucm\py_pol\py_pol\utils.py:734: RuntimeWarning: invalid value encountered in multiply
  cte * multitake(m, [1, 2], [ind1, ind2]).flatten()
d:\codigo_ucm\py_pol\py_pol\utils.py:736: RuntimeWarning: invalid value encountered in multiply
  [
d:\codigo_ucm\py_pol\py_pol\utils.py:739: RuntimeWarning: invalid value encountered in multiply
  cte * multitake(m, [2, 2], [ind1, ind2]).flatten()
d:\codigo_ucm\py_pol\py_pol\utils.py:740: RuntimeWarning: invalid value encountered in multiply
  ]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[134]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># decompose_polar</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.8428];   - p2 = [0.4853];   - alphaD = [36.4639];   - delayD = [268.7299]
- R = [121.9186];   - alphaR = [5.842];   - delayR = [341.8978]

------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
0.7103024015576678
  Min. transmission
0.2355044598606655
  p1
0.8427944005258149
  p2
0.48528801742951116

- Angles of Diattenuator of Test are:
  Alpha
[36.4639]
  Delay
[268.7299]
  Azimuth
[177.9359]
  Ellipticity angle
[-36.441]

Diattenuator of Test =
[+0.473 +0.070 -0.005 -0.227]
[+0.070 +0.415 -0.000 -0.018]
[-0.005 -0.000 +0.409 +0.001]
[-0.227 -0.018 +0.001 +0.467]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
111.27829344817286

- Angles of Retarder of Test are:
  Alpha
[6.5734]
  Delay
[188.5175]
  Azimuth
[173.4967]
  Ellipticity angle
[-0.9653]

Retarder of Test =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.087 +0.402 +0.070]
[+0.000 +0.458 -0.049 +0.699]
[+0.000 -0.304 -0.917 -0.764]


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
  Max. transmission
1.0
  Min. transmission
1.0
  p1
1.0
  p2
1.0

- Transmissions of Depolarizer of Test from polarizance are:
  Max. transmission
1.000000000000001
  Min. transmission
0.999999999999999
  p1
1.0000000000000004
  p2
0.9999999999999994

- Angles of Depolarizer of Test from diattenuation are:
  Alpha
[45.]
  Delay
[0.]
  Azimuth
[45.]
  Ellipticity angle
[0.]

- Angles of Depolarizer of Test from polarizance are:
  Alpha
[45.]
  Delay
[180.]
  Azimuth
[135.]
  Ellipticity angle
[-0.]

- Depolarization index of Depolarizer of Test is:
nan

Depolarizer of Test =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.095 +0.238 -0.303]
[-0.000 +0.238 +0.747 -0.292]
[-0.000 -0.303 -0.292 +1.157]

Test decomposition mean square error:
0.046082807762380294

------------------------------------------------------

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mp</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.6713 0.7597 0.5505 0.7452 0.8823 0.7376 0.539  0.8739 0.9814 0.5992];   - p2 = [0.423  0.2903 0.4957 0.2262 0.127  0.3637 0.236  0.2372 0.0299 0.0297];   - alphaD = [ 8.0423 13.9549 10.4339 79.0318 13.4295 60.0148 46.1929 50.4892 79.1255 72.6849];   - delayD = [ 21.9584  42.301  356.6888 258.647  116.3771 249.7978 117.0135 268.1397 321.8175  82.2993]
- R = [ 28.659  167.9492  57.7076 130.8988  61.9281 164.6352  25.6177  71.537   79.1047 115.7024];   - alphaR = [78.6594 30.6868 60.1057  8.8366 11.2981 31.3758 42.8997 32.4011 84.9397 44.2014];   - delayR = [ 52.0747 108.6722  52.2472  14.5668 350.3219 126.9529 105.8277 127.6478 226.5417 222.4352]
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.100 +1.000 +0.100 +0.000]
[+0.100 +0.100 +1.000 +0.000]
[+0.100 +0.000 +0.000 +1.000]

[False False False False False False False False  True  True]
N =  [4 4 4 4 4 4 4 4 4 4]

------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
[0.4506 0.5772 0.303  0.5554 0.7785 0.544  0.2905 0.7638 0.9631 0.359 ]
  Min. transmission
[0.1789 0.0843 0.2457 0.0511 0.0161 0.1322 0.0557 0.0563 0.0009 0.0009]
  p1
[0.6713 0.7597 0.5505 0.7452 0.8823 0.7376 0.539  0.8739 0.9814 0.5992]
  p2
[0.423  0.2903 0.4957 0.2262 0.127  0.3637 0.236  0.2372 0.0299 0.0297]
The mean value of param Max. transmission is 0.5585046863093195 +- 0.21056114618575372
The mean value of param Min. transmission is 0.08221051582867042 +- 0.07649379813851635
The mean value of param p1 is 0.7340047783531417 +- 0.14050505921166978
The mean value of param p2 is 0.24584778251696707 +- 0.14754451416491393

- Angles of Diattenuator of Test are:
  Alpha
[ 8.0423 13.9549 10.4339 79.0318 13.4295 60.0148 46.1929 50.4892 79.1255 72.6849]
  Delay
[ 21.9584  42.301  356.6888 258.647  116.3771 249.7978 117.0135 268.1397 321.8175  82.2993]
  Azimuth
[  7.486   10.6968  10.4179  92.2665 173.6599 105.4275 132.3795  94.7501  81.2947  87.3564]
  Ellipticity angle
[  2.9733   9.1813  -0.5894 -10.7428  11.938  -27.1707  31.4446 -39.4335  -6.6208  17.137 ]
The mean value of param Alpha is 43.339956116410946 +- 27.999630243553064
The mean value of param Delay is 183.5040265302638 +- 114.68775632603788
The mean value of param Azimuth is 79.57352542423732 +- 52.42825872379799
The mean value of param Ellipticity angle is -1.1883023142415499 +- 19.89174112314097

Diattenuator of Test M00 = [0.3148 0.3307 0.2743 0.3033 0.3973 0.3381 0.1731 0.41   0.482  0.18  ]
                     M01 = [ 0.1305  0.2178  0.0268 -0.2339  0.3401 -0.103  -0.0049 -0.0674 -0.4469 -0.1473]
                     M02 = [ 0.0349  0.0853  0.0102 -0.0185 -0.0765 -0.0615 -0.0533 -0.0113  0.1401  0.0136]
                     M03 = [ 0.0141  0.0776 -0.0006 -0.0923  0.1543 -0.1673  0.1045 -0.3471 -0.1102  0.1008]
                     M10 = [ 0.1305  0.2178  0.0268 -0.2339  0.3401 -0.103  -0.0049 -0.0674 -0.4469 -0.1473]
                     M11 = [0.3124 0.3066 0.2742 0.2845 0.3391 0.2857 0.1273 0.2147 0.4199 0.1276]
                     M12 = [ 0.0076  0.0337  0.0005  0.0092 -0.0511  0.0105  0.0009  0.0012 -0.1225 -0.0102]
                     M13 = [ 0.0031  0.0307 -0.      0.0458  0.103   0.0284 -0.0017  0.0379  0.0963 -0.0751]
                     M20 = [ 0.0349  0.0853  0.0102 -0.0185 -0.0765 -0.0615 -0.0533 -0.0113  0.1401  0.0136]
                     M21 = [ 0.0076  0.0337  0.0005  0.0092 -0.0511  0.0105  0.0009  0.0012 -0.1225 -0.0102]
                     M22 = [0.286  0.2338 0.273  0.1693 0.1235 0.2745 0.1366 0.2075 0.0677 0.0187]
                     M23 = [ 0.0008  0.012  -0.      0.0036 -0.0232  0.017  -0.0185  0.0063 -0.0302  0.007 ]
                     M30 = [ 0.0141  0.0776 -0.0006 -0.0923  0.1543 -0.1673  0.1045 -0.3471 -0.1102  0.1008]
                     M31 = [ 0.0031  0.0307 -0.      0.0458  0.103   0.0284 -0.0017  0.0379  0.0963 -0.0751]
                     M32 = [ 0.0008  0.012  -0.      0.0036 -0.0232  0.017  -0.0185  0.0063 -0.0302  0.007 ]
                     M33 = [0.2843 0.2315 0.2728 0.1866 0.1588 0.3144 0.1635 0.4025 0.0531 0.0692]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
[ 28.659  167.9492  57.7076 130.8988  61.9281 164.6352  25.6177  71.537   79.1047 115.7024]
The mean value is 90.37397338040303 +- 49.16973423619022

- Angles of Retarder of Test are:
  Alpha
[78.6594 30.6868 60.1057  8.8366 11.2981 31.3758 42.8997 32.4011 84.9397 44.2014]
  Delay
[ 52.0747 108.6722  52.2472  14.5668 350.3219 126.9529 105.8277 127.6478 226.5417 222.4352]
  Azimuth
[ 82.7969 164.8029  66.7813   8.5694  11.1531 155.2929 142.5358 153.804   93.4997 136.0818]
  Ellipticity angle
[  8.8541  28.1297  21.5497   2.1895  -1.8518  22.6358  36.8191  22.8805  -3.664  -21.2074]
The mean value of param Alpha is 42.54042082395718 +- 24.276958610737147
The mean value of param Delay is 138.72880098464995 +- 95.99014552432003
The mean value of param Azimuth is 101.53179651067174 +- 55.61863349136566
The mean value of param Ellipticity angle is 11.633528241057842 +- 16.863045953389708

Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [ 0.9818 -0.524   0.6522  0.8475  0.9218 -0.5525  0.9022  0.4405  0.975  -0.4326]
                 M12 = [ 0.1191 -0.0927  0.4536  0.521   0.1281 -0.2924  0.4129  0.5188 -0.0288 -0.6372]
                 M13 = [-0.148   0.8467 -0.6074 -0.1017 -0.3658  0.7805  0.1245  0.7327  0.2205  0.6378]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [-0.1727 -0.4399 -0.7016  0.4055  0.2421 -0.6689 -0.4168 -0.8403  0.2217  0.5783]
                 M22 = [ 0.8844 -0.8218  0.6646 -0.5119  0.5465 -0.4032  0.909   0.5254  0.2009  0.3466]
                 M23 = [-0.4337 -0.3622 -0.257   0.7573  0.8017 -0.6245  0.006   0.1333 -0.9542  0.7385]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [ 0.0793  0.7293  0.2871  0.3425  0.3026  0.4973 -0.1107 -0.3158 -0.0169 -0.6917]
                 M32 = [ 0.4513 -0.5622  0.5937 -0.6831 -0.8276 -0.8671 -0.0573 -0.6744  0.9792  0.6883]
                 M33 = [ 0.8888  0.3898  0.7517 -0.6451  0.4728  0.0272  0.9922  0.6674  0.2022  0.2186]


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
  Max. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  Min. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p1
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p2
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0

- Transmissions of Depolarizer of Test from polarizance are:
  Max. transmission
[1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732]
  Min. transmission
[0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268]
  p1
[1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831]
  p2
[0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093]
The mean value of param Max. transmission is 1.173205080756888 +- 5.191286995978243e-15
The mean value of param Min. transmission is 0.8267949192431121 +- 5.187011398550628e-15
The mean value of param p1 is 1.0831459184970822 +- 2.368707071037794e-15
The mean value of param p2 is 0.9092826399107773 +- 2.870951734946996e-15

- Angles of Depolarizer of Test from diattenuation are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

- Angles of Depolarizer of Test from polarizance are:
  Alpha
[27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678]
  Delay
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Azimuth
[22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5]
  Ellipticity angle
[17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322]
The mean value of param Alpha is 27.36780515862269 +- 8.517796824267249e-13
The mean value of param Delay is 45.00000000000046 +- 1.3846944827303154e-12
The mean value of param Azimuth is 22.499999999999897 +- 6.383575017873665e-13
The mean value of param Ellipticity angle is 17.632194841377498 +- 8.804811521339169e-13

- Depolarization index of Depolarizer of Test is:
[nan nan nan nan nan nan nan nan nan nan]
The mean value is nan +- nan

Depolarizer of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M10 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M11 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M12 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M13 = [ 0. -0.  0. -0. -0. -0. -0.  0.  0.  0.]
                    M20 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M21 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M22 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M23 = [ 0. -0.  0. -0.  0. -0.  0.  0.  0. -0.]
                    M30 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M31 = [ 0. -0.  0. -0. -0. -0. -0.  0.  0.  0.]
                    M32 = [ 0. -0.  0. -0.  0. -0.  0.  0.  0. -0.]
                    M33 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]

Test decomposition mean square error:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value is 5.358663761524e-16 +- 1.4373435222834087e-15

------------------------------------------------------

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:3582: RuntimeWarning: invalid value encountered in sqrt
  DI = sqrt(1. - PP**2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[146]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mp</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.100 +1.000 +0.100 +0.000]
[+0.100 +0.100 +1.000 +0.000]
[+0.100 +0.000 +0.000 +1.000]


------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
The mean value of param Max. transmission is 0.611200140813687 +- 0.19572265171751851
The mean value of param Min. transmission is 0.07884777834177505 +- 0.06929925367807534
The mean value of param p1 is 0.7711246594501285 +- 0.1287124718184297
The mean value of param p2 is 0.24481228677688183 +- 0.13753080594851766
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_1.png" src="../../../_images/source_development_2D_Mueller_100_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of Diattenuator of Test are:
The mean value of param Alpha is 43.703038897980356 +- 24.53211948883956
The mean value of param Delay is 184.73514282976473 +- 103.67166440244418
The mean value of param Azimuth is 93.26974276014296 +- 54.59523234912774
The mean value of param Ellipticity angle is 0.6661948962648314 +- 15.76245952811099
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_3.png" src="../../../_images/source_development_2D_Mueller_100_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
The mean value is 94.1736739102102 +- 53.24036913116564
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_5.png" src="../../../_images/source_development_2D_Mueller_100_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of Retarder of Test are:
The mean value of param Alpha is 44.09533253018829 +- 25.40607170692036
The mean value of param Delay is 177.98497335256516 +- 99.496966884096
The mean value of param Azimuth is 93.72717570026687 +- 54.533691606097086
The mean value of param Ellipticity angle is 0.03863850638550295 +- 16.208471361845955
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_7.png" src="../../../_images/source_development_2D_Mueller_100_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:3582: RuntimeWarning: invalid value encountered in sqrt
  DI = sqrt(1. - PP**2)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_11.png" src="../../../_images/source_development_2D_Mueller_100_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Transmissions of Depolarizer of Test from polarizance are:
The mean value of param Max. transmission is 1.1732050807568526 +- 2.891580060009241e-13
The mean value of param Min. transmission is 0.8267949192431473 +- 2.891682791496716e-13
The mean value of param p1 is 1.0831459184970662 +- 1.3348831161312012e-13
The mean value of param p2 is 0.9092826399107966 +- 1.590093771850248e-13
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_13.png" src="../../../_images/source_development_2D_Mueller_100_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of Depolarizer of Test from diattenuation are:
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_15.png" src="../../../_images/source_development_2D_Mueller_100_15.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Angles of Depolarizer of Test from polarizance are:
The mean value of param Alpha is 27.367805158620012 +- 2.3690053122633878e-11
The mean value of param Delay is 45.00000000000826 +- 1.179435565359308e-10
The mean value of param Azimuth is 22.499999999995115 +- 5.410600478994616e-11
The mean value of param Ellipticity angle is 17.632194841378922 +- 3.0463683655664936e-11
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_17.png" src="../../../_images/source_development_2D_Mueller_100_17.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

- Depolarization index of Depolarizer of Test is:
The mean value is nan +- nan
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_19.png" src="../../../_images/source_development_2D_Mueller_100_19.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Test decomposition mean square error:
The mean value is 2.2811957372568167e-15 +- 1.787738291471161e-14
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/source_development_2D_Mueller_100_21.png" src="../../../_images/source_development_2D_Mueller_100_21.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

------------------------------------------------------

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[176]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mp</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the retarder:      &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mr2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mr</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the diattenuator:  &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Md2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Md</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the depolarizer:   &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mp2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mp</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.6401 0.7856 0.5338 0.5029 0.6136 0.5503 0.6167 0.6787 0.5223 0.5405];   - p2 = [0.0026 0.0748 0.0214 0.4532 0.0971 0.205  0.2939 0.3315 0.2201 0.2616];   - alphaD = [26.1626 80.3597 41.3213  6.9965 36.6315 80.8291 49.8581 39.0583 46.5597 29.6188];   - delayD = [312.1592  45.0941 141.1334 211.1703 276.3991 166.7846 180.0867 327.1402 182.4807 184.2824]
- R = [ 86.3225 108.0068  47.0676  37.8244  31.6484 153.729   62.9582  70.4971 178.2979 121.0088];   - alphaR = [38.3536 29.9542  5.4486 76.1046 16.6006 64.4999 77.1893 43.5235 74.425  23.404 ];   - delayR = [ 77.2203 147.5596  54.6673 123.049  316.2956 227.8634 147.1974 243.1118 115.6272 190.6472]
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.100 +1.000 +0.100 +0.000]
[+0.100 +0.100 +1.000 +0.000]
[+0.100 +0.000 +0.000 +0.000]

Cond =  [ True  True  True  True  True  True  True  True  True  True]
N =  [3 3 3 3 3 3 3 3 3 3]

------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
[0.4097 0.6172 0.2849 0.2529 0.3765 0.3028 0.3803 0.4607 0.2728 0.2921]
  Min. transmission
[0.     0.0056 0.0005 0.2054 0.0094 0.042  0.0864 0.1099 0.0484 0.0684]
  p1
[0.6401 0.7856 0.5338 0.5029 0.6136 0.5503 0.6167 0.6787 0.5223 0.5405]
  p2
[0.0026 0.0748 0.0214 0.4532 0.0971 0.205  0.2939 0.3315 0.2201 0.2616]
The mean value of param Max. transmission is 0.3650130446842069 +- 0.10571637832411178
The mean value of param Min. transmission is 0.05760109800913181 +- 0.06119175408968016
The mean value of param p1 is 0.5984631137406096 +- 0.08279460233675293
The mean value of param p2 is 0.19611366230396457 +- 0.13834930237214196

- Angles of Diattenuator of Test are:
  Alpha
[26.1626 80.3597 41.3213  6.9965 36.6315 80.8291 49.8581 39.0583 46.5597 29.6188]
  Delay
[312.1592  45.0941 141.1334 211.1703 276.3991 166.7846 180.0867 327.1402 182.4807 184.2824]
  Azimuth
[ 20.4988  83.0642 139.708  173.9818  10.168   98.9437 130.1419  37.968  133.4388 150.4165]
  Ellipticity angle
[-17.9623   6.7624  19.2437  -3.5948 -36.0571   2.0627  -0.0427 -16.0351  -1.2385  -1.8395]
The mean value of param Alpha is 43.739552217193555 +- 21.676590555430977
The mean value of param Delay is 202.67307830111744 +- 80.09329534620912
The mean value of param Azimuth is 97.83297723218132 +- 54.86138422260014
The mean value of param Ellipticity angle is -4.870115406576678 +- 14.425144789273388

Diattenuator of Test M00 = [0.2049 0.3114 0.1427 0.2291 0.193  0.1724 0.2334 0.2853 0.1606 0.1803]
                     M01 = [ 0.1252 -0.2886  0.0182  0.0231  0.0529 -0.1238 -0.0248  0.0361 -0.0061  0.0572]
                     M02 = [ 0.1088  0.0713 -0.1098 -0.0049  0.0196 -0.04   -0.1449  0.1442 -0.1119 -0.0958]
                     M03 = [-0.1202  0.0715  0.0885 -0.003  -0.1747  0.0094 -0.0002 -0.0931 -0.0048 -0.0072]
                     M10 = [ 0.1252 -0.2886  0.0182  0.0231  0.0529 -0.1238 -0.0248  0.0361 -0.0061  0.0572]
                     M11 = [0.0776 0.2838 0.0136 0.2291 0.0707 0.1665 0.1828 0.2275 0.1151 0.1516]
                     M12 = [ 0.066  -0.0556 -0.013  -0.0002  0.0041  0.0173  0.0087  0.0102  0.0025 -0.017 ]
                     M13 = [-0.0729 -0.0558  0.0105 -0.0002 -0.0366 -0.0041  0.     -0.0066  0.0001 -0.0013]
                     M20 = [ 0.1088  0.0713 -0.1098 -0.0049  0.0196 -0.04   -0.1449  0.1442 -0.1119 -0.0958]
                     M21 = [ 0.066  -0.0556 -0.013  -0.0002  0.0041  0.0173  0.0087  0.0102  0.0025 -0.017 ]
                     M22 = [0.059  0.0725 0.0897 0.228  0.0611 0.1184 0.2319 0.2657 0.1604 0.17  ]
                     M23 = [-0.0633  0.0138 -0.0631  0.     -0.0135 -0.0013  0.0001 -0.0263  0.002   0.0021]
                     M30 = [-0.1202  0.0715  0.0885 -0.003  -0.1747  0.0094 -0.0002 -0.0931 -0.0048 -0.0072]
                     M31 = [-0.0729 -0.0558  0.0105 -0.0002 -0.0366 -0.0041  0.     -0.0066  0.0001 -0.0013]
                     M32 = [-0.0633  0.0138 -0.0631  0.     -0.0135 -0.0013  0.0001 -0.0263  0.002   0.0021]
                     M33 = [0.0716 0.0726 0.0623 0.2279 0.1804 0.1131 0.1813 0.242  0.115  0.1416]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
[ 86.3225 135.8894 151.4731 163.3861 152.502  153.729  157.075  118.1322  80.4932 121.0088]
The mean value is 132.00113084049005 +- 28.201344476899727

- Angles of Retarder of Test are:
  Alpha
[38.3536 25.2002 67.7742 19.9777 70.4244 64.4999 22.6427 53.8455 59.8064 23.404 ]
  Delay
[ 77.2203 304.6128  26.9987 155.7466 187.9681 227.8634 137.8749  92.085  307.2843 190.6472]
  Azimuth
[ 21.5576  17.2374  69.4213 161.3132 109.4397 109.8208 161.5814  93.2537  66.5879 156.8443]
  Ellipticity angle
[ 35.8203 -19.6782   9.2685   7.6477  -2.5105 -17.5951  14.2334  36.0953 -21.8831  -3.8707]
The mean value of param Alpha is 44.59285737191599 +- 19.67150982330955
The mean value of param Delay is 170.83013574731666 +- 87.98941638217049
The mean value of param Azimuth is 96.70572605227396 +- 50.95064894767476
The mean value of param Ellipticity angle is 3.7527584404131167 +- 19.972698159828912

Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [ 0.1136 -0.02    0.0787  0.1924  0.2478 -0.1455  0.0299 -0.3356  0.369   0.1946]
                 M12 = [ 0.9935  0.0379 -0.6849 -0.8035  0.8746  0.3673 -0.5267  0.8551 -0.8995 -0.8585]
                 M13 = [-0.0106 -0.9991 -0.7243  0.5634  0.4168  0.9187  0.8495 -0.3952 -0.2341  0.4744]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [-0.9008  0.9207 -0.9886 -0.9543  0.9554  0.8774 -0.898  -0.8241  0.465  -0.6276]
                 M22 = [ 0.1075 -0.3889 -0.1472 -0.2869 -0.1493 -0.3811 -0.3874 -0.4697  0.3967  0.2627]
                 M23 = [ 0.4207 -0.0332  0.0318 -0.0833 -0.2548  0.2914 -0.2085 -0.3165 -0.7915  0.7329]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [ 0.4191 -0.3898 -0.1283  0.2286 -0.1606  0.4571  0.4389 -0.4563  0.8048 -0.7538]
                 M32 = [-0.0382 -0.9205  0.7136 -0.5216  0.4613  0.8485 -0.7567  0.2194  0.1832 -0.4404]
                 M33 = [ 0.9072 -0.0271 -0.6887 -0.822  -0.8726 -0.2668 -0.4846  0.8623  0.5646 -0.4877]


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
  Max. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  Min. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p1
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p2
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0

- Transmissions of Depolarizer of Test from polarizance are:
  Max. transmission
[1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732]
  Min. transmission
[0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268]
  p1
[1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831]
  p2
[0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093]
The mean value of param Max. transmission is 1.1732050807567478 +- 4.2598158791540257e-13
The mean value of param Min. transmission is 0.8267949192432521 +- 4.2599652989876086e-13
The mean value of param p1 is 1.0831459184970178 +- 1.966627894128758e-13
The mean value of param p2 is 0.9092826399108542 +- 2.3423750219540847e-13

- Angles of Depolarizer of Test from diattenuation are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

- Angles of Depolarizer of Test from polarizance are:
  Alpha
[27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678]
  Delay
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Azimuth
[22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5]
  Ellipticity angle
[17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322]
The mean value of param Alpha is 27.367805158650263 +- 8.292335467080882e-11
The mean value of param Delay is 45.00000000001249 +- 3.9265670557010873e-11
The mean value of param Azimuth is 22.50000000002614 +- 7.813900055081073e-11
The mean value of param Ellipticity angle is 17.63219484139554 +- 5.534277988407526e-11

- Depolarization index of Depolarizer of Test is:
[0.5627 0.5627 0.5627 0.5627 0.5627 0.5627 0.5627 0.5627 0.5627 0.5627]
The mean value is 0.562731433870691 +- 1.3370812160074755e-12

Depolarizer of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M10 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M11 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M12 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M13 = [ 0.  0.  0.  0.  0. -0.  0. -0.  0. -0.]
                    M20 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M21 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M22 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M23 = [-0. -0. -0.  0.  0.  0. -0.  0.  0. -0.]
                    M30 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M31 = [ 0.  0.  0.  0.  0. -0.  0. -0.  0. -0.]
                    M32 = [-0. -0. -0.  0.  0.  0. -0.  0.  0. -0.]
                    M33 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]

Test decomposition mean square error:
[0.     0.0568 0.0024 0.0314 0.0166 0.     0.0327 0.048  0.0206 0.    ]
The mean value is 0.020859657472609223 +- 0.01986795913058851

------------------------------------------------------

Error in the retarder:       7.483314773547883
Error in the diattenuator:   8.831824216139427e-17
Error in the depolarizer:    6.729967852572424e-12
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:5256: RuntimeWarning: divide by zero encountered in true_divide
  [1 / np.sqrt(val[2, :])] + 4 * [0] +
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mp</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the retarder:      &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mr2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mr</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the diattenuator:  &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Md2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Md</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the depolarizer:   &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mp2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mp</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.5122 0.6744 0.8006 0.5826 0.5412 0.7118 0.7545 0.8251 0.7052 0.8389];   - p2 = [0.3627 0.303  0.3547 0.4325 0.003  0.2657 0.3311 0.1258 0.3743 0.1406];   - alphaD = [55.9742 58.7561 12.5832 89.5092 36.6181  6.08   68.5437 80.5444 28.9605 67.1571];   - delayD = [193.085   67.1023 155.5828  50.9915 274.0766 290.6148  22.5099  86.0324 136.7739 277.7224]
- R = [  3.8674  78.8469   1.8115 139.4445 150.2489 130.7728  76.3333 101.0458 165.8598 161.5345];   - alphaR = [17.1132 55.3254 60.2053 27.6074 45.3796 33.8386 11.7804 56.9541  1.7705 42.6311];   - delayR = [133.6147 210.0333 282.3667  85.0844 282.6195 348.6455 125.5268 206.9592 223.189  290.6539]
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.100 +0.950 +0.000 +0.000]
[+0.100 +0.000 +0.000 +0.000]
[+0.100 +0.000 +0.000 +0.000]

N =  [2 2 2 2 2 2 2 2 2 2]
R (traces) =  [0.038  1.2726 0.0273 1.7589 2.6217 1.9983 0.4992 1.5667 0.1227 2.7797]
R (vectors) =  [3.1036 1.8689 0.0273 1.3827 2.6217 1.9983 2.6424 1.5667 3.0189 2.7797]

------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
[0.2623 0.4548 0.641  0.3394 0.2929 0.5066 0.5692 0.6808 0.4973 0.7038]
  Min. transmission
[0.1316 0.0918 0.1258 0.187  0.     0.0706 0.1096 0.0158 0.1401 0.0198]
  p1
[0.5122 0.6744 0.8006 0.5826 0.5412 0.7118 0.7545 0.8251 0.7052 0.8389]
  p2
[0.3627 0.303  0.3547 0.4325 0.003  0.2657 0.3311 0.1258 0.3743 0.1406]
The mean value of param Max. transmission is 0.4948179128224039 +- 0.15029581852503252
The mean value of param Min. transmission is 0.08921598352552013 +- 0.05850073771305843
The mean value of param p1 is 0.6946453969637294 +- 0.11084081062274324
The mean value of param p2 is 0.2693476641286139 +- 0.12910390913515946

- Angles of Diattenuator of Test are:
  Alpha
[55.9742 58.7561 12.5832 89.5092 36.6181  6.08   68.5437 80.5444 28.9605 67.1571]
  Delay
[193.085   67.1023 155.5828  50.9915 274.0766 290.6148  22.5099  86.0324 136.7739 277.7224]
  Azimuth
[123.7621  71.6194 168.4188  89.6911   6.6393   2.1692  69.6713  89.321  155.351   86.0818]
  Ellipticity angle
[ -6.0608  27.394    5.0623   0.3813 -36.3807  -5.6853   7.555    9.4321  17.7362 -22.5781]
The mean value of param Alpha is 50.472642823253096 +- 26.819798755413604
The mean value of param Delay is 155.44914639153018 +- 95.00857316737282
The mean value of param Azimuth is 86.27251104950736 +- 51.81837863778159
The mean value of param Ellipticity angle is -0.3144069639901552 +- 17.714996098497682

Diattenuator of Test M00 = [0.197  0.2733 0.3834 0.2632 0.1465 0.2886 0.3394 0.3483 0.3187 0.3618]
                     M01 = [-0.0244 -0.0838  0.2331 -0.0762  0.0422  0.2131 -0.1683 -0.3146  0.0948 -0.2389]
                     M02 = [-0.0591  0.0626 -0.0997  0.0008  0.01    0.0162  0.1445  0.0075 -0.1103  0.0329]
                     M03 = [-0.0137  0.1483  0.0453  0.001  -0.1399 -0.043   0.0599  0.1075  0.1036 -0.2425]
                     M10 = [-0.0244 -0.0838  0.2331 -0.0762  0.0422  0.2131 -0.1683 -0.3146  0.0948 -0.2389]
                     M11 = [0.1873 0.2191 0.3654 0.2632 0.0137 0.2842 0.2979 0.3226 0.2794 0.237 ]
                     M12 = [ 0.0038 -0.011  -0.0348 -0.0001  0.0028  0.0072 -0.0413 -0.0052 -0.018  -0.0164]
                     M13 = [ 0.0009 -0.026   0.0158 -0.0001 -0.0399 -0.0192 -0.0171 -0.0748  0.0169  0.1208]
                     M20 = [-0.0591  0.0626 -0.0997  0.0008  0.01    0.0162  0.1445  0.0075 -0.1103  0.0329]
                     M21 = [ 0.0038 -0.011  -0.0348 -0.0001  0.0028  0.0072 -0.0413 -0.0052 -0.018  -0.0164]
                     M22 = [0.1949 0.2126 0.2989 0.2519 0.0023 0.1897 0.2853 0.1039 0.2848 0.1202]
                     M23 = [ 0.0021  0.0194 -0.0068  0.     -0.0094 -0.0015  0.0147  0.0018 -0.0196 -0.0166]
                     M30 = [-0.0137  0.1483  0.0453  0.001  -0.1399 -0.043   0.0599  0.1075  0.1036 -0.2425]
                     M31 = [ 0.0009 -0.026   0.0158 -0.0001 -0.0399 -0.0192 -0.0171 -0.0748  0.0169  0.1208]
                     M32 = [ 0.0021  0.0194 -0.0068  0.     -0.0094 -0.0015  0.0147  0.0018 -0.0196 -0.0166]
                     M33 = [0.1863 0.2504 0.287  0.2519 0.1337 0.193  0.2559 0.1293 0.2824 0.2406]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
[177.825  107.0826   1.5622  79.2213 150.211  114.493  151.399   89.764  172.9719 159.264 ]
The mean value is 120.37938221032046 +- 51.37157115858596

- Angles of Retarder of Test are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[315.2138  13.8649 281.9082 322.1564 279.764   28.3071 341.298    0.7604 306.1055 317.5901]
  Azimuth
[ 45.  45.  45.  45.  45.  45.  45. 135. 135.  45.]
  Ellipticity angle
[-22.3931   6.9324 -39.0459 -18.9218 -40.118   14.1536  -9.351   -0.3802  26.9473 -21.205 ]
The mean value of param Alpha is 44.99999999999996 +- 1.2232896561191264e-13
The mean value of param Delay is 220.69683155963827 +- 136.32907179454335
The mean value of param Azimuth is 62.99999999999976 +- 36.00000000000012
The mean value of param Ellipticity angle is -10.33816977793829 +- 21.063036778613828

Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [-0.9993 -0.2937  0.9996  0.187  -0.8679 -0.4146 -0.878   0.0041 -0.9925 -0.9352]
                 M12 = [-0.0267  0.2291 -0.0267 -0.6027 -0.4896  0.4315 -0.1535 -0.0133  0.0989 -0.2388]
                 M13 = [-0.0269 -0.928  -0.0056 -0.7758 -0.0843 -0.8012 -0.4534  0.9999  0.0721 -0.2614]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [ 0.0267 -0.2291  0.0267  0.6027  0.4896 -0.4315  0.1535  0.0133 -0.0989  0.2388]
                 M22 = [ 0.0078  0.9257  0.9996  0.694  -0.8141  0.6819  0.8069  0.9998 -0.3006  0.1198]
                 M23 = [-0.9996  0.301  -0.0001 -0.3939 -0.3122  0.5906 -0.5704  0.0132 -0.9486 -0.9637]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [ 0.0269  0.928   0.0056  0.7758  0.0843  0.8012  0.4534 -0.9999 -0.0721  0.2614]
                 M32 = [-0.9996  0.301  -0.0001 -0.3939 -0.3122  0.5906 -0.5704  0.0132 -0.9486 -0.9637]
                 M33 = [-0.0071 -0.2195  1.      0.493   0.9463 -0.0965 -0.6849  0.0043  0.3081 -0.055 ]


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
  Max. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  Min. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p1
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p2
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0

- Transmissions of Depolarizer of Test from polarizance are:
  Max. transmission
[1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732]
  Min. transmission
[0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268]
  p1
[1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831]
  p2
[0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093]
The mean value of param Max. transmission is 1.1732050807569006 +- 3.9400311981537104e-14
The mean value of param Min. transmission is 0.8267949192430992 +- 3.9369203510556494e-14
The mean value of param p1 is 1.0831459184970886 +- 1.8189641414598178e-14
The mean value of param p2 is 0.9092826399107701 +- 2.1634882780421034e-14

- Angles of Depolarizer of Test from diattenuation are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

- Angles of Depolarizer of Test from polarizance are:
  Alpha
[27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678]
  Delay
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Azimuth
[22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5]
  Ellipticity angle
[17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322]
The mean value of param Alpha is 27.367805158619593 +- 9.208044733080441e-12
The mean value of param Delay is 45.0 +- 8.407255028117242e-15
The mean value of param Azimuth is 22.49999999999673 +- 9.767242797287612e-12
The mean value of param Ellipticity angle is 17.632194841375785 +- 4.604970268181481e-12

- Depolarization index of Depolarizer of Test is:
[0.8302 0.8302 0.8302 0.8302 0.8302 0.8302 0.8302 0.8302 0.8302 0.8302]
The mean value is 0.8301606270275151 +- 9.155664040889009e-14

Depolarizer of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M10 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M11 = [0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95 0.95]
                    M12 = [ 0. -0.  0. -0.  0.  0. -0.  0. -0. -0.]
                    M13 = [ 0. -0.  0. -0.  0.  0. -0.  0. -0. -0.]
                    M20 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M21 = [ 0. -0.  0. -0.  0.  0. -0.  0. -0. -0.]
                    M22 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M23 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M30 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M31 = [ 0. -0.  0. -0.  0.  0. -0.  0. -0. -0.]
                    M32 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M33 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]

Test decomposition mean square error:
[0.0225 0.0294 0.     0.03   0.     0.     0.034  0.     0.0354 0.    ]
The mean value is 0.015124169600774676 +- 0.015453680341020709

------------------------------------------------------

Error in the retarder:       6.817640755249715
Error in the diattenuator:   4.906688675926167e-18
Error in the depolarizer:    8.553986200159598e-13
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[130]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mp</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the retarder:      &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mr2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mr</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the diattenuator:  &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Md2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Md</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the depolarizer:   &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mp2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mp</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.5122 0.5011 0.5455 0.8658 0.8672 0.5854 0.7219 0.8242 0.9183 0.7633];   - p2 = [0.4298 0.3157 0.2368 0.3203 0.2939 0.3632 0.2856 0.4465 0.2934 0.259 ];   - alphaD = [33.5412 16.2289 67.0374 23.9439 76.7034  8.1521 75.2204  1.0662 54.5047 31.4575];   - delayD = [209.7125  67.9659 221.8765 304.396  318.9322  30.2209 254.4804   0.8946 180.9667 207.0452]
- R = [  8.7508   5.0572  60.3656  20.2951  98.9034  40.1275 142.6983  51.2876  12.4245  41.524 ];   - alphaR = [62.7632 15.0654 52.3565 18.9283  2.0329 49.224  40.7924 33.2695 49.832  23.7377];   - delayR = [ 26.6361  59.7106 202.1388  15.6866 173.2842  65.6578 284.07   213.1929 269.0746 172.6997]
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.100 +0.000 +0.000 +0.000]
[+0.100 +0.000 +0.000 +0.000]
[+0.100 +0.000 +0.000 +0.000]


------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
[0.2624 0.2511 0.2975 0.7497 0.752  0.3427 0.5212 0.6793 0.8432 0.5826]
  Min. transmission
[0.1847 0.0997 0.0561 0.1026 0.0864 0.1319 0.0816 0.1993 0.0861 0.0671]
  p1
[0.5122 0.5011 0.5455 0.8658 0.8672 0.5854 0.7219 0.8242 0.9183 0.7633]
  p2
[0.4298 0.3157 0.2368 0.3203 0.2939 0.3632 0.2856 0.4465 0.2934 0.259 ]
The mean value of param Max. transmission is 0.5281676436386438 +- 0.21431278283995728
The mean value of param Min. transmission is 0.10954321889760024 +- 0.04570639773972323
The mean value of param p1 is 0.7104876699858022 +- 0.15288856869233147
The mean value of param p2 is 0.32441982475988296 +- 0.06553622052244917

- Angles of Diattenuator of Test are:
  Alpha
[33.5412 16.2289 67.0374 23.9439 76.7034  8.1521 75.2204  1.0662 54.5047 31.4575]
  Delay
[209.7125  67.9659 221.8765 304.396  318.9322  30.2209 254.4804   0.8946 180.9667 207.0452]
  Azimuth
[147.9779   6.7103 108.7807  16.0013  79.661    7.0921  94.3143   1.0661 125.494  149.9319]
  Ellipticity angle
[-13.5816  14.9167 -14.3288 -18.8717  -8.5514   4.0617 -14.1906   0.0166  -0.457  -11.9402]
The mean value of param Alpha is 38.78557032327312 +- 26.423397850326978
The mean value of param Delay is 179.64910340078913 +- 105.24049047184806
The mean value of param Azimuth is 73.7029607242536 +- 57.64662381968284
The mean value of param Ellipticity angle is -6.292612072152836 +- 10.031072591628558

Diattenuator of Test M00 = [0.2235 0.1754 0.1768 0.4261 0.4192 0.2373 0.3014 0.4393 0.4646 0.3248]
                     M01 = [ 0.0151  0.0639 -0.084   0.217  -0.2976  0.1012 -0.1912  0.2398 -0.1233  0.1174]
                     M02 = [-0.0311  0.0152 -0.0646  0.1356  0.1123  0.0256 -0.029   0.0089 -0.3579 -0.2044]
                     M03 = [-0.0177  0.0377 -0.0579 -0.1981 -0.0979  0.0149 -0.1045  0.0001 -0.006  -0.1043]
                     M10 = [ 0.0151  0.0639 -0.084   0.217  -0.2976  0.1012 -0.1912  0.2398 -0.1233  0.1174]
                     M11 = [0.2207 0.1704 0.1522 0.3443 0.3862 0.2354 0.2782 0.4392 0.2901 0.224 ]
                     M12 = [-0.0011  0.0029  0.0177  0.0418 -0.0496  0.0057  0.0109  0.0027  0.0601 -0.0459]
                     M13 = [-0.0006  0.0072  0.0159 -0.0611  0.0432  0.0033  0.0394  0.      0.001  -0.0234]
                     M20 = [-0.0311  0.0152 -0.0646  0.1356  0.1123  0.0256 -0.029   0.0089 -0.3579 -0.2044]
                     M21 = [-0.0011  0.0029  0.0177  0.0418 -0.0496  0.0057  0.0109  0.0027  0.0601 -0.0459]
                     M22 = [0.2223 0.1589 0.1428 0.3035 0.2736 0.2141 0.2079 0.3681 0.4439 0.2776]
                     M23 = [ 0.0012  0.0017  0.0122 -0.0382 -0.0163  0.0008  0.006   0.      0.0029  0.0408]
                     M30 = [-0.0177  0.0377 -0.0579 -0.1981 -0.0979  0.0149 -0.1045  0.0001 -0.006  -0.1043]
                     M31 = [-0.0006  0.0072  0.0159 -0.0611  0.0432  0.0033  0.0394  0.      0.001  -0.0234]
                     M32 = [ 0.0012  0.0017  0.0122 -0.0382 -0.0163  0.0008  0.006   0.      0.0029  0.0408]
                     M33 = [0.2209 0.1624 0.1401 0.3331 0.2691 0.2131 0.2277 0.368  0.2694 0.2185]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value is 0.0 +- 0.0

- Angles of Retarder of Test are:
  Alpha
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 0.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 0.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M12 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M13 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M22 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M23 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M32 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M33 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
  Max. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  Min. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p1
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p2
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0

- Transmissions of Depolarizer of Test from polarizance are:
  Max. transmission
[1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732 1.1732]
  Min. transmission
[0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268 0.8268]
  p1
[1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831 1.0831]
  p2
[0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093 0.9093]
The mean value of param Max. transmission is 1.173205080756888 +- 2.1065000811460205e-16
The mean value of param Min. transmission is 0.8267949192431123 +- 9.288792252416251e-17
The mean value of param p1 is 1.0831459184970824 +- 2.220446049250313e-16
The mean value of param p2 is 0.9092826399107773 +- 0.0

- Angles of Depolarizer of Test from diattenuation are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

- Angles of Depolarizer of Test from polarizance are:
  Alpha
[27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678 27.3678]
  Delay
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Azimuth
[22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5 22.5]
  Ellipticity angle
[17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322 17.6322]
The mean value of param Alpha is 27.367805158622673 +- 1.5888218580782547e-15
The mean value of param Delay is 45.0 +- 0.0
The mean value of param Azimuth is 22.5 +- 3.1776437161565094e-15
The mean value of param Ellipticity angle is 17.632194841377327 +- 0.0

- Depolarization index of Depolarizer of Test is:
[0.995 0.995 0.995 0.995 0.995 0.995 0.995 0.995 0.995 0.995]
The mean value is 0.99498743710662 +- 0.0

Depolarizer of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M10 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M11 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M12 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M13 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M20 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M21 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M22 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M23 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M30 = [0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1]
                    M31 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M32 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M33 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]

Test decomposition mean square error:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value is 8.820963753621794e-19 +- 7.585788127543548e-19

------------------------------------------------------

Error in the retarder:       4.203852407928772
Error in the diattenuator:   4.124416789028418e-17
Error in the depolarizer:    1.3808224523606804e-16
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\utils.py:1346: RuntimeWarning: invalid value encountered in matmul
  return M
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[128]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Caso p2=0 (diatenuador singular)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- p1 = </span><span class="si">{}</span><span class="s1">;   - p2 = </span><span class="si">{}</span><span class="s1">;   - alphaD = </span><span class="si">{}</span><span class="s1">;   - delayD = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alphaD</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayD</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- R = </span><span class="si">{}</span><span class="s1">;   - alphaR = </span><span class="si">{}</span><span class="s1">;   - delayR = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">alphaR</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delayR</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Mp</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the retarder:      &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mr2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mr</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the diattenuator:  &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Md2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Md</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in the depolarizer:   &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Mp2</span><span class="o">.</span><span class="n">M</span><span class="o">-</span><span class="n">Mp</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Original:
- p1 = [0.613  0.5162 0.9189 0.5598 0.9505 0.8137 0.6505 0.8253 0.6421 0.7243];   - p2 = 0;   - alphaD = [43.6324 21.0112 29.9742 22.3708 32.373  12.1421 25.1679 14.894  71.2231 24.1154];   - delayD = [173.862  268.959  207.8459 347.7523  38.2563  79.1035 325.5122  31.2537  61.4464 197.6295]
- R = [ 81.3753  57.709   88.534  179.0414  80.1325 103.0876 153.5336  40.0475 132.8132  48.0271];   - alphaR = [24.7344 86.8745 33.6454 52.448  12.4937 48.6489 66.5925 86.0445 66.0687 51.6241];   - delayR = [293.9081 101.4702   9.2146 280.2646  18.9608 181.3457 252.6994 295.0392 141.7662 318.871 ]
M =
[+1.000 +0.000 +0.000 +0.000]
[+0.100 +1.000 +0.100 +0.000]
[+0.100 +0.100 +1.000 +0.000]
[+0.100 +0.000 +0.000 +1.000]


------------------------------------------------------
Polar decomposition of Test as M = Mp * Mr * Md.

Analysis of Diattenuator of Test as diattenuator:

- Transmissions of Diattenuator of Test are:
  Max. transmission
[0.3758 0.2664 0.8444 0.3134 0.9035 0.6622 0.4231 0.6811 0.4122 0.5247]
  Min. transmission
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  p1
[0.613  0.5162 0.9189 0.5598 0.9505 0.8137 0.6505 0.8253 0.6421 0.7243]
  p2
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Max. transmission is 0.5406822299334071 +- 0.21047278602408936
The mean value of param Min. transmission is 2.3487406239995195e-18 +- 7.04622187199856e-18
The mean value of param p1 is 0.7214351636451088 +- 0.14217431058303748
The mean value of param p2 is 4.846380736177792e-10 +- 1.4539142208533373e-09

- Angles of Diattenuator of Test are:
  Alpha
[43.6324 21.0112 29.9742 22.3708 32.373  12.1421 25.1679 14.894  71.2231 24.1154]
  Delay
[173.862  268.959  207.8459 347.7523  38.2563  79.1035 325.5122  31.2537  61.4464 197.6295]
  Azimuth
[136.3755 179.5311 151.5986  22.0411  29.5029   2.4375  22.4148  13.0375  79.9113 156.5709]
  Ellipticity angle
[  3.0655 -21.007  -11.9238  -4.2939  17.028   11.9095 -12.9207   7.4683  16.1846  -6.5274]
The mean value of param Alpha is 29.690412693658402 +- 16.229395830203913
The mean value of param Delay is 173.16208311504275 +- 111.5062756358585
The mean value of param Azimuth is 79.34212365776966 +- 66.17773314916964
The mean value of param Ellipticity angle is -0.1017059450853858 +- 12.530999154720924

Diattenuator of Test M00 = [0.1879 0.1332 0.4222 0.1567 0.4517 0.3311 0.2116 0.3406 0.2061 0.2623]
                     M01 = [ 0.009   0.099   0.2114  0.1113  0.1927  0.3018  0.135   0.2956 -0.1634  0.1747]
                     M02 = [-0.1866 -0.0016 -0.3231  0.1078  0.3208  0.0257  0.1342  0.1446  0.06   -0.1865]
                     M03 = [ 0.0201 -0.0892 -0.1707 -0.0234  0.253   0.1337 -0.0922  0.0878  0.1103 -0.0593]
                     M10 = [ 0.009   0.099   0.2114  0.1113  0.1927  0.3018  0.135   0.2956 -0.1634  0.1747]
                     M11 = [0.0004 0.0735 0.1059 0.0791 0.0822 0.2751 0.0862 0.2565 0.1295 0.1164]
                     M12 = [-0.0089 -0.0012 -0.1618  0.0766  0.1369  0.0235  0.0857  0.1255 -0.0476 -0.1242]
                     M13 = [ 0.001  -0.0662 -0.0855 -0.0166  0.1079  0.1219 -0.0589  0.0762 -0.0875 -0.0395]
                     M20 = [-0.1866 -0.0016 -0.3231  0.1078  0.3208  0.0257  0.1342  0.1446  0.06   -0.1865]
                     M21 = [-0.0089 -0.0012 -0.1618  0.0766  0.1369  0.0235  0.0857  0.1255 -0.0476 -0.1242]
                     M22 = [0.1853 0.     0.2473 0.0741 0.2278 0.002  0.0852 0.0614 0.0175 0.1325]
                     M23 = [-0.0199  0.0011  0.1306 -0.0161  0.1797  0.0104 -0.0585  0.0373  0.0321  0.0421]
                     M30 = [ 0.0201 -0.0892 -0.1707 -0.0234  0.253   0.1337 -0.0922  0.0878  0.1103 -0.0593]
                     M31 = [ 0.001  -0.0662 -0.0855 -0.0166  0.1079  0.1219 -0.0589  0.0762 -0.0875 -0.0395]
                     M32 = [-0.0199  0.0011  0.1306 -0.0161  0.1797  0.0104 -0.0585  0.0373  0.0321  0.0421]
                     M33 = [0.0021 0.0597 0.069  0.0035 0.1417 0.054  0.0402 0.0226 0.0591 0.0134]


Analysis of Retarder of Test as retarder:

- Retardance of Retarder of Test is:
[ 83.694   41.3843  76.9223 175.9927  43.1749  91.0086 132.5073  16.6969  89.2834  52.4548]
The mean value is 80.3119112199003 +- 44.51339454304765

- Angles of Retarder of Test are:
  Alpha
[14.7199 62.8942 15.062  36.2412 17.5973 39.1902 69.8466 59.0413 62.3806 37.2019]
  Delay
[268.7179 305.8266  32.2181 239.1803 170.2335 196.2164 337.6959  10.0193 215.9615 302.0659]
  Azimuth
[179.6382  70.4628  13.0731 150.8181 162.5992 141.0436  70.9375  59.225  114.6946  31.1327]
  Ellipticity angle
[-14.7159 -20.5624   7.7599 -27.4902   2.8054  -7.9376  -7.1059   4.4148 -14.4224 -27.3549]
The mean value of param Alpha is 41.41751214799303 +- 20.10923591904417
The mean value of param Delay is 207.81353120404498 +- 105.65140752856313
The mean value of param Azimuth is 99.36248754321352 +- 55.152952578589456
The mean value of param Ellipticity angle is -10.460924555524922 +- 12.075354673241218

Retarder of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                 M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M11 = [ 0.785   0.8357  0.8051 -0.8166  0.9101  0.0237  0.2988  0.9672  0.3335  0.6376]
                 M12 = [-0.4969 -0.5041  0.5448 -0.351  -0.0588 -0.4663 -0.9458  0.0269 -0.108  -0.5935]
                 M13 = [-0.37   -0.2179 -0.2345 -0.4583  0.4103  0.8843 -0.1275 -0.2527  0.9365 -0.4912]
                 M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M21 = [ 0.4799  0.3655  0.0235 -0.2365 -0.1926  0.0807 -0.5838 -0.0613  0.8568  0.7009]
                 M22 = [ 0.1099  0.8066  0.3658 -0.5207  0.8166  0.8826 -0.0755  0.9897  0.4491  0.7115]
                 M23 = [ 0.8704 -0.4646  0.9304  0.8203  0.5441  0.4632 -0.8084 -0.1296 -0.2533  0.0501]
                 M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                 M31 = [-0.3919  0.4099  0.5926 -0.5266 -0.367  -0.9965  0.7549  0.2466 -0.3933  0.3197]
                 M32 = [-0.8608  0.3086 -0.7546  0.7782 -0.5742  0.0604  0.316   0.1409  0.8869 -0.3762]
                 M33 = [ 0.3248  0.8583  0.2817  0.3422  0.7319  0.0585 -0.5747  0.9588  0.2423  0.8696]


Analysis of Depolarizer of Test as depolarizer:
- Transmissions of Depolarizer of Test from diattenuation are:
  Max. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  Min. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p1
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p2
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0

- Transmissions of Depolarizer of Test from polarizance are:
  Max. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  Min. transmission
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p1
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
  p2
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
The mean value of param Max. transmission is 1.0 +- 0.0
The mean value of param Min. transmission is 1.0 +- 0.0
The mean value of param p1 is 1.0 +- 0.0
The mean value of param p2 is 1.0 +- 0.0

- Angles of Depolarizer of Test from diattenuation are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

- Angles of Depolarizer of Test from polarizance are:
  Alpha
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45. 45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

- Depolarization index of Depolarizer of Test is:
[   nan    nan 0.0414 0.2672    nan 0.2295    nan    nan 0.1924    nan]
The mean value is nan +- nan

Depolarizer of Test M00 = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
                    M01 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M02 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M03 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M10 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M11 = [1.1194 1.1751 0.9991 0.9636 1.1993 0.9733 1.0501 1.2013 0.9813 1.0677]
                    M12 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M13 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M20 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M21 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M22 = [1.1194 1.1751 0.9991 0.9636 1.1993 0.9733 1.0501 1.2013 0.9813 1.0677]
                    M23 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M30 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M31 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M32 = [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
                    M33 = [1.1194 1.1751 0.9991 0.9636 1.1993 0.9733 1.0501 1.2013 0.9813 1.0677]

Test decomposition mean square error:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
The mean value is 4.5810530901262046e-11 +- 1.3743156972784109e-10

------------------------------------------------------

Error in the retarder:       4.803137481245609
Error in the diattenuator:   0.0
Error in the depolarizer:    0.9507791389457932
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:5224: RuntimeWarning: divide by zero encountered in true_divide
  p2=1 / p2,
d:\codigo_ucm\py_pol\py_pol\mueller.py:1816: RuntimeWarning: invalid value encountered in true_divide
  cte = (Tmax - Tmin) / (Tmax + Tmin)
d:\codigo_ucm\py_pol\py_pol\mueller.py:5257: RuntimeWarning: divide by zero encountered in true_divide
  [np.sign(det) / np.sqrt(val[3, :])])
d:\codigo_ucm\py_pol\py_pol\mueller.py:5257: RuntimeWarning: invalid value encountered in true_divide
  [np.sign(det) / np.sqrt(val[3, :])])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[219]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># different decompositions</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">((</span><span class="s1">&#39;Original retarder&#39;</span><span class="p">,</span> <span class="s1">&#39;Original diattenuator&#39;</span><span class="p">,</span> <span class="s1">&#39;Original depolarizer&#39;</span><span class="p">))</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="c1"># print(Mr, Md, Mp, Mp.transpose(keep=True))</span>

<span class="n">dec</span> <span class="o">=</span> <span class="s1">&#39;PRD&#39;</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decomposition</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>
<span class="c1"># print(M,Mr2, Md2, Mp2)</span>

<span class="n">dec</span> <span class="o">=</span> <span class="s1">&#39;PDR&#39;</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Md</span> <span class="o">*</span> <span class="n">Mr</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decomposition</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>
<span class="c1"># print(M,Mr2, Md2, Mp2)</span>


<span class="n">dec</span> <span class="o">=</span> <span class="s1">&#39;RPD&#39;</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decomposition</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>
<span class="c1"># print(M,Mr2, Md2, Mp2)</span>

<span class="n">dec</span> <span class="o">=</span> <span class="s1">&#39;DRP&#39;</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Md</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Mp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decomposition</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>
<span class="c1"># print(&#39;Error in the retarder:      &#39;, np.linalg.norm(Mr2.M-Mr.M, axis=(0,1)))</span>
<span class="c1"># print(&#39;Error in the diattenuator:  &#39;, np.linalg.norm(Md2.M-Md.M, axis=(0,1)))</span>
<span class="c1"># print(&#39;Error in the depolarizer:   &#39;, np.linalg.norm(Mp2.M-Mp.transpose(keep=True).M, axis=(0,1)))</span>
<span class="c1"># print(M,Mr2, Md2, Mp2)</span>

<span class="n">dec</span> <span class="o">=</span> <span class="s1">&#39;RDP&#39;</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span> <span class="o">*</span> <span class="n">Mp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decomposition</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>
<span class="c1"># print(&#39;Error in the retarder:      &#39;, np.linalg.norm(Mr2.M-Mr.M, axis=(0,1)))</span>
<span class="c1"># print(&#39;Error in the diattenuator:  &#39;, np.linalg.norm(Md2.M-Md.M, axis=(0,1)))</span>
<span class="c1"># print(&#39;Error in the depolarizer:   &#39;, np.linalg.norm(Mp2.M-Mp.transpose(keep=True).M, axis=(0,1)))</span>

<span class="n">dec</span> <span class="o">=</span> <span class="s1">&#39;DPR&#39;</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Md</span> <span class="o">*</span> <span class="n">Mp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="n">Mr</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">Mr2</span><span class="p">,</span> <span class="n">Md2</span><span class="p">,</span> <span class="n">Mp2</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decomposition</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>
<span class="c1"># print(&#39;Error in the retarder:      &#39;, np.linalg.norm(Mr2.M-Mr.M, axis=(0,1)))</span>
<span class="c1"># print(&#39;Error in the diattenuator:  &#39;, np.linalg.norm(Md2.M-Md.M, axis=(0,1)))</span>
<span class="c1"># print(&#39;Error in the depolarizer:   &#39;, np.linalg.norm(Mp2.M-Mp.transpose(keep=True).M, axis=(0,1)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PRD [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
PDR [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
RPD [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DRP [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
RDP [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
DPR [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre></div></div>
</div>
</div>
<div class="section" id="Tests">
<h1>Tests<a class="headerlink" href="#Tests" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="filter_physicall_conditions">
<h2>filter_physicall_conditions<a class="headerlink" href="#filter_physicall_conditions" title="Permalink to this headline">Â¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">35</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">M2</span> <span class="o">*</span> <span class="n">M1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">values_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Values&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vect:&#39;</span><span class="p">,</span> <span class="n">vect</span><span class="p">)</span>
<span class="n">H</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="n">Ht</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">((</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;dial&#39;</span><span class="p">,</span> <span class="s1">&#39;Ht&#39;</span><span class="p">))</span>
<span class="n">diag</span><span class="o">.</span><span class="n">from_components</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span>
                     <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]])</span>
<span class="n">Ht</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">vect</span><span class="p">))</span>
<span class="n">H</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">vect</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="n">Ht</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">H</span> <span class="o">*</span> <span class="n">diag</span> <span class="o">*</span> <span class="n">Ht</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_covariance</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_covariance</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">35</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">M2</span> <span class="o">*</span> <span class="n">M1</span>
<span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">()</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">M</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">vect</span>
<span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="n">Ht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">vect</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">H</span><span class="nd">@diag@Ht</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">result</span><span class="o">-</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">35</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">M2</span> <span class="o">*</span> <span class="n">M1</span>
<span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">()</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">M</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">vect</span>
<span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="n">Ht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">vect</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">H</span><span class="nd">@diag@Ht</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">result</span><span class="o">-</span><span class="n">M</span><span class="p">))</span>

<span class="n">Ho</span><span class="p">,</span> <span class="n">diago</span><span class="p">,</span> <span class="n">Hto</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">((</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;dial&#39;</span><span class="p">,</span> <span class="s1">&#39;Ht&#39;</span><span class="p">))</span>
<span class="n">Ho</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">diago</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span>
<span class="n">Hto</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">Ht</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">Ho</span> <span class="o">*</span> <span class="n">diago</span> <span class="o">*</span> <span class="n">Hto</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">M</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">M</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">values_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">H</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="n">Ht</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">((</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;dial&#39;</span><span class="p">,</span> <span class="s1">&#39;Ht&#39;</span><span class="p">))</span>
<span class="n">diag</span><span class="o">.</span><span class="n">from_components</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span>
                     <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]])</span>
<span class="n">H</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">vect</span><span class="p">)</span>
<span class="n">Ht</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">vect</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ho</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">diago</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Hto</span><span class="p">,</span> <span class="n">Ht</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">H</span> <span class="o">*</span> <span class="n">diag</span> <span class="o">*</span> <span class="n">Ht</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">M</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_retarder_azimuth_ellipticity</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span><span class="o">=</span><span class="mi">35</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">()</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_blocks</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">M2</span> <span class="o">*</span> <span class="n">M1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>


<span class="n">M1</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">()</span>
<span class="n">val</span><span class="p">,</span> <span class="n">vect</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">values_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vectors_as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">H</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="n">Ht</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">((</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;dial&#39;</span><span class="p">,</span> <span class="s1">&#39;Ht&#39;</span><span class="p">))</span>
<span class="n">diag</span><span class="o">.</span><span class="n">from_components</span><span class="p">([</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span>
                     <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]]</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">val</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]])</span>
<span class="n">H</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">vect</span><span class="p">)</span>
<span class="n">Ht</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">vect</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">H</span> <span class="o">*</span> <span class="n">diag</span> <span class="o">*</span> <span class="n">Ht</span>
<span class="n">M2</span><span class="o">.</span><span class="n">from_covariance</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">M</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alphaR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delayR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">create_Mueller</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaR</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayR</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alphaD</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delayD</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_singular</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
M * M * M is singular:
True


------------------------------------------------------
Polar decomposition of M * M * M as M = Mp * Mr * Md.

Analysis of Diattenuator of M * M * M as diattenuator:

- Transmissions of Diattenuator of M * M * M are:
  Max. transmission
0.6531843782800208
  Min. transmission
0.0
  p1
0.8081982295699619
  p2
0.0

- Angles of Diattenuator of M * M * M are:
  Alpha
[70.7295]
  Delay
[208.8485]
  Azimuth
[107.4526]
  Ellipticity angle
[-8.7477]

Diattenuator of M * M * M =
[+0.327 -0.255 -0.178 -0.098]
[-0.255 +0.200 +0.139 +0.077]
[-0.178 +0.139 +0.097 +0.054]
[-0.098 +0.077 +0.054 +0.030]


Analysis of Retarder of M * M * M as retarder:

- Retardance of Retarder of M * M * M is:
141.24641012199788

- Angles of Retarder of M * M * M are:
  Alpha
[37.494]
  Delay
[279.1758]
  Azimuth
[15.3685]
  Ellipticity angle
[-36.2305]

Retarder of M * M * M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 -0.660 -0.526 -0.536]
[+0.000 +0.668 -0.738 -0.099]
[+0.000 -0.343 -0.424 +0.838]


Analysis of Depolarizer of M * M * M as depolarizer:
- Transmissions of Depolarizer of M * M * M from diattenuation are:
  Max. transmission
1.0
  Min. transmission
1.0
  p1
1.0
  p2
1.0

- Transmissions of Depolarizer of M * M * M from polarizance are:
  Max. transmission
1.0
  Min. transmission
1.0
  p1
1.0
  p2
1.0

- Angles of Depolarizer of M * M * M from diattenuation are:
  Alpha
[45.]
  Delay
[0.]
  Azimuth
[45.]
  Ellipticity angle
[0.]

- Angles of Depolarizer of M * M * M from polarizance are:
  Alpha
[45.]
  Delay
[0.]
  Azimuth
[45.]
  Ellipticity angle
[0.]

- Depolarization index of Depolarizer of M * M * M is:
0.0

Depolarizer of M * M * M =
[+1.000 +0.000 +0.000 +0.000]
[+0.000 +1.000 +0.000 +0.000]
[+0.000 +0.000 +1.000 +0.000]
[+0.000 +0.000 +0.000 +1.000]

M * M * M decomposition mean square error:
0.0017112939151076793

------------------------------------------------------

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Luis Miguel Sanchez Brea / Jesus del Hoyo

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>