

<!DOCTYPE html>
<html class="writer-html4" lang="English" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.1. Example 3: Analysis &mdash; Python polarization 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.2. Example 4: Light polarimetry" href="Example_4_Light_polarimetry.html" />
    <link rel="prev" title="2. Advanced" href="example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Python polarization
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">1. Python polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">3. Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">4. py_pol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introductory/example.html">1. Introductory</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="example.html">2. Advanced</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.1. Example 3: Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Analysis-of-light-waves">2.1.1. Analysis of light waves</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Analysis-of-optical-elements">2.1.2. Analysis of optical elements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Example_4_Light_polarimetry.html">2.2. Example 4: Light polarimetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_5_Optical_elements_polarimetry.html">2.3. Example 5: Optical elements polarimetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysis of Mueller Matrix.html">2.4. Analysis of experimental Mueller Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="polarimeter.html">2.5. Polarimeter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">5. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">6. Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">7. History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python polarization</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../examples.html">Examples</a> &raquo;</li>
        
          <li><a href="example.html">2. Advanced</a> &raquo;</li>
        
      <li>2.1. Example 3: Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/source/examples/advanced/Example_3_Analysis.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Example-3:-Analysis">
<h1>2.1. Example 3: Analysis<a class="headerlink" href="#Example-3:-Analysis" title="Permalink to this headline">¶</a></h1>
<p>In Optics, polarimetry is the discipline that studies the measurement and interpretation of the polarization of light waves, and the behavior of optical elements upon the polarization of light waves. In other words, it studies the measurement and analysis of Jones/Stokes vectors (light waves) and Jones/Mueller matrices (optical objects). This example is devoted to show the different analysis possibilities offered by py_pol.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">py_pol</span> <span class="k">import</span> <span class="n">degrees</span>
<span class="kn">from</span> <span class="nn">py_pol.jones_vector</span> <span class="k">import</span> <span class="n">Jones_vector</span>
<span class="kn">from</span> <span class="nn">py_pol.jones_matrix</span> <span class="k">import</span> <span class="n">Jones_matrix</span>
<span class="kn">from</span> <span class="nn">py_pol.stokes</span> <span class="k">import</span> <span class="n">Stokes</span><span class="p">,</span> <span class="n">create_Stokes</span>
<span class="kn">from</span> <span class="nn">py_pol.mueller</span> <span class="k">import</span> <span class="n">Mueller</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div></div>
</div>
<div class="section" id="Analysis-of-light-waves">
<h2>2.1.1. Analysis of light waves<a class="headerlink" href="#Analysis-of-light-waves" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Theory-of-Jones-vectors">
<h3>2.1.1.1. Theory of Jones vectors<a class="headerlink" href="#Theory-of-Jones-vectors" title="Permalink to this headline">¶</a></h3>
<p>A transversal light wave can be described as:</p>
<p><span class="math notranslate nohighlight">\(\overrightarrow{E}=\left[\begin{array}{c} E_{x}\\ E_{y}\\ 0 \end{array}\right]e^{i\left(kz-\omega t\right)}e^{i\varphi}=\overrightarrow{E}_{pol}e^{i\left(kz-\omega t\right)}\)</span></p>
<p>Being <span class="math notranslate nohighlight">\(\varphi\)</span> the global phase, <span class="math notranslate nohighlight">\(z\)</span> the propagation direction of light, $k=:nbsphinx-math:<cite>left</cite><span class="math">\Vert `:nbsphinx-math:</span>overrightarrow{k}`:nbsphinx-math:<cite>right</cite><span class="math">\Vert `$ the wavevector modulus, :math:</span>omega` the angular frequency and <span class="math notranslate nohighlight">\(\overrightarrow{E}_{pol}\)</span> the polarization Jones vector composed of two complex components <span class="math notranslate nohighlight">\(E_x\)</span> and <span class="math notranslate nohighlight">\(E_y\)</span>. Any complex 2x1 vector can describe a physically realizable light wave polarization state.</p>
<p>The Jones vector is completely described by four parameters. There are several sets of parameters that can be used. Some of the most used ones are the following:</p>
<ol class="arabic simple">
<li>The real and imaginary parts of <span class="math notranslate nohighlight">\(E_x\)</span> and <span class="math notranslate nohighlight">\(E_y\)</span>.</li>
<li>Global phase (phase of <span class="math notranslate nohighlight">\(E_x\)</span>, <span class="math notranslate nohighlight">\(\varphi\)</span>), electric field amplitudes (<span class="math notranslate nohighlight">\(\left|E_{x}\right|\)</span> and <span class="math notranslate nohighlight">\(\left|E_{y}\right|\)</span>) and the phase difference between components (<span class="math notranslate nohighlight">\(\delta\)</span>).</li>
<li>Global phase, semimajor and semiminor ellipse axes (<span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> respectively) and the semimajor axis azimuth (<span class="math notranslate nohighlight">\(\phi\)</span>).</li>
<li>Global phase, wave intensity (<span class="math notranslate nohighlight">\(I=\left|E_{x}\right|^{2}+\left|E_{y}\right|^{2}\)</span>) and the characteristic angles <span class="math notranslate nohighlight">\(\alpha\)</span> (ratio angle: <span class="math notranslate nohighlight">\(\tan\alpha=\frac{\left|E_{y}\right|}{\left|E_{x}\right|}\)</span>) and <span class="math notranslate nohighlight">\(\delta\)</span>.</li>
<li>Global phase, wave intensity, azimuth (<span class="math notranslate nohighlight">\(\phi\)</span>) and ellipticity angle (<span class="math notranslate nohighlight">\(\tan\chi=\frac{b}{a}\)</span>).</li>
</ol>
<p>Most of these parameters can be easily visualized in the ellipse produced by the real part of <span class="math notranslate nohighlight">\(\overrightarrow{E}\)</span>:</p>
<p><a class="no-scaled-link reference internal" href="../../../_images/ellipse_angles.png"><img alt="7036fa607baa4e1289f2f37d5ab723ee" class="no-scaled-link" src="../../../_images/ellipse_angles.png" style="width: 495px; height: 320px;" /></a></p>
<p>It is worth noting that not all the values for the four angles should be used. Specifically:</p>
<ol class="arabic simple">
<li><span class="math notranslate nohighlight">\(\;\alpha\;\in\;[0º, 90º]\)</span></li>
<li><span class="math notranslate nohighlight">\(\;\delta\;\in\;[0º, 360º)\)</span></li>
<li><span class="math notranslate nohighlight">\(\;\phi\;\in\;[0º, 180º)\)</span></li>
<li><span class="math notranslate nohighlight">\(\;\chi\;\in\;[-45º, 45º]\)</span></li>
</ol>
<p>Also, there are some cases where two or more different values correspond to the same polarization state. For example, right-handed circular polarization corresponds to <span class="math notranslate nohighlight">\(\chi=45º\)</span> and any azimuth value.</p>
<p>Analyze a Jones vector means calculating one set of 4 parameters. We chose to use mainly the two last sets of parameters, as their physical meaning is easily understood and highly compatible with polarimetry experiments.</p>
<p>In some special cases, one one of the parameters used to describe the light wave may be undetermined. For example, circular polarization states does not have a determined azimuth.</p>
</div>
<div class="section" id="Example-of-analysis-of-Jones-vectors">
<h3>2.1.1.2. Example of analysis of Jones vectors<a class="headerlink" href="#Example-of-analysis-of-Jones-vectors" title="Permalink to this headline">¶</a></h3>
<p>All the parameters described above can be easily calculated from a <em>Jones_vector</em> object through the <em>parameters</em> subclass. This subclass also provides some other parameters that can be useful.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create a random Jones vector</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">(</span><span class="s1">&#39;Random polarization&#39;</span><span class="p">)</span>
<span class="n">E_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">E_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">E</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">E_real</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">E_imag</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random polarization =
[+1.000+0.373j]   [+0.745+0.982j]   [+0.421+0.062j]   [+0.328+0.216j]   [+0.520+0.298j]   [+0.350+0.941j]   [+0.089+0.464j]   [+0.845+0.579j]   [+0.675+0.215j]   [+0.468+0.175j]
[+0.797+0.388j]   [+0.578+0.631j]   [+0.915+0.942j]   [+0.177+0.308j]   [+0.686+0.451j]   [+0.179+0.659j]   [+0.181+0.677j]   [+0.443+0.927j]   [+0.024+0.792j]   [+0.952+0.084j]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate a set of parameters</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">global_phase</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">intensity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">azimuth</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ellipticity_angle</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The global phase of Random polarization is (deg.):
[20.47881277 52.82310549  8.37669939 33.4224342  29.80730163 69.62319614
 79.10493956 34.41232349 17.71335467 20.46600872]
The mean value is 36.62281760625346 +- 22.124347087961016

The intensity of Random polarization is (a.u.):
[1.92452675 2.25289393 1.90468351 0.28056211 1.0330991  1.47356069
 0.71500272 2.10269023 1.13019968 1.16393945]
The mean value is 1.3981158181111537 +- 0.6117112533271021

The azimuth of Random polarization is (deg.):
[39.67195812 34.73076642 75.06633859 41.80155297 53.92044418 34.17850188
 56.03811077 45.103272   54.3856788  62.89374159]
The mean value is 49.77903653215532 +- 12.435733679626598

The ellipticity angle of Random polarization is (deg.):
[ 2.69254418 -2.492722   10.44696024 13.32323771  1.67171187  2.38605174
 -1.88274892 15.02903114 34.78040804 -6.29793778]
The mean value is 6.9656536217808736 +- 11.411191797005818

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate some other parameters</span>
<span class="n">dlp</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_linear_polarization</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dcp</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_circular_polarization</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The degree of linear polarization of Random polarization is:
[0.99558642 0.99621681 0.93424232 0.89379074 0.9982979  0.99653348
 0.9978412  0.86551827 0.34921296 0.97593246]
The mean value is 0.9003172572480562 +- 0.18933560250702827

The degree of circular polarization of Random polarization is:
[ 0.09384921 -0.08690266  0.35663887  0.44848423  0.05832064  0.08319265
 -0.06567304  0.50087735  0.93704339 -0.21807299]
The mean value is 0.2107757665675825 +- 0.3303852934869926

</pre></div></div>
</div>
<p>The <em>checks</em> subclass has some methods that allow analyzing the Jones vectors to see if some conditions are met.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cond</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_linear</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random polarization is linearly polarized:
[False False False False False False False False False False]
The mean value is 0.0 +- 0.0

</pre></div></div>
</div>
</div>
<div class="section" id="Theory-of-Stokes-vectors">
<h3>2.1.1.3. Theory of Stokes vectors<a class="headerlink" href="#Theory-of-Stokes-vectors" title="Permalink to this headline">¶</a></h3>
<p>Stokes vectors can also be used to represent the polarization state of light waves. They are composed of four real elements:</p>
<p><span class="math notranslate nohighlight">\(S=\left[\begin{array}{c} I\\ Q\\ U\\ V \end{array}\right]=\left[\begin{array}{c} S_{0}\\ S_{1}\\ S_{2}\\ S_{3} \end{array}\right]=\left[\begin{array}{c} I_{total}\\ I_{0\text{º}}-I_{90\text{º}}\\ I_{45\text{º}}-I_{135\text{º}}\\ I_{right}-I_{left} \end{array}\right]\)</span></p>
<p>The four elements of the Stokes vector represent some intensities: <span class="math notranslate nohighlight">\(I_{total}\)</span> is the total intensity, <span class="math notranslate nohighlight">\(I_x\)</span> is the partial intensity of linear polarization of angle <span class="math notranslate nohighlight">\(x\)</span>, and <span class="math notranslate nohighlight">\(I_{right}\)</span> and <span class="math notranslate nohighlight">\(I_{left}\)</span> are the partial right-handed and left-handed circular polarizations. Not every 4x1 real vector is a physically realizable Stokes vector, as it must fulfill the conservation of energy:</p>
<p><span class="math notranslate nohighlight">\(S_{0}^{2}\geq S_{1}^{2}+S_{2}^{2}+S_{3}^{2}\)</span>.</p>
<p>There are some differences between Stokes and Jones vectors. Stokes vectors use intensity, while Jones vectors use electric field. This means that Jones vectors have the information of the wave global phase, while Stokes vectors can be used to describe partially depolarized light. Totally polarized states (pure states) have their electric field totally described by the equation above. Totally depolarized light (or natural light) electric field is random (with the module of the electric field
limited by the wave intensity). Partially polarized light can be divided into the sum of a totally polarized state plus a totally unpolarized state:</p>
<p><span class="math notranslate nohighlight">\(S=\wp S_{pol}+(1-\wp)S_{depol}\)</span>.</p>
<p>Being <span class="math notranslate nohighlight">\(\wp\)</span> the polarization degree, <span class="math notranslate nohighlight">\(S_{pol}\)</span> the pure Stokes vector. The totally polarized Stokes vector fulfills the equation:</p>
<p><span class="math notranslate nohighlight">\(S_{0}^{2} = S_{1}^{2}+S_{2}^{2}+S_{3}^{2}\)</span>.</p>
<p>While a totally unpolarized Stokes vectors have <span class="math notranslate nohighlight">\(S_1=S_2=S_3=0\)</span>.</p>
<p><strong>NOTE:</strong> Even if Stokes vectors do not contain neither use the global phase of the light wave, <em>Stokes</em> objects do. So it is possible to calculate the result of interference experiments using <em>Stokes</em> objects.</p>
<p>A Stokes vector can be analyzed by describing some of their parameters. Like Jones vectors, there are several sets of 4 parameters that completely describe a Stokes vector. The most usual are:</p>
<ol class="arabic simple">
<li>The four components of the vector.</li>
<li>Polarization degree, wave total intensity and the characteristic angles <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>.</li>
<li>Polarization degree, wave total intensity, azimuth (<span class="math notranslate nohighlight">\(\phi\)</span>) and ellipticity angle (<span class="math notranslate nohighlight">\(\chi\)</span>).</li>
</ol>
<p>It is important noting that the four angles are defined only for pure states. In the case of partially depolarized states, those angles are referred to the totally polarized part of the Stokes vector.</p>
</div>
<div class="section" id="Example-of-analysis-of-Stokes-vectors">
<h3>2.1.1.4. Example of analysis of Stokes vectors<a class="headerlink" href="#Example-of-analysis-of-Stokes-vectors" title="Permalink to this headline">¶</a></h3>
<p>All the parameters described above can be easily calculated from a <em>Stokes</em> object through the <em>parameters</em> subclass. This subclass also provides some other parameters that can be useful.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create a random Stokes vector</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Stokes</span><span class="p">(</span><span class="s1">&#39;Random polarization&#39;</span><span class="p">)</span>
<span class="n">S_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">S_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># This assures that the Stokes vectors are physically realizable.</span>
<span class="n">S</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">S_matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random polarization =
[+1.732]   [+1.732]   [+1.732]   [+1.732]   [+1.732]   [+1.732]   [+1.732]   [+1.732]   [+1.732]   [+1.732]
[+0.561]   [+0.186]   [+0.951]   [+0.158]   [+0.086]   [+0.228]   [+0.989]   [+0.619]   [+0.674]   [+0.598]
[+0.067]   [+0.690]   [+0.973]   [+0.774]   [+0.379]   [+0.225]   [+0.109]   [+0.932]   [+0.902]   [+0.629]
[+0.949]   [+0.652]   [+0.550]   [+0.132]   [+0.178]   [+0.846]   [+0.966]   [+0.973]   [+0.817]   [+0.579]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate a set of parameters# Calculate a set of parameters</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_polarization</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">intensity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">azimuth</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ellipticity</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ellipticity_angle</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The degree of polarization of Random polarization is:
[0.63762812 0.55837176 0.84697073 0.4626651  0.24694762 0.5224137
 0.80099099 0.85597778 0.80317173 0.60228119]
The mean value is 0.6337418716831728 +- 0.18694668753460006

The intensity of Random polarization is (a.u.):
[1.73205081 1.73205081 1.73205081 1.73205081 1.73205081 1.73205081
 1.73205081 1.73205081 1.73205081 1.73205081]
The mean value is 1.7320508075688772 +- 0.0

The azimuth of Random polarization is (deg):
[ 3.40989654 37.46278842 22.82597776 39.23257653 38.59205754 22.29215954
  3.14242587 28.19732688 26.62926903 23.23188297]
The mean value is 24.501636108744115 +- 12.296732222924637

The ellipticity angle of Random polarization is (deg):
[29.61105375 21.18829465 11.00851636  4.73496352 12.30511127 34.61733771
 22.07461622 20.50166121 17.97886053 16.86008132]
The mean value is 19.088049654937674 +- 8.310918395121357

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate some other parameters</span>
<span class="n">dlp</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_linear_polarization</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dcp</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_circular_polarization</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The degree of linear polarization of Random polarization is:
[0.32628158 0.41248641 0.78520323 0.45635994 0.22451534 0.18521715
 0.57473351 0.64598207 0.65012776 0.50095269]
The mean value is 0.47618596856749357 +- 0.1843437348289973

The degree of circular polarization of Random polarization is:
[0.54782292 0.3763429  0.31751426 0.07612225 0.10283961 0.48847793
 0.55791393 0.56160941 0.47161289 0.33434867]
The mean value is 0.3834604771096698 +- 0.16970620839618467

</pre></div></div>
</div>
<p>The <em>checks</em> subclass has some methods that allow analyzing the Stokes vectors to see if some conditions are met.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cond</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_linear</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random polarization is linearly polarized:
[False False False False False False False False False False]
The mean value is 0.0 +- 0.0

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># This forces the first Stokes vector to not be physically realizable</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_physical</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random polarization is physically realizable:
[False  True  True  True  True  True  True  True  True  True]
The mean value is 0.9 +- 0.30000000000000004

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\stokes.py:3062: RuntimeWarning: invalid value encountered in less_equal
  DOP = self.parent.parameters.degree_polarization(out_number=False)
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Analysis-of-optical-elements">
<h2>2.1.2. Analysis of optical elements<a class="headerlink" href="#Analysis-of-optical-elements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Theory-of-Jones-matrix-objects">
<h3>2.1.2.1. Theory of Jones matrix objects<a class="headerlink" href="#Theory-of-Jones-matrix-objects" title="Permalink to this headline">¶</a></h3>
<p>Pure optical elements (elements that do not depolarize totally polarized light states) can be described by a Jones matrix, a 2x2 matrix of complex numbers:</p>
<p><span class="math notranslate nohighlight">\(J=\left[\begin{array}{cc} J_{00} &amp; J_{01}\\ J_{10} &amp; J_{11} \end{array}\right]\)</span>.</p>
<p>The effect of an optical element upon an incident light wave is calculated by multiplying the Jones matrix of the optical object by the Jones vector of the light wave:</p>
<p><span class="math notranslate nohighlight">\(E_{out}=J\,E_{in}\)</span>.</p>
<p>There are three things that an optical object can do to a light wave in Jones formalism:</p>
<ol class="arabic simple">
<li>Diattenuate (vary the electric field amplitude).</li>
<li>Retard (vary the delay between electric field components).</li>
<li>Increase the global phase.</li>
</ol>
<p>The first two phenomena define two types of optical elements: diattenuator and retarders. Both diattenuators and retarders may increase the global phase of light waves.</p>
<p>Diattenuators are element that vary the electric field amplitude of the incident wave. Usually, this variation is different on both electric field components. These variations are described by the maximum and minimum field transmissions (<span class="math notranslate nohighlight">\(p_1\)</span> and <span class="math notranslate nohighlight">\(p_2\)</span> respectively). Alternatively, intensity transmissions can be used: <span class="math notranslate nohighlight">\(T_{max}=p_1^2\)</span> and <span class="math notranslate nohighlight">\(T_{min}=p2^2\)</span>. Passive diattenuators have both <span class="math notranslate nohighlight">\(T_{i}\leq1\)</span>, while active diattenuators have one or both <span class="math notranslate nohighlight">\(T_{i}&gt;1\)</span>. The
last ones are usually called amplifiers. Diattenuators are often called polarizers (it will be explained for Mueller formalism) and usually have <span class="math notranslate nohighlight">\(p_{1}\simeq1\)</span> and <span class="math notranslate nohighlight">\(p_{2}\simeq0\)</span>.</p>
<p>Retarders introduce a phase delay between electric field components called retardance (<span class="math notranslate nohighlight">\(\Delta\)</span>). This allows changing from linear to elliptical polarization. Retardance is between 0º and 180º, as different values are equivalent to a retardance between those values and/or a rotation. Special cases of retarders are quarter and half-waveplates, which present a retardance of 90º and 180º respectively.</p>
<p>Every Jones matrix due to being a 2x2 matrix, has at least two eigenvectors, often referred as eigenstates. If those eigenstates are orthogonal, the optical element is referred as homogeneous. The eigenvalues of a diattenuator are <span class="math notranslate nohighlight">\(p_1e^{i\varphi}\)</span> and <span class="math notranslate nohighlight">\(p_2e^{i\varphi}\)</span>. The eigenstate associated to <span class="math notranslate nohighlight">\(p_1\)</span> is called the transmission axis and the eigenstate associated to <span class="math notranslate nohighlight">\(p_2\)</span> the extinction axis (due to the usual values for polarizers). In the case of retarders, the two
eigenvalues are <span class="math notranslate nohighlight">\(e^{i\varphi}\)</span> and <span class="math notranslate nohighlight">\(e^{i(\varphi + \Delta}\)</span>. The eigenstate associated with those eigenvalues are called the fast and slow axes respectively, due to the difference in phase.</p>
<p>Independently of the optical element, its eigenstates are usually characterized using two angles: the characteristic angles or azimuth and ellipticity. The reason is that, if a Jones vector is an eigenvector of <span class="math notranslate nohighlight">\(J\)</span>, it remains an eigenvector even if its intensity or global phase is varied. If the optical element is homogeneous, then only one eigenstate is characterized, as the other is orthogonal to the given one. In the case of diattenuators and retarders, the given eigenstate is usually
the transmission axis and the fast axis respectively.</p>
<p>The global phase introduced by the Jones matrix can be a difficult topic. First, this parameter is rarely measured, as most experiments only consider intensity and do not introduce interferences between light waves. Also, the global phase introduced by a Jones matrix may depend on the incident light wave. That renders difficult to define a good reference for global phase. We choose that reference to be when <span class="math notranslate nohighlight">\(J_{00}\)</span> is real and positive.</p>
</div>
<div class="section" id="Examples-of-characterization-of-Jones-matrices">
<h3>2.1.2.2. Examples of characterization of Jones matrices<a class="headerlink" href="#Examples-of-characterization-of-Jones-matrices" title="Permalink to this headline">¶</a></h3>
<p>Many parameters can be easily calculated from a <em>Jones_matrix</em> object through the <em>parameters</em> subclass.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create a random Jones matrix</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;Random element&#39;</span><span class="p">)</span>
<span class="n">M_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">M_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M_real</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">M_imag</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random element =
[+0.210+0.431j +0.205+0.113j]   [+0.556+0.783j +0.282+0.635j]   [+0.702+0.701j +0.101+0.490j]   [+0.854+0.932j +0.235+0.163j]   [+0.643+0.736j +0.098+0.389j]
[+0.523+0.399j +0.995+0.051j]   [+0.855+0.501j +0.146+0.668j]   [+0.164+0.184j +0.214+0.386j]   [+0.967+0.451j +0.548+0.450j]   [+0.922+0.079j +0.328+0.732j]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate the transmission and retardance of the random eleemnt</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transmissions</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">retardance</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The intensity transmissions of Random element are:
  Maximum (int.)
[1.64695644 2.79459313 1.41513167 3.1924615  2.50762893]
  Minimum (int.)
[0.06341533 0.06179514 0.07474705 0.12867671 0.1077289 ]
The mean value of param Maximum (int.) is 2.311354334237151 +- 0.6772049792862028
The mean value of param Minimum (int.) is 0.0872726272050373 +- 0.026487434381375564

The field transmissions of Random element are:
  Maximum (int.)
[1.28333801 1.67170366 1.18959307 1.78674606 1.58354947]
  Minimum (int.)
[0.251824   0.24858629 0.27339907 0.35871537 0.32822082]
The mean value of param Maximum (int.) is 1.502986054752848 +- 0.2288826193829923
The mean value of param Minimum (int.) is 0.2921491068198357 +- 0.04383522087784595

The retardance of Random element is (deg.):
[48.97269025 98.29319062 12.22748499 30.01450328 42.63314305]
The mean value is 46.42820243893986 +- 28.809555663155344

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\jones_matrix.py:2446: ComplexWarning: Casting complex values to real discards the imaginary part
  R[cond1] = 2 * np.arccos(np.sqrt(num / den) * co)
</pre></div></div>
</div>
<p>The <em>checks</em> subclass also includes some interesting methods to calculate if an optical element fulfills some conditions. For example, we can calculate if an element is an homogeneous diattenuator:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cond</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_diattenuator</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random element is an homogeneous diattenuator:
[False False False False False]
The mean value is 0.0 +- 0.0

</pre></div></div>
</div>
<p>Homogeneous diattenuators and retarders are well understood. They are characterized by the transmissions (diattenuators) and retardance (retarders), plus the transmission/fast eigenstate (as the other one is perpendicular). The <em>analysis</em> subclass have two methods to extract those parameters from an homogeneous diattenuator or retarder.</p>
<p>For example, we can create the most general diattenuator and compare the calculations with the original values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create random values</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>

<span class="c1"># Create the py_pol object</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;General random diattenuator&#39;</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

<span class="c1"># Analyze it</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">diattenuator</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="s1">&#39;charac&#39;</span><span class="p">,</span> <span class="n">transmissions</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>

<span class="c1"># Compare the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in p1:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in p2:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in alpha:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in delay&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">delay</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error in p1:
3.575193960459936e-15
Error in p2:
1.2557344989130534e-14
Error in alpha:
4.377375969826691e-13
Error in delay
4.985750427120611e-13
</pre></div></div>
</div>
<p>Same for the most general homogeneous retarder with randomized values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create random values</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>

<span class="c1"># Create the py_pol object</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;General random diattenuator&#39;</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

<span class="c1"># Analyze it</span>
<span class="n">R_calc</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">retarder</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="s1">&#39;charac&#39;</span><span class="p">)</span>

<span class="c1"># Compare the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in retardance:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">R</span> <span class="o">-</span> <span class="n">R_calc</span><span class="p">)</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in alpha:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in delay&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">delay</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error in retardance:
8.913732066593084e-12
Error in alpha:
1.739757186343351e-09
Error in delay
2.711462214533282e-13
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\jones_matrix.py:2446: ComplexWarning: Casting complex values to real discards the imaginary part
  R[cond1] = 2 * np.arccos(np.sqrt(num / den) * co)
</pre></div></div>
</div>
<p>The analysis of homogeneous diattenuators and retarders is very useful and easy to understand. However, not every optical element is an homogeneous diattenuator or retarder. Some of them may be inhomogeneous diattenuators or retarders, easy to understand but not so much to identify. Even more common are optical elements that show both diattenuation and retardance. We provide an easy method to analyze these matrices taking advantage from the polar decomposition theorem. This theorem states that
every Jones matrix can be decomposed in the product of an homogeneous diattenuator <span class="math notranslate nohighlight">\(J_D\)</span> and an homogeneous retarder <span class="math notranslate nohighlight">\(J_R\)</span>. There are two possible combinations:</p>
<ol class="arabic simple">
<li><span class="math notranslate nohighlight">\(J=J_D*J_R\)</span></li>
<li><span class="math notranslate nohighlight">\(J=J_R*J_D\)</span></li>
</ol>
<p>Then, each element can be easily analyzed separately. This means that Jones matrix is decomposed in seven parameters: <span class="math notranslate nohighlight">\(p_1\)</span> and <span class="math notranslate nohighlight">\(p_2\)</span> from <span class="math notranslate nohighlight">\(J_D\)</span>, <span class="math notranslate nohighlight">\(\phi_D\)</span> and <span class="math notranslate nohighlight">\(\chi_D\)</span> (or <span class="math notranslate nohighlight">\(\alpha_D\)</span> and <span class="math notranslate nohighlight">\(\delta_D\)</span>) of the transmission axis of the diattenuator, and <span class="math notranslate nohighlight">\(\Delta\)</span>, <span class="math notranslate nohighlight">\(\phi_R\)</span> and <span class="math notranslate nohighlight">\(\chi_R\)</span> (or <span class="math notranslate nohighlight">\(\alpha_R\)</span> and <span class="math notranslate nohighlight">\(\delta_R\)</span>) of the fast axis of the retarder, plus a global phase phase factor.</p>
<p>Here we present an example of the decomposition and analysis of random matrices.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create random Jones matrices</span>
<span class="n">M_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Create the pypol object</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;Random element&#39;</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M_real</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">M_imag</span><span class="p">)</span>

<span class="c1"># Decompose the matrix and measure all the relevant aprameters</span>
<span class="n">Jr</span><span class="p">,</span> <span class="n">Jd</span><span class="p">,</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_pure</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">all_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

------------------------------------------------------
Polar decomposition of Random element as M = RP.

Analysis of Random element Diattenuator as polarizer:

- Transmissions of Random element Diattenuator are:
  Max. transmission
[2.31222555 2.17868416 2.93798912 3.40565529 2.94364259]
  Min. transmission
[0.03689747 0.02998905 0.09149645 0.23282748 0.0017845 ]
  p1
[1.52060039 1.47603664 1.71405633 1.84544176 1.71570469]
  p2
[0.19208714 0.17317347 0.3024838  0.482522   0.04224337]
The mean value of param Max. transmission is 2.755639340420053 +- 0.451798732850638
The mean value of param Min. transmission is 0.07859899000810314 +- 0.08240774087740922
The mean value of param p1 is 1.654367963003518 +- 0.13676981906708907
The mean value of param p2 is 0.23850195639484006 +- 0.14736284064830235

- Angles of Random element Diattenuator are:
  Alpha
[64.27653861 43.52943726 49.92039375 53.09474915 51.18469335]
  Delay
[ 12.23299094 356.7133992    0.59222081  42.93019956  13.20098798]
  Azimuth
[64.59802752 43.52701883 49.92065146 55.81474284 51.3471884 ]
  Ellipticity angle
[ 4.76902817 -1.64113345  0.29175343 20.42562493  6.4446046 ]
The mean value of param Alpha is 52.40116242268018 +- 6.7505131613387785
The mean value of param Delay is 85.13395969893591 +- 136.50843095527404
The mean value of param Azimuth is 53.041525811294676 +- 6.991136437843724
The mean value of param Ellipticity angle is 6.0579755366576915 +- 7.7558469944698105


Analysis of Random element Retarder as retarder:

- Retardance of Random element Retarder is:
[179.98294741 172.84269897 118.1761176   83.63765305 116.12427906]
The mean value is 134.1527392185979 +- 36.68616282010433

- Angles of Random element Retarder are:
  Alpha
[35.71619068 36.88159097 39.46679517 28.68533112 42.5317236 ]
  Delay
[338.11561768  16.39980999 337.94641839 176.09702366 358.96207944]
  Azimuth
[ 35.05001898  36.55651628  39.04203736 151.34489001  42.53132055]
  Ellipticity
[-10.34567023   7.86418204 -10.81131376   1.6431273   -0.51703504]
The mean value of param Alpha is 36.65632630836703 +- 4.623643411436292
The mean value of param Delay is 245.50418983253775 +- 132.13728200506344
The mean value of param Azimuth is 60.90495663588829 +- 45.29080180391635
The mean value of param Ellipticity is -2.433341937983976 +- 7.198946928846067

Random element decomposition mean square error:
[1.07854610e-15 1.08424519e-15 8.33129733e-16 8.17730320e-16
 9.30138993e-15]
The mean value is 2.62300825445496e-15 +- 3.341156399458237e-15

</pre></div></div>
</div>
</div>
<div class="section" id="Theory-of-Mueller-objects">
<h3>2.1.2.3. Theory of Mueller objects<a class="headerlink" href="#Theory-of-Mueller-objects" title="Permalink to this headline">¶</a></h3>
<p>All the theory of Jones matrices can be directly extrapolated to pure Mueller matrices. However, Mueller-Stokes formalism allows working with partially polarized light and optical elements which depolarize light. This allows defining a third basic optical element: the depolarizer. A depolarizer is an optical element that increases the depolarization degree of incoming light waves.</p>
<p>A Mueller matrix is a 4x4 matrix of real elements. Its 16 components are usually divided in blocks that allow describing its properties easily:</p>
<p><span class="math notranslate nohighlight">\(M=\left[\begin{array}{cccc} M_{00} &amp; M_{01} &amp; M_{02} &amp; M_{03}\\ M_{10} &amp; M_{11} &amp; M_{12} &amp; M_{13}\\ M_{20} &amp; M_{21} &amp; M_{22} &amp; M_{23}\\ M_{30} &amp; M_{31} &amp; M_{32} &amp; M_{33} \end{array}\right]=M\left[\begin{array}{cc} 1 &amp; \overrightarrow{D}\\ \overrightarrow{P} &amp; m \end{array}\right]=M_{00}\left[\begin{array}{cccc} 1 &amp; D_{1} &amp; D_{2} &amp; D_{3}\\ P_{1} &amp; m_{11} &amp; m_{12} &amp; m_{13}\\ P_{2} &amp; m_{21} &amp; m_{22} &amp; m_{23}\\ P_{3} &amp; m_{31} &amp; m_{32} &amp; m_{33} \end{array}\right]\)</span>.</p>
<p>This divides the Mueller matrix in four blocks:</p>
<ol class="arabic simple">
<li><strong>:math:`M_{00}`</strong>: Mean transmission coefficient. This number describes the mean transmission of the object.</li>
<li><strong>:math:`overrightarrow{D}`</strong>: Diattenuation vector. This 1x3 vector describes the properties of the object to reduce the intensity of the light that gets through it.</li>
<li><strong>:math:`overrightarrow{P}`</strong>: Polarizance vector. This 3x1 vector describes the properties of the object to transform depolarized light into polarized light.</li>
<li><strong>:math:`m`</strong>: Small matrix m. This 3x3 matrix describes the depolarization and retardance properties of the optical object.</li>
</ol>
<p>These four blocks allow start to analyze de behavior of a Mueller matrix, as the three basic optical elements fulfill some conditions:</p>
<ol class="arabic simple">
<li>Diattenuator:<ul>
<li><span class="math notranslate nohighlight">\(M_{00}=\frac{p_{1}^{2}+p_{2}^{2}}{2}\)</span>.</li>
<li><span class="math notranslate nohighlight">\(\overrightarrow{D}=\overrightarrow{P}^{T}\)</span>.</li>
<li><span class="math notranslate nohighlight">\(m=m^T\)</span> with <span class="math notranslate nohighlight">\(det(m)=0\)</span>.</li>
</ul>
</li>
<li>Retarder:<ul>
<li><span class="math notranslate nohighlight">\(M_{00}=1\)</span>.</li>
<li><span class="math notranslate nohighlight">\(P_{i}=D_{i}=0\)</span>.</li>
<li><span class="math notranslate nohighlight">\(det(m)=\pm1\)</span>.</li>
</ul>
</li>
<li>Depolarizer:<ul>
<li><span class="math notranslate nohighlight">\(m=m^T\)</span>.</li>
</ul>
</li>
</ol>
<p>This also explains the reason why diattenuators are commonly referred as polarizers: due to the condition <span class="math notranslate nohighlight">\(\overrightarrow{D}=\overrightarrow{P}^{T}\)</span>. This means that a diatenuator reduces the depolarization degree of light waves, behaving also as a polarizer.</p>
</div>
<div class="section" id="Examples-of-characterization-of-Mueller-matrices">
<h3>2.1.2.4. Examples of characterization of Mueller matrices<a class="headerlink" href="#Examples-of-characterization-of-Mueller-matrices" title="Permalink to this headline">¶</a></h3>
<p>Again, the <em>parameters</em> class includes many methods to characterize Mueller matrices.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create optical elements. We start from Jones matrices because it is  easier to create physically realizable random matrices.</span>
<span class="n">M_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">M_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Create the pypol object</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">Jones_matrix</span><span class="p">(</span><span class="s1">&#39;Random element&#39;</span><span class="p">)</span>
<span class="n">J</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="n">M_real</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">M_imag</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Random element&#39;</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">from_Jones</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random element =
[+1.041 +0.976 +0.309 +0.177]   [+1.448 +0.362 +1.302 +0.391]   [+1.478 -0.439 +1.074 +0.860]   [+0.939 -0.242 +0.590 -0.136]   [+1.508 +0.756 +0.654 +0.378]
[-0.011 -0.017 -0.012 +0.050]   [-0.197 +0.146 -0.160 -0.334]   [+0.184 +0.104 +0.345 -0.061]   [-0.010 +0.507 +0.091 -0.438]   [+0.082 -0.242 -0.128 +1.031]
[+0.947 +0.884 +0.303 +0.164]   [+1.158 +0.182 +1.178 +0.200]   [+1.228 -0.269 +0.890 +0.862]   [+0.567 -0.110 +0.873 +0.067]   [+1.052 +0.967 +1.053 +0.441]
[-0.428 -0.418 -0.082 -0.068]   [+0.773 +0.443 +0.633 +0.348]   [-0.738 +0.457 -0.586 -0.303]   [-0.322 +0.496 -0.187 +0.528]   [-0.168 -0.842 +0.659 -0.129]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate the transmissions and retardance of the random matrices</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transmissions</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The intensity transmissions of Random element are:
  Maximum (int.)
[2.0802189  2.85510391 2.92226298 1.59204482 2.57686893]
  Minimum (int.)
[0.00134622 0.04183691 0.03409886 0.28694948 0.43893157]
The mean value of param Maximum (int.) is 2.4052999100062467 +- 0.5032041110108076
The mean value of param Minimum (int.) is 0.16063260711030697 +- 0.1725697670100231

</pre></div></div>
</div>
<p>The <em>checks</em> subclass also includes some interesting methods to calculate if an optical element fulfills some conditions. For example, we can calculate if an element is pure (it must be, as it comes from a Jones matrix):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cond</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_pure</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Random element is pure (non-depolarizing):
[ True  True  True  True  True]
The mean value is 1.0 +- 0.0

</pre></div></div>
</div>
<p>Homogeneous diattenuators and retarders are well understood. They are characterized by the transmissions (diattenuators) and retardance (retarders), plus the transmission/fast eigenstate (as the other one is perpendicular). The <em>analysis</em> subclass have two methods to extract those parameters from an homogeneous diattenuator or retarder.</p>
<p>For example, we can create the most general diattenuator and compare the calculations with the original values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create random values</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>

<span class="c1"># Create the py_pol object</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;General random diattenuator&#39;</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

<span class="c1"># Analyze it</span>
<span class="n">trans</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">diattenuator</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="s1">&#39;charac&#39;</span><span class="p">,</span> <span class="n">transmissions</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>

<span class="c1"># Compare the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in p1:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">trans</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in p2:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="n">trans</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in alpha:&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in delay&#39;</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">delay</span> <span class="o">-</span> <span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">degrees</span>
<span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error in p1:
1.2008898127460164e-15
Error in p2:
8.076479830048999e-14
Error in alpha:
1.0848826826569258e-12
Error in delay
1.53233195374529e-08
</pre></div></div>
</div>
<p>Depolarizers are slightly harder to characterize. The most general depolarizer is easily understood using its division in blocks. First, a depolarizer may present diattenuation ($D=:nbsphinx-math:<cite>left</cite><span class="math">\Vert `:nbsphinx-math:</span>overrightarrow{D}`:nbsphinx-math:<cite>right</cite><span class="math">\Vert `\ :math:</span>) or polarizance (<cite>P=:nbsphinx-math:</cite>left`:nbsphinx-math:<cite>Vert `:nbsphinx-math:</cite>overrightarrow{P}`:nbsphinx-math:<cite>right</cite><span class="math">\Vert `$). That may seem strange, but in
some cases a depolarized can increase the polarization degree light (also, in some cases a non-depolarizing element may decrease the polarization degree of light). Second, the small m matrix has three 3x1 orthonormal eigenvectors :math:</span>overrightarrow{v_{i}}`. Those eigenvectors can be transformed into six Stokes vectors in order to describe the principal states as:</p>
<p><span class="math notranslate nohighlight">\(S_{i}=\left[\begin{array}{c} 1\\ \overrightarrow{v_{i}} \end{array}\right]\)</span>.</p>
<p><span class="math notranslate nohighlight">\(S_{i+3}=\left[\begin{array}{c} 1\\ -\overrightarrow{v_{i}} \end{array}\right]\)</span>.</p>
<p>Its associated eigenvalues (which are lower than 1) are called its depolarization factors.</p>
<p>The principal states are not orthogonal in a polarization sense. Also, in general those states will not be eigenstates of the Mueller matrix of the depolarizer. As the last three states are easily calculated from the first three, only the first ones are usually calculated.</p>
<p>We can check this using a random depolarizer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[136]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the random variables</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">alphaD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delayD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">Dv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaD</span><span class="p">),</span> <span class="n">D</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaD</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delayD</span><span class="p">),</span> <span class="n">D</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaD</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delayD</span><span class="p">)])</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">alphaP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delayP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">Pv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaP</span><span class="p">),</span> <span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaP</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delayP</span><span class="p">),</span> <span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaP</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delayP</span><span class="p">)])</span>

<span class="n">d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">d3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">alpha1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">45</span> <span class="o">*</span> <span class="n">degrees</span> <span class="c1"># Alpha can go up to 90º, but then we could have a problem calculating the orthogonal principal states</span>
<span class="n">alpha2</span> <span class="o">=</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span>  <span class="c1"># If we can compare the results, S1, S2 and S3 3x1 vectors must be orthogonal</span>
<span class="n">alpha3</span> <span class="o">=</span> <span class="mi">45</span><span class="o">*</span><span class="n">degrees</span> <span class="o">-</span> <span class="n">alpha1</span>
<span class="n">delay1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay2</span> <span class="o">=</span> <span class="n">delay1</span> <span class="o">-</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delay3</span> <span class="o">=</span> <span class="n">delay1</span> <span class="o">+</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>

<span class="c1"># Create the pypol objects</span>
<span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span> <span class="o">=</span> <span class="n">create_Stokes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">S1</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay1</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay2</span><span class="p">)</span>
<span class="n">S3</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha3</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay3</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Rangom general depolarizer&#39;</span><span class="p">)</span>
<span class="n">M</span><span class="o">.</span><span class="n">depolarizer_states</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">],</span> <span class="n">S</span><span class="o">=</span><span class="p">[</span><span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span><span class="p">],</span> <span class="n">Pv</span><span class="o">=</span><span class="n">Pv</span><span class="p">,</span> <span class="n">Dv</span><span class="o">=</span><span class="n">Dv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="c1"># Analyze the depolarizer</span>
<span class="n">trans_D</span><span class="p">,</span> <span class="n">trans_P</span><span class="p">,</span> <span class="n">ang_D</span><span class="p">,</span> <span class="n">ang_P</span><span class="p">,</span> <span class="n">depolar</span><span class="p">,</span> <span class="n">principal_states</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">depolarizer</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="s1">&#39;Charac&#39;</span><span class="p">,</span> <span class="n">transmissions</span><span class="o">=</span><span class="s1">&#39;Intensity&#39;</span><span class="p">,</span> <span class="n">depolarization</span><span class="o">=</span><span class="s1">&#39;Factors&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Rangom general depolarizer =
[+1.000 +0.671 +0.005 -0.060]   [+1.000 -0.000 +0.683 +0.174]   [+1.000 -0.243 -0.042 +0.653]   [+1.000 +0.305 -0.468 -0.575]   [+1.000 -0.040 -0.150 +0.019]
[+0.955 +0.579 -0.079 -0.063]   [-0.050 +0.507 -0.154 +0.091]   [-0.101 +0.713 +0.001 -0.019]   [-0.038 +0.184 +0.112 -0.049]   [-0.002 +0.522 -0.059 -0.034]
[+0.157 -0.079 +0.674 +0.312]   [+0.076 -0.154 +0.698 -0.229]   [+0.051 +0.001 +0.687 -0.000]   [-0.706 +0.112 +0.166 +0.007]   [+0.019 -0.059 +0.205 +0.016]
[+0.175 -0.063 +0.312 +0.529]   [+0.026 +0.091 -0.229 +0.445]   [+0.041 -0.019 -0.000 +0.689]   [-0.617 -0.049 +0.007 +0.179]   [+0.027 -0.034 +0.016 +0.187]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[137]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">depolar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">depolar</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">depolar</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.94973259 0.91255888 0.67802625 0.29693391 0.20030754]
[0.28090059 0.30965405 0.68669381 0.18172246 0.17803357]
[0.55135005 0.4280079  0.7239018  0.0507721  0.53658826]


[0.94973259 0.4280079  0.7239018  0.29693391 0.53658826]
[0.55135005 0.91255888 0.67802625 0.0507721  0.20030754]
[0.28090059 0.30965405 0.68669381 0.18172246 0.17803357]


</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[138]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Diattenuation vector errors</span>
<span class="n">Dcalc</span> <span class="o">=</span> <span class="p">(</span><span class="n">trans_D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">trans_D</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">D</span><span class="o">-</span><span class="n">Dcalc</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the diattenuation is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">alphaD</span><span class="o">-</span><span class="n">ang_D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the diattenuation alpha is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">delayD</span><span class="o">-</span><span class="n">ang_D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the diattenuation delay is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The error in the diattenuation is:
1.6653345369377348e-16
The error in the diattenuation alpha is:
2.420669712248692e-16
The error in the diattenuation delay is:
3.198140942662673e-14

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[139]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Polarizance vector errors</span>
<span class="n">Pcalc</span> <span class="o">=</span> <span class="p">(</span><span class="n">trans_P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">trans_P</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">P</span><span class="o">-</span><span class="n">Pcalc</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the polarizance is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">alphaP</span><span class="o">-</span><span class="n">ang_P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the polarizance alpha is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">delayP</span><span class="o">-</span><span class="n">ang_P</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the polarizance delay is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The error in the polarizance is:
7.850462293418876e-17
The error in the polarizance alpha is:
2.5476231888929306e-16
The error in the polarizance delay is:
4.1910000110727263e-16

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[140]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># First depolarization factor / principal state errorserror1 = d1-depolar[0]</span>
<span class="n">error1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">error2</span> <span class="o">=</span> <span class="n">d1</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">error3</span> <span class="o">=</span> <span class="n">d1</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error3</span><span class="p">)])</span> <span class="c1"># Eig algorithms dont give the same order we used, so we have to compare to all</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the first depolarization factor is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">S1</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span>
<span class="n">error4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error6</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the first principal state is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The error in the first depolarization factor is:
3.433175098891678e-16
The error in the first principal state is:
6.847141445191268e-15

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Second depolarization factor / principal state errors</span>
<span class="n">error1</span> <span class="o">=</span> <span class="n">d2</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">error2</span> <span class="o">=</span> <span class="n">d2</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">error3</span> <span class="o">=</span> <span class="n">d2</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error3</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the second depolarization factor is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span>
<span class="n">error4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error6</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the second principal state is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The error in the second depolarization factor is:
2.3714374201337736e-16
The error in the second principal state is:
1.743906609776931e-14

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Third depolarization factor / principal state errors</span>
<span class="n">error1</span> <span class="o">=</span> <span class="n">d3</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">error2</span> <span class="o">=</span> <span class="n">d3</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">error3</span> <span class="o">=</span> <span class="n">d3</span><span class="o">-</span><span class="n">depolar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error3</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the third depolarization factor is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">error1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">S3</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:]</span>
<span class="n">error4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">principal_states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="o">.</span><span class="n">reduce</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error6</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The error in the third principal state is:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The error in the third depolarization factor is:
3.3306690738754696e-16
The error in the third principal state is:
4.443083001703408e-15
</pre></div></div>
</div>
<p>Again, most optical elements do not belong to one of the three basic groups of basic elements, but are a mix of them. In the case of non-pure optical elements, the polar decomposition theorem states that every Mueller matrix can be decomposed in the product of a pure homogeneous diattenuator <span class="math notranslate nohighlight">\(M_D\)</span>, a pure homogeneous retarder <span class="math notranslate nohighlight">\(M_R\)</span> and a depolarizer <span class="math notranslate nohighlight">\(M_P\)</span>:</p>
<p><span class="math notranslate nohighlight">\(M = M_R*M_P*M_D\)</span>.</p>
<p>There are six possible combinations, altering the order of the elements.</p>
<p>This decomposition allows analyzing the three elements separately. The method <em>decompose_polar</em> of <em>analysis</em> class calculates the polar decomposition of Mueller matrices. If only pure matrices are analyzed, use <em>decompose_pure</em> instead. For example, if we build the most general element:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create the diattenuator</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">Md</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Diattenuator&#39;</span><span class="p">)</span>
<span class="n">Md</span><span class="o">.</span><span class="n">diattenuator_charac_angles</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

<span class="c1"># Create the retarder</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span><span class="o">*</span><span class="n">degrees</span>
<span class="n">Mr</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Retarder&#39;</span><span class="p">)</span>
<span class="n">Mr</span><span class="o">.</span><span class="n">retarder_charac_angles</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

<span class="c1"># Create the depolarizer</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">alphaP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delayP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">Pv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaP</span><span class="p">),</span> <span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaP</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delayP</span><span class="p">),</span> <span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alphaP</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delayP</span><span class="p">)])</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">d3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">alpha1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">alpha2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">alpha3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">delay3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
<span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span> <span class="o">=</span> <span class="n">create_Stokes</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">S1</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay1</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay2</span><span class="p">)</span>
<span class="n">S3</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha3</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay3</span><span class="p">)</span>
<span class="n">Mp</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Depolarizer&#39;</span><span class="p">)</span>
<span class="n">Mp</span><span class="o">.</span><span class="n">depolarizer_states</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">],</span> <span class="n">S</span><span class="o">=</span><span class="p">[</span><span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S3</span><span class="p">],</span> <span class="n">Pv</span><span class="o">=</span><span class="n">Pv</span><span class="p">)</span>

<span class="c1"># Calculate the product</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Mp</span> <span class="o">*</span> <span class="n">Mr</span> <span class="o">*</span> <span class="n">Md</span>
<span class="n">M</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;General matrix&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
General matrix =
[+0.698 +0.104 +0.013 +0.152]   [+0.263 -0.016 +0.026 -0.021]   [+0.119 +0.042 -0.005 +0.021]   [+0.060 -0.013 -0.027 -0.001]   [+0.146 +0.078 -0.068 -0.103]
[-0.650 -0.676 -0.875 +0.433]   [+0.113 +0.203 -0.055 -0.090]   [-0.029 -0.057 +0.045 -0.044]   [-0.008 +0.022 -0.017 -0.012]   [-0.073 -0.034 +0.026 +0.061]
[+0.021 -0.047 +0.406 -0.358]   [+0.055 +0.009 +0.097 -0.019]   [+0.031 +0.056 +0.047 +0.083]   [-0.009 -0.019 +0.015 +0.003]   [-0.063 -0.030 +0.028 +0.047]
[-0.161 +0.160 +0.321 -0.270]   [+0.034 -0.117 +0.153 +0.048]   [+0.037 +0.097 -0.017 +0.062]   [+0.019 -0.032 -0.011 -0.023]   [+0.009 +0.006 -0.005 -0.005]

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

------------------------------------------------------
Polar decomposition of General matrix as M = .

Analysis of Diattenuator of General matrix as diattenuator:

- Transmissions of Diattenuator of General matrix are:
  Max. transmission
[0.88198152 0.30022504 0.16590048 0.08914879 0.29243019]
  Min. transmission
[5.13179191e-01 2.25205746e-01 7.11392932e-02 2.99717743e-02
 4.59311831e-04]
  p1
[0.93913871 0.54792795 0.40730882 0.29857794 0.54076814]
  p2
[0.71636526 0.47455847 0.2667195  0.17312358 0.02143156]
The mean value of param Max. transmission is 0.34593720239581227 +- 0.27951730727596963
The mean value of param Min. transmission is 0.1679910631739822 +- 0.18916915204292745
The mean value of param p1 is 0.5467443149886063 +- 0.21681295261919178
The mean value of param p2 is 0.3304396766952467 +- 0.24248852187170236

- Angles of Diattenuator of General matrix are:
  Alpha
[27.84607161 58.04488939 13.84981514 57.53645919 28.88866877]
  Delay
[ 85.0078597  321.07323849 104.32877719 182.56334098 236.40447466]
  Azimuth
[  3.63378343  61.09400437 176.2984921  122.45252888 159.3600951 ]
  Ellipticity angle
[ 27.68745459 -17.17698052  13.383905    -1.16082806 -22.40157465]
The mean value of param Alpha is 37.23318082239673 +- 17.606139936486752
The mean value of param Delay is 185.87553820419188 +- 86.79484435277902
The mean value of param Azimuth is 104.56778077503436 +- 64.10147880568259
The mean value of param Ellipticity angle is 0.06639527144997573 +- 18.675806499471012


Analysis of Retarder of General matrix as retarder:

- Retardance of Retarder of General matrix is:
[170.92392209  49.99121033 104.18931098 154.67147499  76.74592979]
The mean value is 111.30436963607733 +- 45.69334785299364

- Angles of Retarder of General matrix are:
  Alpha
[57.84385169 88.76445186 32.42385232 19.59367553 40.47534568]
  Delay
[343.73653633 127.82768821  24.72208126 202.23867174 224.86760839]
  Azimuth
[ 58.3066556   90.75804107  31.33220352 161.4813861  141.3325167 ]
  Ellipticity angle
[ -7.30910264   0.97579464  11.12232958  -6.91779386 -22.08103099]
The mean value of param Alpha is 47.820235416254064 +- 23.935899584207476
The mean value of param Delay is 184.67851718720647 +- 105.86883741774207
The mean value of param Azimuth is 96.64216059779035 +- 48.930516839740804
The mean value of param Ellipticity angle is -4.841960654879352 +- 10.920496863130417


Analysis of Depolarizer of General matrix as depolarizer:
- Depolarization index of Depolarizer of General matrix is:
[       nan 0.63779108 0.38840727 0.77017126 0.63303606]
The mean value is nan +- nan

- First depolarization factor of Depolarizer of General matrix is:
[2.00466434 1.13485499 1.43749032 0.03901074 1.23742444]
The mean value is 1.1706889647488454 +- 0.6408012474870327

The alpha of First principal state is (deg):
[75.60609681 70.0309573  57.81949517 29.11226629  9.88341614]
The mean value is 48.49044634139649 +- 25.10896217603074

The delay of First principal state is (deg):
[ 42.82915408  79.4028255   49.97008913 344.53020389  20.72726024]
The mean value is 107.49190656698616 +- 119.99523804284395

The azimuth of First principal state is (deg):
[79.0258232  85.62332729 63.36544348 28.63519594  9.2889677 ]
The mean value is 53.18775152168685 +- 29.50657263363871

The ellipticity angle of First principal state is (deg):
[ 9.55480462 19.56235539 21.82755508 -6.55297175  3.43720101]
The mean value is 9.56578887119095 +- 10.4657193387497

- Second depolarization factor of Depolarizer of General matrix is:
[0.44871276 0.47482309 0.15969467 0.62848492 0.24025284]
The mean value is 0.39039365727810144 +- 0.16910422117889026

The alpha of Second principal state is (deg):
[34.13047619 60.35743778 23.17816768 24.71585255 35.16369238]
The mean value is 35.509125315776934 +- 13.326709141628355

The delay of Second principal state is (deg):
[359.35355611 214.60405719 112.72777955 106.5575901  194.90213788]
The mean value is 197.62902416633068 +- 91.59982459282895

The azimuth of Second principal state is (deg):
[ 34.12984885 117.08919412 168.97375487 170.7946478  145.15111827]
The mean value is 127.22771278268712 +- 50.46198599171677

The ellipticity angle of Second principal state is (deg):
[ -0.30023365 -14.61237074  20.9354951   23.36502129  -7.00698018]
The mean value is 4.476186365617659 +- 15.144287657272631

- Third depolarization factor of Depolarizer of General matrix is:
[0.01020537 0.03828233 0.66805179 0.84294551 0.00173165]
The mean value is 0.31224332974003594 +- 0.3663177663524229

The alpha of Third principal state is (deg):
[36.03739245 56.44250227 62.72633067 61.59735072 45.92607924]
The mean value is 52.54593107031307 +- 10.169624245433413

The delay of Third principal state is (deg):
[ 96.76436491 319.12759616 159.95373118  50.62251875 105.56455357]
The mean value is 146.40655291529325 +- 93.08392101591284

The azimuth of Third principal state is (deg):
[169.9960686   59.5855539  116.41952122  67.94063631 131.56402011]
The mean value is 109.1011600280975 +- 41.01783111508235

The ellipticity angle of Third principal state is (deg):
[ 35.44011083 -18.53782158   8.10700669  20.15202588  37.16416867]
The mean value is 16.465098099476872 +- 20.480030006449336

- Depolarizer of General matrix has no diattenuation.
- Transmissions of Depolarizer of General matrix from polarizance are:
  Max. transmission
[1.9983297  1.51463509 1.09615282 1.33680321 1.45700371]
  Min. transmission
[0.0016703  0.48536491 0.90384718 0.66319679 0.54299629]
  p1
[1.4136229  1.23070512 1.04697317 1.15620206 1.20706409]
  p2
[0.04086927 0.69668136 0.95070878 0.81436895 0.73688282]
The mean value of param Max. transmission is 1.4805849044509007 +- 0.2960528227690688
The mean value of param Min. transmission is 0.5194150955490994 +- 0.29605282276906886
The mean value of param p1 is 1.2109134669351374 +- 0.119471670474747
The mean value of param p2 is 0.6479022362064927 +- 0.31565453880425265

- Angles of Depolarizer of General matrix from diattenuation are:
  Alpha
[45. 45. 45. 45. 45.]
  Delay
[0. 0. 0. 0. 0.]
  Azimuth
[45. 45. 45. 45. 45.]
  Ellipticity angle
[0. 0. 0. 0. 0.]
The mean value of param Alpha is 45.0 +- 0.0
The mean value of param Delay is 0.0 +- 0.0
The mean value of param Azimuth is 45.0 +- 0.0
The mean value of param Ellipticity angle is 0.0 +- 0.0

General matrix decomposition mean square error:
[0.16008588 0.1076687  0.12040788 0.12280425 0.1216883 ]
The mean value is 0.12653099945189955 +- 0.017643974691655174

------------------------------------------------------

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo_ucm\py_pol\py_pol\mueller.py:3757: RuntimeWarning: invalid value encountered in sqrt
  DI = sqrt(1. - PP**2)
</pre></div></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Example_4_Light_polarimetry.html" class="btn btn-neutral float-right" title="2.2. Example 4: Light polarimetry" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="example.html" class="btn btn-neutral float-left" title="2. Advanced" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Luis Miguel Sanchez Brea / Jesus del Hoyo

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>