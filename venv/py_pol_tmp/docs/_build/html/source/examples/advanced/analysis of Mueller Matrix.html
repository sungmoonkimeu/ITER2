

<!DOCTYPE html>
<html class="writer-html4" lang="English" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.4. Analysis of experimental Mueller Matrix &mdash; Python polarization 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.5. Polarimeter" href="polarimeter.html" />
    <link rel="prev" title="2.3. Example 5: Optical elements polarimetry" href="Example_5_Optical_elements_polarimetry.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Python polarization
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">1. Python polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">3. Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">4. py_pol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introductory/example.html">1. Introductory</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="example.html">2. Advanced</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Example_3_Analysis.html">2.1. Example 3: Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_4_Light_polarimetry.html">2.2. Example 4: Light polarimetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_5_Optical_elements_polarimetry.html">2.3. Example 5: Optical elements polarimetry</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.4. Analysis of experimental Mueller Matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Filtering">2.4.1. Filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Behavior-analysis">2.4.2. Behavior analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Decomposition">2.4.3. Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="polarimeter.html">2.5. Polarimeter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">5. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">6. Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">7. History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python polarization</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../examples.html">Examples</a> &raquo;</li>
        
          <li><a href="example.html">2. Advanced</a> &raquo;</li>
        
      <li>2.4. Analysis of experimental Mueller Matrix</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/source/examples/advanced/analysis of Mueller Matrix.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Analysis-of-experimental-Mueller-Matrix">
<h1>2.4. Analysis of experimental Mueller Matrix<a class="headerlink" href="#Analysis-of-experimental-Mueller-Matrix" title="Permalink to this headline">¶</a></h1>
<p>In the first example, we saw how we can measure the Mueller matrix of an unknowns sample. This one corresponds to the second part: extract information from that Mueller matrix. This is implemented in the analysis, checks and parameters methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">py_pol</span> <span class="k">import</span> <span class="n">np</span><span class="p">,</span> <span class="n">degrees</span>
<span class="kn">from</span> <span class="nn">py_pol.mueller</span> <span class="k">import</span> <span class="n">Mueller</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.0.2
</pre></div></div>
</div>
<div class="section" id="Filtering">
<h2>2.4.1. Filtering<a class="headerlink" href="#Filtering" title="Permalink to this headline">¶</a></h2>
<p>Experimental measurements are subject to errors that distorts the Mueller matrix recovered from a real polarimeter. Fortunately, there are some mathematical tools we can use in order to reduce them. This is usually refered as filtering.</p>
<div class="section" id="Physical-conditions">
<h3>2.4.1.1. Physical conditions<a class="headerlink" href="#Physical-conditions" title="Permalink to this headline">¶</a></h3>
<p>This type of filtering is a must for all experimental measurements. It is based on the physical properties that Mueller matrices of real objects must satisfy. With the method <strong>filter_physical_conditions</strong>, we transform our Mueller matrix in such a way that it fulfills all those conditions. The user may consult the documentation of the method <strong>is_physical</strong> (Check_Mueller class) for more information about those conditions.</p>
<p>Example: Experimental matrix of air.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create The object of the experimental and theorical matrices</span>
<span class="n">m_air</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">0.9924</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0238</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0096</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0024</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.0198</span><span class="p">,</span> <span class="mf">1.0047</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0066</span><span class="p">,</span> <span class="mf">0.0004</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0058</span><span class="p">,</span> <span class="mf">0.0055</span><span class="p">,</span> <span class="mf">1.0086</span><span class="p">,</span> <span class="mf">0.0050</span><span class="p">],</span>
               <span class="p">[</span><span class="o">-</span><span class="mf">0.0003</span><span class="p">,</span> <span class="mf">0.0053</span><span class="p">,</span> <span class="mf">0.0011</span><span class="p">,</span> <span class="mf">0.9924</span><span class="p">]</span>
              <span class="p">])</span> <span class="o">/</span> <span class="mf">0.9924</span>
<span class="n">M_exp</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Experimental&#39;</span><span class="p">)</span>
<span class="n">M_exp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">m_air</span><span class="p">)</span>
<span class="n">M_target</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Theor&#39;</span><span class="p">)</span>
<span class="n">M_target</span><span class="o">.</span><span class="n">vacuum</span><span class="p">()</span>

<span class="c1"># Filter</span>
<span class="n">M_filtered</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_physical_conditions</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">M_filtered</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Filtered&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The original matrix is:
[[ 1.00000000e+00 -2.39822652e-02 -9.67351874e-03 -2.41837969e-03]
 [ 1.99516324e-02  1.01239420e+00 -6.65054414e-03  4.03063281e-04]
 [ 5.84441757e-03  5.54212011e-03  1.01632406e+00  5.03829101e-03]
 [-3.02297461e-04  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
Second condition was violated. Fixed matrix is:
[[ 1.00000000e+00 -2.39822652e-02 -9.67351874e-03 -2.41837969e-03]
 [ 1.99516324e-02  1.00000000e+00 -6.65054414e-03  4.03063281e-04]
 [ 5.84441757e-03  5.54212011e-03  1.00000000e+00  5.03829101e-03]
 [-3.02297461e-04  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
The original matrix is:
[[ 1.00000000e+00 -2.39822652e-02 -9.67351874e-03 -2.41837969e-03]
 [ 1.99516324e-02  1.00000000e+00 -6.65054414e-03  4.03063281e-04]
 [ 5.84441757e-03  5.54212011e-03  1.00000000e+00  5.03829101e-03]
 [-3.02297461e-04  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
Fifth A condition was violated. Fixed matrix is:
[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 1.99516324e-02  1.00000000e+00 -6.65054414e-03  4.03063281e-04]
 [ 5.84441757e-03  5.54212011e-03  1.00000000e+00  5.03829101e-03]
 [-3.02297461e-04  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
The original matrix is:
[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 1.99516324e-02  1.00000000e+00 -6.65054414e-03  4.03063281e-04]
 [ 5.84441757e-03  5.54212011e-03  1.00000000e+00  5.03829101e-03]
 [-3.02297461e-04  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
Fifth B condition was violated. Fixed matrix is:
[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  1.00000000e+00 -6.65054414e-03  4.03063281e-04]
 [ 0.00000000e+00  5.54212011e-03  1.00000000e+00  5.03829101e-03]
 [ 0.00000000e+00  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
The original matrix is:
[[ 1.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  1.00000000e+00 -6.65054414e-03  4.03063281e-04]
 [ 0.00000000e+00  5.54212011e-03  1.00000000e+00  5.03829101e-03]
 [ 0.00000000e+00  5.34058847e-03  1.10842402e-03  1.00000000e+00]]
None condition was violated.
</pre></div></div>
</div>
<p>We can check if the filtering procedure has improved or not the experimental Mueller matrix.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Calculate mean square error from the ideal case</span>
<span class="n">error_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M_target</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span>
<span class="n">error_filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M_target</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">M_filtered</span><span class="o">.</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span>
<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The experimental matrix is:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_exp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- MSE of the experimental matrix: </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error_exp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The filtered matrix is:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_filtered</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- MSE of the filtered matrix: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">error_filter</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The experimental matrix is:
Experimental =
  [+1.0000, -0.0240, -0.0097, -0.0024]
  [+0.0200, +1.0124, -0.0067, +0.0004]
  [+0.0058, +0.0055, +1.0163, +0.0050]
  [-0.0003, +0.0053, +0.0011, +1.0000]

- MSE of the experimental matrix: 0.00254431357763787.


The filtered matrix is:
Filtered =
  [+1.0000, +0.0000, +0.0000, +0.0000]
  [+0.0000, +1.0000, -0.0067, +0.0004]
  [+0.0000, +0.0055, +1.0000, +0.0050]
  [+0.0000, +0.0053, +0.0011, +1.0000]

- MSE of the filtered matrix: 0.0007132730401082221.
</pre></div></div>
</div>
<p>The error has been reduced in a factor of ~4. We can also see that the elemnts of the diagonal are almost exactly 1, and the errors in the rest of the ellementrs are at most in the 3rd decimal.</p>
</div>
<div class="section" id="Purify">
<h3>2.4.1.2. Purify<a class="headerlink" href="#Purify" title="Permalink to this headline">¶</a></h3>
<p>Many times, we know beforehand some information about the optical element that is measured by a polarimeter. One of the most common facts we can know is if the element does not depolarize, i.e., it is a pure element. Due to the experimental errors, most probably the Mueller matrix retrieved by the polarimeter will not be pure.</p>
<p>A pure Mueller matrix is pure if all the eigenvalues of the covariance matrix are 0 except one. We have implemented two methods that works similarly in order to purify the Mueller matrix: <em>filter_purify_number</em> and <em>filter_purify_threshold</em>. Both make 0 some eigenvalues of the covariance matrix.</p>
<p>Example: Transmission measurement of a chiral turbid famtom (<em>Ghosh, N. et al.&nbsp;2008. Mueller matrix decomposition for extraction of individual polarization parameters from complex turbid media exhibiting multiple scattering, optical activity, and linear birefringence. Journal of Biomedical Optics 13, 044036-14.</em>). This example is performed mathematically in <em>J.J. Gil, R. Ossikovsky “Polarized light and the Mueller Matrix approach”, CRC Press (2016) pp 226</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">py_pol.utils</span> <span class="k">import</span> <span class="n">order_eig</span>

<span class="c1"># Create the object of the experimental measurement</span>
<span class="n">m_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0229</span><span class="p">,</span> <span class="mf">0.0027</span><span class="p">,</span> <span class="mf">0.0058</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.0186</span><span class="p">,</span> <span class="mf">0.9956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0361</span><span class="p">,</span> <span class="mf">0.0318</span><span class="p">],</span>
               <span class="p">[</span><span class="o">-</span><span class="mf">0.0129</span><span class="p">,</span> <span class="mf">0.0392</span><span class="p">,</span> <span class="mf">0.2207</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9656</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.028</span><span class="p">,</span> <span class="mf">0.9706</span><span class="p">,</span> <span class="mf">0.2231</span><span class="p">]</span>
              <span class="p">])</span> <span class="c1"># This is a normalized matrix, so we will always show normalized ones</span>
<span class="n">M_exp</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;Experimental&#39;</span><span class="p">)</span>
<span class="n">M_exp</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">m_exp</span><span class="p">)</span>

<span class="c1"># Calculate the covariance matrix</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">covariance_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The covariance matrix is:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

<span class="c1"># Calculate eigenvalues</span>
<span class="n">qi</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">qi</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">order_eig</span><span class="p">(</span><span class="n">qi</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The eigenvalues are:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The covariance matrix is:
[[ 4.88525e-01+0.j      -8.35000e-03+0.0094j   6.57500e-03-0.00735j
   1.10950e-01-0.48405j]
 [-8.35000e-03-0.0094j   2.17500e-03+0.j      -6.00000e-04-0.00125j
  -1.30250e-02+0.00665j]
 [ 6.57500e-03+0.00735j -6.00000e-04+0.00125j  2.50000e-05+0.j
   9.70000e-03-0.0065j ]
 [ 1.10950e-01+0.48405j -1.30250e-02-0.00665j  9.70000e-03+0.0065j
   5.09275e-01+0.j     ]]

The eigenvalues are:
[ 9.96216864e-01  4.02577388e-03  8.03161335e-04 -1.04579885e-03]
</pre></div></div>
</div>
<p>The last eigenvalue is lower than 0, which is not true in physical Mueller matrices. It must be made zero so M is physical (this operation is also performed by <em>filter_physical_conditions</em>, along with other ones).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M_filter1</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_purify_number</span><span class="p">(</span><span class="n">Neig</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">M_filter1</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Filter 1 eig&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_filter1</span><span class="o">/</span><span class="n">M_filter1</span><span class="o">.</span><span class="n">m00</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filter 1 eig =
  [+1.0000, -0.0222, +0.0023, +0.0059]
  [-0.0193, +0.9937, -0.0358, +0.0314]
  [-0.0127, +0.0396, +0.2204, -0.9651]
  [+0.0017, +0.0281, +0.9689, +0.2229]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
d:\codigo\py_pol\py_pol\mueller.py:532: ComplexWarning: Casting complex values to real discards the imaginary part
  M[i, j] = elem
</pre></div></div>
</div>
<p>As the second and third eigenvalues are very small, it is reasonable to think that the measured optical element is pure. So we can filter all three eigenvalues.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M_filter3</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">filter_purify_number</span><span class="p">(</span><span class="n">Neig</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">M_filter3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Filter 3 eig&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M_filter3</span><span class="o">/</span><span class="n">M_filter3</span><span class="o">.</span><span class="n">m00</span><span class="p">)</span>

<span class="n">cond</span> <span class="o">=</span> <span class="n">M_filter3</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_pure</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The matrix M_filter3 is pure? Answer: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cond</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Filter 3 eig =
  [+1.0000, -0.0211, +0.0009, +0.0091]
  [-0.0208, +0.9988, -0.0362, +0.0320]
  [-0.0095, +0.0395, +0.2226, -0.9739]
  [+0.0024, +0.0281, +0.9740, +0.2238]

The matrix M_filter3 is pure? Answer: True
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Behavior-analysis">
<h2>2.4.2. Behavior analysis<a class="headerlink" href="#Behavior-analysis" title="Permalink to this headline">¶</a></h2>
<p>The first thing that you may do in order to try to understand the meaning of a Mueller matrix is analyze which is its behavior as diattenuator or retarder. There are three methods that can be used: <em>diattenuator</em>, <em>polarizer</em> and <em>retarder</em>. Those methods analyze the mueller matrix <strong>AS IF</strong> they correspond to an homogeneous diattenuator, a polarizer or a retarder. Take a note that it is a big if.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">Mueller</span><span class="p">(</span><span class="s1">&#39;diattenuator&#39;</span><span class="p">)</span>
<span class="n">M1</span><span class="o">.</span><span class="n">diattenuator_charac_angles_from_vector</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">25</span><span class="o">*</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">190</span><span class="o">*</span><span class="n">degrees</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>

<span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">diattenuator</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="s1">&#39;charac&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;M1 has the following diattenuator parameters:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Transmission coefs: -p1 = </span><span class="si">{}</span><span class="s2">.           -p2 = </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Transparent state:  -alpha = </span><span class="si">{}</span><span class="s2"> deg.    -delay = </span><span class="si">{}</span><span class="s2"> deg.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">degrees</span><span class="p">,</span> <span class="n">delay</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
diattenuator =
  [+0.3125, +0.1607, -0.1886, -0.0333]
  [+0.1607, +0.2391, -0.0606, -0.0107]
  [-0.1886, -0.0606, +0.2586, +0.0125]
  [-0.0333, -0.0107, +0.0125, +0.1897]

M1 has the following diattenuator parameters:
  Transmission coefs: -p1 = 0.75.           -p2 = 0.24999999999999997.
  Transparent state:  -alpha = 25.0 deg.    -delay = 190.0 deg.
</pre></div></div>
</div>
<p>As the Mueller matrix has no errors, the measurement of parameters is exact.</p>
<p>But let’s see what happens in a case where we have errors. We can use these methods to check the usefullness of the filtering we saw in the previous section. From the nature of the sample, we can know that the sample must behave approximately as a retarder.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Experimental matrix</span>
<span class="n">_</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_retarder</span><span class="p">(</span><span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">retardance</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">retarder</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="s1">&#39;azel&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distance from Experimental matrix to be considered a pure retarder: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">errors</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   - Retardance = </span><span class="si">{}</span><span class="s2"> deg.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">retardance</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Fast eigenstate: - Azimuth           = </span><span class="si">{}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">azimuth</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   - Ellipticity angle = </span><span class="si">{}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ellipticity</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance from Experimental matrix to be considered a pure retarder: 0.02289734994415676.
                   - Retardance = 77.3085868316892 deg.
  Fast eigenstate: - Azimuth           = 90.0562244816153 deg
                   - Ellipticity angle = -1.1135705865327494 deg
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Filtering of one eigenvalue</span>
<span class="n">_</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">M_filter1</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_retarder</span><span class="p">(</span><span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">retardance</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="n">M_filter1</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">retarder</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="s1">&#39;azel&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distance from Filter 1 matrix to be considered a pure retarder: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">errors</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   - Retardance = </span><span class="si">{}</span><span class="s2"> deg.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">retardance</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Fast eigenstate: - Azimuth           = </span><span class="si">{}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">azimuth</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   - Ellipticity angle = </span><span class="si">{}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ellipticity</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance from Filter 1 matrix to be considered a pure retarder: 0.0262939870146039.
                   - Retardance = 77.37974086749291 deg.
  Fast eigenstate: - Azimuth           = 90.04951588351138 deg
                   - Ellipticity angle = -1.1163055731148146 deg
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Filtering of 3 eigenvalues</span>
<span class="n">_</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">M_filter3</span><span class="o">.</span><span class="n">checks</span><span class="o">.</span><span class="n">is_retarder</span><span class="p">(</span><span class="n">give_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">retardance</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="n">M_filter3</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">retarder</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="s1">&#39;azel&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distance from Filter 1 matrix to be considered a pure retarder: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">errors</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   - Retardance = </span><span class="si">{}</span><span class="s2"> deg.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">retardance</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Fast eigenstate: - Azimuth           = </span><span class="si">{}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">azimuth</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   - Ellipticity angle = </span><span class="si">{}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ellipticity</span><span class="o">/</span><span class="n">degrees</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance from Filter 1 matrix to be considered a pure retarder: 0.010861365008514036.
                   - Retardance = 77.13732793253152 deg.
  Fast eigenstate: - Azimuth           = 90.05750862281892 deg
                   - Ellipticity angle = -1.1134522341557618 deg
</pre></div></div>
</div>
<p>In this case, the filtering does not affect much in the measured parameters. But we can see that after filtering, we are much more certain that the element behaves as a pure retarder.</p>
</div>
<div class="section" id="Decomposition">
<h2>2.4.3. Decomposition<a class="headerlink" href="#Decomposition" title="Permalink to this headline">¶</a></h2>
<p>Using the methods described in the previous section, we need to know beforehand if the element we want to analyze corresponds to a ddiattenuator, polarizer or retarder. That is not always the case. Also, it is usual that real optical elements show diattenuation, polarizance, retardance and depolarization at the same time.</p>
<p>Fortunately, due to their properties, all physical Mueller matrices can be decomposed into a depolarizer, an homogenous retarder and an homogenous diattenuator. We can use this polar decomposition in order to understand the properties of an optical element.</p>
<p>Example: chiral turbid famtom from previous sections</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Md</span><span class="p">,</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">Mp</span> <span class="o">=</span> <span class="n">M_exp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_polar</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
------------------------------------------------------
General case.
Polar decomposition of the matrix M = Mdesp * Mr * Mp:

The depolarizer Mueller matrix is:
depolarizer =
  [+1.0000, +0.0000, +0.0000, +0.0000]
  [+0.0041, +0.9969, +0.0000, -0.0000]
  [-0.0070, +0.0000, +0.9915, -0.0000]
  [-0.0019, -0.0000, -0.0000, +0.9966]

Parameters:
  - Polarizance = 0.008334694965594261.
  - Depolarization degree = 0.09985338379915462.

The retarder Mueller matrix is:
retarder =
  [+1.0000, +0.0000, +0.0000, +0.0000]
  [+0.0000, +0.9988, -0.0362, +0.0320]
  [+0.0000, +0.0393, +0.2227, -0.9741]
  [+0.0000, +0.0281, +0.9742, +0.2239]

Parameters:
  - Delay = 77.1309632136399 deg.
  - Angle = 88.8894601282744 deg; Delay between components = 267.0616037216929 deg.
  - Azimuth = 90.05695718867285 deg; Ellipticity = -1.109079035173538 deg.

The diatenuator/polarizer Mueller matrix is:
diattenuator =
  [+1.0000, -0.0229, +0.0027, +0.0058]
  [-0.0229, +1.0000, -0.0000, -0.0001]
  [+0.0027, -0.0000, +0.9997, +0.0000]
  [+0.0058, -0.0001, +0.0000, +0.9997]

Parameters:
  - p1 = 1.011818600108798; p2 = 0.9880400399143103.
  - Angle = 82.19551946316135 deg; Delay between components = 65.03721016919296 deg.
  - Azimuth = 86.63782345344518 deg; Ellipticity = 7.059435856767925 deg.

The mean square error in the decomposition is: 1.1789986919039411e-15
The maximum error in the decomposition is: 9.992007221626409e-16
------------------------------------------------------
</pre></div></div>
</div>
<p>From this decomposition, we can see that the sample barely depolarizes (<em>Depolarization degree</em> of the depolarizer = 0.10). Also, the difference between <em>p1</em> and <em>p2</em> is small (1.01 and 0.99 respectively). The parameters of the retarder are very similar to the ones determined in the previous section, but their accuracy will be higher, as the depolarization, polarizance and diattenuation have been isolated from retardance.</p>
<p>Note: <em>p1</em> is higher than 1. This is due to the fact that <em>M_exp</em> is not a physical Mueller matrix.</p>
<p>Now, we can do the same with the filtered matrix. As the matrix has been forced to be pure, we can use the method <em>decompose_pure</em> instead of <em>decompose_polar</em>, which decomposes any pure Mueller matrix into a diattenuator and a retarder.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Mr</span><span class="p">,</span> <span class="n">Md</span> <span class="o">=</span> <span class="n">M_filter3</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">decompose_pure</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
------------------------------------------------------
Matrx M decomposed as M = Mr * Md.

The retarder Mueller matrix is:
retarder =
  [+1.0000, -0.0000, +0.0000, +0.0000]
  [+0.0000, +0.9988, -0.0362, +0.0321]
  [-0.0000, +0.0394, +0.2227, -0.9741]
  [+0.0000, +0.0281, +0.9742, +0.2239]

Parameters:
  - Delay = 77.13274318504531 deg.
  - Angle = 88.88659355522645 deg; Delay between components = 266.98801477841516 deg.
  - Azimuth = 90.05853316773448 deg; Ellipticity = -1.1118675730541951 deg.

The diatenuator Mueller matrix is:
diattenuator =
  [+0.9962, -0.0210, +0.0009, +0.0090]
  [-0.0210, +0.9962, -0.0000, -0.0001]
  [+0.0009, -0.0000, +0.9960, +0.0000]
  [+0.0090, -0.0001, +0.0000, +0.9960]

Parameters:
  - p1 = 1.0095126177435985; p2 = 0.9865688024040568.
  - Angle = 78.31151140019138 deg; Delay between components = 84.06091902472883 deg.
  - Azimuth = 88.71953234482453 deg; Ellipticity = 11.622053674000005 deg.

The mean square error in the decomposition is: 1.2762915567195726e-16
The maximum error in the decomposition is: 1.1102230246251565e-16
------------------------------------------------------
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="polarimeter.html" class="btn btn-neutral float-right" title="2.5. Polarimeter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Example_5_Optical_elements_polarimetry.html" class="btn btn-neutral float-left" title="2.3. Example 5: Optical elements polarimetry" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Luis Miguel Sanchez Brea / Jesus del Hoyo

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>