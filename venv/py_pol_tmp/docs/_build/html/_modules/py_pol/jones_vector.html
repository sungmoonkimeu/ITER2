

<!DOCTYPE html>
<html class="writer-html4" lang="English" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>py_pol.jones_vector &mdash; Python polarization 1.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Python polarization
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">1. Python polarization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">3. Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">4. py_pol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">5. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">6. Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">7. History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Python polarization</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>py_pol.jones_vector</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for py_pol.jones_vector</h1><div class="highlight"><pre>
<span></span><span class="c1"># !/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># ------------------------------------</span>
<span class="c1"># Authors:    Luis Miguel Sanchez Brea and Jesus del Hoyo</span>
<span class="c1"># Date:       2019/11/15 (version 1.0)</span>
<span class="c1"># License:    GPL</span>
<span class="c1"># -------------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">We present a class for polarization using Jones framework:</span>

<span class="sd">**Class fields**</span>
<span class="sd">    * **M**: 2xN array containing all the Jones vectors.</span>
<span class="sd">    * **name**: Name of the object for print purposes.</span>
<span class="sd">    * **shape**: Shape desired for the outputs.</span>
<span class="sd">    * **size**: Number of stores Jones vectors.</span>
<span class="sd">    * **_type**: Type of the object (&#39;Jones_vector&#39;). This is used for determining the object class as using isinstance may throw unexpected results in .ipynb files.</span>
<span class="sd">    * **parameters**: Object of class *Parameters_Jones_vector*.</span>
<span class="sd">    * **checks**: Object of class *Checks_Jones_vector*.</span>

<span class="sd">**Generation methods**</span>
<span class="sd">    * **from_components**: Creates a Jones_vector object directly from the electric field components $E_x$ and $E_y$.</span>
<span class="sd">    * **from_matrix**: Creates a Jones_vector object directly from a 2 x shape numpy array.</span>
<span class="sd">    * **from_list**: Creates a Jones_vector object directly from a list of 2 or 2x1 numpy arrays.</span>
<span class="sd">    * **from_distribution**: Creates a Jones vector from the temporal evolution of the electric field components.</span>
<span class="sd">    * **from_Stokes**: Creates a Jones vector from a Stokes object. Take into account that only pure (totally polarized) Stokes vectors must be transformed to Jones vectors, and thet even for them, the global phase might be unknown.</span>
<span class="sd">    * **linear_light**: Creates a state of linear polarization with the desired angle.</span>
<span class="sd">    * **circular_light**: Creates a state of circular polarization.</span>
<span class="sd">    * **eliptical_light**: Creates a state of eliptical polarization.</span>
<span class="sd">    * **general_azimuth_ellipticity**: Creates a Jones vector from the azimuth, ellipticity and amplitude parameters.</span>
<span class="sd">    * **general_charac_angles**: Creates a Jones vector from the characteristic angles and amplitude parameters.</span>

<span class="sd">**Manipulation methods**</span>
<span class="sd">    * **clear**:  Removes data and name form Jones vector.</span>
<span class="sd">    * **copy**:  Creates a copy of the Jones_vector object.</span>
<span class="sd">    * **stretch**:  Stretches a Jones vector of size 1.</span>
<span class="sd">    * **shape_like**:  Takes the shape of another object to use as its own.</span>
<span class="sd">    * **simplify**:  Simplifies the Jones vector in several ways.</span>
<span class="sd">    * **rotate**: Rotates the Jones vector.</span>
<span class="sd">    * **sum**: Calculates the summatory of the Jones vectors in the object.</span>
<span class="sd">    * **flip**: Flips the object along some dimensions.</span>
<span class="sd">    * **reciprocal**: Calculates the Jones vector that propagates backwards.</span>
<span class="sd">    * **orthogonal**: Calculates the orthogonal Jones vector.</span>
<span class="sd">    * **normalize**: Normalize the electric field to be normalized in electric field amplitude or intensity.</span>
<span class="sd">    * **rotate_to_azimuth**: Rotates the Jones vector to have a certain azimuth.</span>
<span class="sd">    * **remove_global_phase**: Calculates the global phase of the electric field (respect to the X component) and removes it.</span>
<span class="sd">    * **add_global_phase**: Adds a global phase to the Jones vector.</span>
<span class="sd">    * **set_global_phase**: Sets the global phase of the Jones vector.</span>
<span class="sd">    * **add_delay**: Adds a phase to the Y component of the electric field of the Jones vector.</span>
<span class="sd">    * **draw_ellipse**:  Draws the polarization ellipse of the Jones vector.</span>


<span class="sd">**Parameters subclass methods**</span>
<span class="sd">    * **matrix**:  Gets a numpy array with all the vectors.</span>
<span class="sd">    * **components**: Calculates the electric field components of the Jones vector.</span>
<span class="sd">    * **amplitudes**: Calculates the electric field amplitudes of the Jones vector.</span>
<span class="sd">    * **intensity**: Calculates the intensity of the Jones vector.</span>
<span class="sd">    * **irradiance**: Calculates the irradiance of the Jones vector.</span>
<span class="sd">    * **alpha**: Calculates the ratio between electric field amplitudes ($E_x$/$E_y$).</span>
<span class="sd">    * **delay / delta**: Calculates the delay (phase shift) between Ex and Ey components of the electric field.</span>
<span class="sd">    * **charac_angles**: Calculates both alpha and delay, the characteristic angles of the Jones vector.</span>
<span class="sd">    * **azimuth**: Calculates azimuth, that is, the orientation angle of the major axis.</span>
<span class="sd">    * **ellipticity_angle**: Calculates the ellipticity angle.</span>
<span class="sd">    * **azimuth_ellipticity**: Calculates both azimuth and ellipticity angles.</span>
<span class="sd">    * **ellipse_axes**: Calculates the length of major and minor axis (a,b).</span>
<span class="sd">    * **ellipticity_param**: Calculates the ellipticity parameter, b/a.</span>
<span class="sd">    * **eccentricity**: Calculates the eccentricity, the complementary of the ellipticity parameter.</span>
<span class="sd">    * **global_phase**: Calculates the global phase of the Jones vector (respect to the X component of the electric field).</span>
<span class="sd">    * **degree_linear_polarization**: Calculates the degree of linear polarization of the Jones vector.</span>
<span class="sd">    * **degree_circular_polarization**: Calculates the degree of circular polarization of the Jones vector.</span>
<span class="sd">    * **norm**: Calculates the norm of the Jones vector.</span>

<span class="sd">    * **get_all**: Returns a dictionary with all the parameters of Jones vector.</span>


<span class="sd">**Checks subclass methods**</span>
<span class="sd">    * **is_linear**: Checks if the Jones vector is lienarly polarized.</span>
<span class="sd">    * **is_circular**: Checks if the Jones vector is circularly polarized.</span>
<span class="sd">    * **is_right_handed**: Checks if the Jones vector rotation direction is right handed.</span>
<span class="sd">    * **is_left_handed**: Checks if the Jones vector rotation direction is left handed.</span>

<span class="sd">    * **get_all**: Returns a dictionary with all the checks of Jones vector.</span>

<span class="sd">**Auxiliar functions**</span>
<span class="sd">    * **create_Jones_vectors**: Function to create several Jones_vector objects at once.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">optimize</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">num_decimals</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">number_types</span>
<span class="kn">from</span> <span class="nn">.drawings</span> <span class="k">import</span> <span class="n">draw_ellipse</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="p">(</span><span class="n">charac_angles_2_azimuth_elipt</span><span class="p">,</span> <span class="n">put_in_limits</span><span class="p">,</span> <span class="n">repair_name</span><span class="p">,</span>
                    <span class="n">rotation_matrix_Jones</span><span class="p">,</span> <span class="n">prepare_variables</span><span class="p">,</span> <span class="n">reshape</span><span class="p">,</span> <span class="n">fit_cos</span><span class="p">,</span>
                    <span class="n">PrintParam</span><span class="p">,</span> <span class="n">take_shape</span><span class="p">,</span> <span class="n">select_shape</span><span class="p">,</span> <span class="n">PrintMatrices</span><span class="p">,</span>
                    <span class="n">fit_distribution</span><span class="p">)</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;PendingDeprecationWarning&#39;</span><span class="p">)</span>

<span class="n">tol_default</span> <span class="o">=</span> <span class="n">eps</span>
<span class="n">N_print_list</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">print_list_spaces</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">j_empty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">change_names</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1">################################################################################</span>
<span class="c1"># Functions</span>
<span class="c1">################################################################################</span>


<div class="viewcode-block" id="create_Jones_vectors"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.create_Jones_vectors">[docs]</a><span class="k">def</span> <span class="nf">create_Jones_vectors</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_object</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that creates several Jones_vector objects att he same time from a list of names or a number.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        names (str, list or tuple): name of vector for string representation. If list or tuple, it also represents the number of objects to be created.</span>
<span class="sd">        N (int): Number of elements to be created. This parameter is overrided if name is a list or tuple. Defeult: 1.</span>
<span class="sd">        out_object (bool): if True and the result is a list of length 1, return a Jones_vector object instead. Default: True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        E (Jones_vector or list): List of Jones vectors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Jones_vector</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Jones_vector</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">out_object</span><span class="p">:</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">E</span></div>


<div class="viewcode-block" id="set_printoptions"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.set_printoptions">[docs]</a><span class="k">def</span> <span class="nf">set_printoptions</span><span class="p">(</span><span class="n">N_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">list_spaces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function that modifies the global print options parameters.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        N_print_list (int): Number of matrices that will be printed as a list if the shape of the object is 1D.</span>
<span class="sd">        print_list_spaces (int): Number ofspaces between matrices if they are printed as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">N_print_list</span><span class="p">,</span> <span class="n">print_list_spaces</span>
    <span class="k">if</span> <span class="n">list_spaces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">print_list_spaces</span> <span class="o">=</span> <span class="n">list_spaces</span>
    <span class="k">if</span> <span class="n">N_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">N_print_list</span> <span class="o">=</span> <span class="n">N_list</span></div>


<span class="c1">################################################################################</span>
<span class="c1"># Main class</span>
<span class="c1">################################################################################</span>


<div class="viewcode-block" id="Jones_vector"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector">[docs]</a><span class="k">class</span> <span class="nc">Jones_vector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for Jones vectors.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        M (np.ndarray): 2xN array containing all the Jones vectors.</span>
<span class="sd">        name (string): Name of the object for print purposes.</span>
<span class="sd">        shape (tuple or list): Shape desired for the outputs.</span>
<span class="sd">        size (int): Number of stores Jones vectors.</span>
<span class="sd">        ndim (int): Number of dimensions for representation purposes.</span>
<span class="sd">        _type (string): Type of the object (&#39;Jones_vector&#39;). This is used for determining the object class as using isinstance may throw unexpected results in .ipynb files.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.parameters (class): Class containing the measurable parameters of the Jones vectors.</span>
<span class="sd">        self.checks (class): Class containing the methods that check something about the Jones vectors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__array_priority__</span> <span class="o">=</span> <span class="mi">10000</span>

    <span class="c1">############################################################################</span>
    <span class="c1"># Operations</span>
    <span class="c1">############################################################################</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Triggers during the Jones_vector inicialization..</span>

<span class="sd">        Parameters:</span>
<span class="sd">            name (string): Name of the object for representation purposes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="s1">&#39;Jones_vector&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">Parameters_Jones_Vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="n">Checks_Jones_Vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds two Jones vectors.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            other (Jones_vector): 2nd Jones vector to add.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="s1">&#39;Jones_vector&#39;</span><span class="p">:</span>
            <span class="n">j3</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">()</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">M</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">take_shape</span><span class="p">((</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; + &quot;</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
            <span class="k">return</span> <span class="n">j3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other is </span><span class="si">{}</span><span class="s1"> instead of Jones_vector.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Substracts two Jones vectors.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            other (Jones_vector): 2nd Jones vector to substract.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span> <span class="ow">is</span> <span class="s1">&#39;Jones_vector&#39;</span><span class="p">:</span>
            <span class="n">j3</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">()</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">M</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">take_shape</span><span class="p">((</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; - &quot;</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
            <span class="k">return</span> <span class="n">j3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other is </span><span class="si">{}</span><span class="s1"> instead of Jones_vector.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Multiplies a Jones vectors by a number.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            other (float or numpy.ndarray): number to multiply.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">j3</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">number_types</span><span class="p">):</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">*</span> <span class="n">other</span>
            <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; * &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">take_shape</span><span class="p">((</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The number of elements in other and </span><span class="si">{}</span><span class="s1"> is not the same&#39;</span><span class="o">.</span>
                    <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;other is not a number or a numpy array, is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
        <span class="c1"># print(&quot;in __mul__ jones vector&quot;)</span>
        <span class="n">j3</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">j3</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Multiplies a Jones vectors by a number.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            other (float or numpy.ndarray): number to multiply.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">j3</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">number_types</span><span class="p">):</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">other</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span>
            <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; * &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">take_shape</span><span class="p">((</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The number of elements in other and </span><span class="si">{}</span><span class="s1"> is not the same: </span><span class="si">{}</span><span class="s1"> vs </span><span class="si">{}</span><span class="s1">&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;other is not a number or a numpy array, is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
        <span class="c1"># print(&quot;in __rmul__ jones vector&quot;)</span>
        <span class="n">j3</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">j3</span>

    <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Divides a Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            other (number or numpy.ndarray): 2nd element to divide.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">j3</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">()</span>
        <span class="c1"># Find the class of the other object</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">number_types</span><span class="p">):</span>
            <span class="n">j3</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">/</span> <span class="n">other</span>
            <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; / &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">Ey</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
                <span class="n">j3</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">take_shape</span><span class="p">((</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">j3</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The number of elements in other and </span><span class="si">{}</span><span class="s1"> is not the same&#39;</span><span class="o">.</span>
                    <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other is Not number&#39;</span><span class="p">)</span>
        <span class="n">j3</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">j3</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents the Jones vector with print().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract the components</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">()</span>
        <span class="c1"># If the object is empty, say it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is empty</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c1"># If the object is 0D or 1D, print it like a list or inline</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="n">N_print_list</span><span class="p">:</span>
                <span class="nb">list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">l0_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">l1_name</span> <span class="o">=</span> <span class="n">PrintMatrices</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">print_list_spaces</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">l0_name</span> <span class="o">+</span> <span class="n">l1_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l0_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Ex = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Ex</span><span class="p">)</span>
                <span class="n">l1_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Ey = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Ey</span><span class="p">)</span>
        <span class="c1"># Print higher dimensionality as pure arrays</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l0_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Ex = </span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Ex</span><span class="p">)</span>
            <span class="n">l1_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Ey = </span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Ey</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">l0_name</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">l1_name</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gives the size of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements object extraction from indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_picked&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c1"># If the indices are 1D, act upon the matrix directly</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">E</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[:,</span> <span class="n">index</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">index</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">E</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[:,</span> <span class="n">index</span><span class="p">])</span>
        <span class="c1"># If not, act upon the components</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ex</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">Ey</span><span class="p">[</span><span class="n">index</span><span class="p">]])</span>
            <span class="n">E</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">E</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements object inclusion from indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that data is a correct pypol object</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;Jones_vector&#39;</span><span class="p">:</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;Stokes&#39;</span><span class="p">:</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="n">Stokes</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">data2</span><span class="o">.</span><span class="n">from_Stokes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;data is type </span><span class="si">{}</span><span class="s1"> instead of Jones_vector or Stokes.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">_type</span><span class="p">))</span>
        <span class="c1"># Change to complex if necessary</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">M</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="c1"># If the indices are 1D, act upon the matrix directly</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data2</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">step</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">step</span>
                <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">index</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">index</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">step</span><span class="p">)</span>
                <span class="n">data3</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data3</span> <span class="o">=</span> <span class="n">data2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">data3</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">index</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">M</span>
        <span class="c1"># If not, act upon the components</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">Ex_new</span><span class="p">,</span> <span class="n">Ey_new</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">Ex</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Ex_new</span><span class="p">)</span>
            <span class="n">Ey</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Ey_new</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements equality operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;Jones_vector&#39;</span><span class="p">:</span>
                <span class="n">j3</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">other</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">j3</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
                <span class="n">cond</span> <span class="o">=</span> <span class="n">norm</span> <span class="o">&lt;</span> <span class="n">tol_default</span>
                <span class="k">return</span> <span class="n">cond</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other is </span><span class="si">{}</span><span class="s1"> instead of Jones_matrix.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">other</span><span class="o">.</span><span class="n">_type</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;other is not a py_pol object&#39;</span><span class="p">)</span>

    <span class="c1">############################################################################</span>
    <span class="c1"># Manipulation</span>
    <span class="c1">############################################################################</span>

<div class="viewcode-block" id="Jones_vector.update"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Internal function. Checks that the .M dimensions are correct.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If .M is a 1D vector, make it a 2D</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
        <span class="c1"># Update number of elements and check that the shape is correct</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">0</span></div>
        <span class="c1"># self.parameters.parent = self</span>
        <span class="c1"># self.parameters.get_all()</span>

<div class="viewcode-block" id="Jones_vector.get_list"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.get_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of 2x1 Jones vectors.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or list): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If the array is empty, return an empty list</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="c1"># If desired, return a numpy array</span>
        <span class="k">elif</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span>
        <span class="c1"># Make the list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Ex</span><span class="p">[</span><span class="n">ind</span><span class="p">]],</span> <span class="p">[</span><span class="n">Ey</span><span class="p">[</span><span class="n">ind</span><span class="p">]]]))</span>
            <span class="k">return</span> <span class="nb">list</span></div>

    <span class="c1"># @_actualize_</span>
<div class="viewcode-block" id="Jones_vector.rotate"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.rotate">[docs]</a>    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">change_name</span><span class="o">=</span><span class="n">change_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rotates a jones vector a certain angle.</span>

<span class="sd">        M_rotated = rotation_matrix_Jones(-angle) * self.M</span>

<span class="sd">        Parameters:</span>
<span class="sd">            angle (float): Rotation angle in radians.</span>
<span class="sd">            keep (bool): If True, the original element is not updated. Default: False.</span>
<span class="sd">            change_name (bool): If True and angle is of size 1, changes the object name adding @ XX deg, being XX the total rotation angle. Default: True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Rotated object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Prepare variables</span>
        <span class="n">angle</span><span class="p">,</span> <span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">([</span><span class="n">angle</span><span class="p">],</span>
                                                      <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                                                      <span class="n">obj</span><span class="o">=</span><span class="n">new_obj</span><span class="p">,</span>
                                                      <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Calculate the array of rotation matrices</span>
        <span class="n">Mrot</span> <span class="o">=</span> <span class="n">rotation_matrix_Jones</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">)</span>
        <span class="c1"># The 1-D case is much simpler. Differenciate it.</span>
        <span class="k">if</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">angle</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">Mrot</span><span class="p">)</span> <span class="o">@</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">M</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Move axes of the variables to allow multiplication</span>
            <span class="n">Mrot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">Mrot</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="c1"># Multiply</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">Mrot</span> <span class="o">@</span> <span class="n">E</span>
            <span class="c1"># Reshape again to accomodate to our way of representing elements</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">E</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Update</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
        <span class="c1"># Update name if required</span>
        <span class="k">if</span> <span class="n">change_name</span> <span class="ow">and</span> <span class="n">angle</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> \
                    <span class="s2">&quot; @ </span><span class="si">{:1.2f}</span><span class="s2"> deg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">)</span>
                <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">repair_name</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

    <span class="c1"># @_actualize_</span>
<div class="viewcode-block" id="Jones_vector.reciprocal"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.reciprocal">[docs]</a>    <span class="k">def</span> <span class="nf">reciprocal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">change_name</span><span class="o">=</span><span class="n">change_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the recirpocal of the Jones vector, so the light is propagated in the opposite direction. It is calculated as Ey = -Ey.</span>

<span class="sd">        References:</span>
<span class="sd">            J.J. Gil, R. Ossikovsky &quot;Polarized light and the Mueller Matrix approach&quot;, CRC Press (2016), pp TODO.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            keep (bool): If True, the original element is not updated. Default: False.</span>
<span class="sd">            change_name (bool): If True, changes the object name adding Recip. of at the beggining of the name. Default: True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Reciprocal Jones matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Extract the components</span>
        <span class="n">old_shape</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="o">-</span><span class="n">Ey</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">old_shape</span>
        <span class="c1"># Fix the name</span>
        <span class="k">if</span> <span class="n">change_name</span><span class="p">:</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Reciprocal of &#39;</span> <span class="o">+</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.orthogonal"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.orthogonal">[docs]</a>    <span class="k">def</span> <span class="nf">orthogonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">change_name</span><span class="o">=</span><span class="n">change_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the orthogonal of the Jones vector.</span>

<span class="sd">        References:</span>
<span class="sd">            J.J. Gil, R. Ossikovsky &quot;Polarized light and the Mueller Matrix approach&quot;, CRC Press (2016), pp 125.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            keep (bool): If True, the original element is not updated. Default: False.</span>
<span class="sd">            change_name (bool): If True, changes the object name adding Recip. of at the beggining of the name. Default: True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Reciprocal Jones matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Extract the characteristic angles</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">charac_angles</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">global_phase</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Calculate the new ones</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">alpha</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">i</span>
        <span class="c1"># Create the object</span>
        <span class="n">old_shape</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">general_charac_angles</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                      <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span>
                                      <span class="n">global_phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">old_shape</span>
        <span class="c1"># Fix the name</span>
        <span class="k">if</span> <span class="n">change_name</span><span class="p">:</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Orthogonal of &#39;</span> <span class="o">+</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.clear"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes data and name form Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">Jones_vector</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.sum"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.sum">[docs]</a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">change_name</span><span class="o">=</span><span class="n">change_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the sum of Jones vectors stored in the object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            axis (int, list or tuple): Axes along which the summatory is performed. If None, all matrices are summed.</span>
<span class="sd">            keep (bool): if True, the original element is not updated. Default: False.</span>
<span class="sd">            change_name (bool): If True, changes the object name adding Recip. of at the beggining of the name. Default: True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Modified object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Simple case</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Complicated case</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Calculate maximum axis</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">axis</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
            <span class="c1"># Check that the axes are correct</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Axis </span><span class="si">{}</span><span class="s1"> greater than the number of dimensions of </span><span class="si">{}</span><span class="s1">, which is </span><span class="si">{}</span><span class="s1">&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
            <span class="c1"># Reshape M to fit the current shape</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
            <span class="c1"># check if the axis is int or not</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
        <span class="c1"># Create the object and return it</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sum of &#39;</span> <span class="o">+</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.flip"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">change_name</span><span class="o">=</span><span class="n">change_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flips the elements stored in the object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            axis (int, list or tuple): Axes along which the flip is performed. If None, the object is flipped as flattened. Default: None.</span>
<span class="sd">            keep (bool): if True, the original element is not updated. Default: False.</span>
<span class="sd">            change_name (bool): If True, changes the object name adding Recip. of at the beggining of the name. Default: True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Modified object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Simple case</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new_list</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">new_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Divide in components</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">()</span>
            <span class="c1"># Flip each one individually</span>
            <span class="n">Ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">Ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Ey</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="c1"># Use them to create the new object</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">)</span>
        <span class="c1"># End operations</span>
        <span class="k">if</span> <span class="n">change_names</span><span class="p">:</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Flip of &#39;</span> <span class="o">+</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">name</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.normalize"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that normalizes the Jones vectors in amplitude or intensity.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            kind (string): Field amplitude or intensity. Default: AMPLITUDE.</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Normalized Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Calculate the normalization factor</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="s1">&#39;AMPLITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;Amp&#39;</span><span class="p">,</span> <span class="s1">&#39;amp&#39;</span><span class="p">,</span> <span class="s1">&#39;AMP&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">):</span>
            <span class="n">norm</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">amplitudes</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">norm</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">intensity</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Calculate the normalized vectors</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">/</span> <span class="n">norm</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">/</span> <span class="n">norm</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.rotate_to_azimuth"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.rotate_to_azimuth">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_to_azimuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that rotates the Jones vector to have a certain azimuth.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            azimuth (string or np.ndarray): Azimuth of the Jones vector. &#39;X&#39;, &#39;Y&#39;, &#39;-X&#39; and &#39;-Y&#39; are the same as 0, 90, 180 and 270 degrees respectively. Default: 0.</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Normalized Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Translate the valid strings</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">azimuth</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">azimuth</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">):</span>
                <span class="n">azimuth</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">azimuth</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">):</span>
                <span class="n">azimuth</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">degrees</span>
            <span class="k">elif</span> <span class="n">azimuth</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-X&#39;</span><span class="p">,</span> <span class="s1">&#39;-x&#39;</span><span class="p">):</span>
                <span class="n">azimuth</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">degrees</span>
            <span class="k">elif</span> <span class="n">azimuth</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-Y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">):</span>
                <span class="n">azimuth</span> <span class="o">=</span> <span class="mi">270</span> <span class="o">*</span> <span class="n">degrees</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Prepare variables</span>
        <span class="n">azimuth</span><span class="p">,</span> <span class="n">new_obj</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">([</span><span class="n">azimuth</span><span class="p">],</span>
                                             <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                                             <span class="n">obj</span><span class="o">=</span><span class="n">new_obj</span><span class="p">)</span>
        <span class="c1"># Calculate the new vector</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">intensity</span><span class="p">()</span>
        <span class="n">el</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ellipticity_angle</span><span class="p">()</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">general_azimuth_ellipticity</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span>
                                            <span class="n">ellipticity</span><span class="o">=</span><span class="n">el</span><span class="p">,</span>
                                            <span class="n">intensity</span><span class="o">=</span><span class="n">I</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

    <span class="c1"># @_actualize_</span>
<div class="viewcode-block" id="Jones_vector.remove_global_phase"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.remove_global_phase">[docs]</a>    <span class="k">def</span> <span class="nf">remove_global_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that transforms the Jones vector removing the global phase, so the first component of the elcric field is real and positive.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Recalculated Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Calculate and remove the global phase</span>
        <span class="n">old_shape</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">global_phase</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">/</span> <span class="n">phase</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">/</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">old_shape</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.add_global_phase"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.add_global_phase">[docs]</a>    <span class="k">def</span> <span class="nf">add_global_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that adds a phase to the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            phase (float or np.ndarray): Phase to be added to the Jones vector. Default: 0.</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Recalculated Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Prepare variables</span>
        <span class="n">phase</span><span class="p">,</span> <span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">([</span><span class="n">phase</span><span class="p">],</span>
                                                      <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                                                      <span class="n">obj</span><span class="o">=</span><span class="n">new_obj</span><span class="p">,</span>
                                                      <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add the phase</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">*</span> <span class="n">phase</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.set_global_phase"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.set_global_phase">[docs]</a>    <span class="k">def</span> <span class="nf">set_global_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that sets the phase of the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            phase (float or np.ndarray): Phase to be added to the Jones vector. Default: 0.</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Recalculated Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Prepare variables</span>
        <span class="n">phase</span><span class="p">,</span> <span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">([</span><span class="n">phase</span><span class="p">],</span>
                                                      <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                                                      <span class="n">obj</span><span class="o">=</span><span class="n">new_obj</span><span class="p">,</span>
                                                      <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Remove the current phase</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">remove_global_phase</span><span class="p">()</span>
        <span class="c1"># Add the phase</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">add_global_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.add_delay"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.add_delay">[docs]</a>    <span class="k">def</span> <span class="nf">add_delay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that adds a phase to the Y component of the electric field of the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            delay (float or np.ndarray): Phase to be added to the Y component of the Jones vector. Default: 0.</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Recalculated Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Prepare variables</span>
        <span class="n">delay</span><span class="p">,</span> <span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">([</span><span class="n">delay</span><span class="p">],</span>
                                                      <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
                                                      <span class="n">obj</span><span class="o">=</span><span class="n">new_obj</span><span class="p">,</span>
                                                      <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add the phase</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">delay</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">delay</span><span class="p">)</span>
        <span class="n">new_obj</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="n">new_obj</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.stretch"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function that stretches a Jones vector to have a higher number of equal elements.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            length (int): Number of elements. Default: 1.</span>
<span class="sd">            keep (bool): If True, self is not updated. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Recalculated Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Act differently if we want to keep self intact</span>
        <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obj</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Act only if neccessary</span>
        <span class="k">if</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">components</span><span class="p">()</span>
            <span class="n">new_obj</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">length</span><span class="p">),</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">length</span><span class="p">))</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">new_obj</span></div>

<div class="viewcode-block" id="Jones_vector.copy"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a copy of the object.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            N (int): Number of copies. Default: 1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector or list): Copied Jones vector object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">E</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">E</span></div>

<div class="viewcode-block" id="Jones_vector.shape_like"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.shape_like">[docs]</a>    <span class="k">def</span> <span class="nf">shape_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes the shape of an object to use in the future.</span>

<span class="sd">        Parameter:</span>
<span class="sd">            obj (py_pol object or nd.array): Object to take the shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that the new shape can be used</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prod</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The number of elements of </span><span class="si">{}</span><span class="s1"> and object are not the same&#39;</span><span class="o">.</span>
                    <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1">#########################################################################</span>
    <span class="c1"># Draw</span>
    <span class="c1">#########################################################################</span>

<div class="viewcode-block" id="Jones_vector.draw_ellipse"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.draw_ellipse">[docs]</a>    <span class="k">def</span> <span class="nf">draw_ellipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draws polarization ellipse of Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            N_angles (int): Number of angles to plot the ellipses. Default: 91.</span>
<span class="sd">            filename (str): name of filename to save the figure.</span>
<span class="sd">            figsize (tuple): A tuple of length 2 containing the figure size.</span>
<span class="sd">            limit (float): limit for drawing. If empty it is obtained from amplitudes.</span>
<span class="sd">            draw_arrow (bool): If True, draws an arrow containing the turning sense of the polarization. Does not work with linear polarization vectors. Default: True.</span>
<span class="sd">            subplots (string, tuple or None): If AS_SHAPE, divides the figure in several subplots as the shape of the py_pol object. If INDIVIDUAL, each vector is represented in its own subaxis, trying to use a square grid. If tuple, divides the figure in that same number of subplots. If None, all ellipses are plot in the same axes. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ax (handle): handle to axis.</span>
<span class="sd">            fig (handle): handle to figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">draw_ellipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span></div>

    <span class="c1">############################################################################</span>
    <span class="c1"># Creation</span>
    <span class="c1">############################################################################</span>

<div class="viewcode-block" id="Jones_vector.from_components"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.from_components">[docs]</a>    <span class="k">def</span> <span class="nf">from_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">Ex</span><span class="p">,</span>
                        <span class="n">Ey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the Jones vector object form the arrays of electric field components.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            Ex (numpy.array, float or 2x1 tuple/list): Electric field amplitude along x axis. This variable can also be a 2x1 tuple or list containing both Ex and Ey.</span>
<span class="sd">            Ey (numpy.array or float): Electric field amplitude along x axis.</span>
<span class="sd">            global_phase (float or numpy.ndarray): Adds a global phase to the Jones vector. Default: 0.</span>
<span class="sd">            length (int): If final object is of size 1, it is stretched to match this size. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Separate components if required</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">Ey</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Ex</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Prepare variables</span>
        <span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">),</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">(</span>
            <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">],</span>
            <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add global Phase</span>
        <span class="k">if</span> <span class="n">global_phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Ex</span> <span class="o">=</span> <span class="n">Ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
            <span class="n">Ey</span> <span class="o">=</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># Store</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.from_matrix"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.from_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Jones vector from an external matrix.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            M (numpy.ndarray or float): New matrix.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if the matrix is of the correct Size</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">size</span>
        <span class="c1"># Case 1D</span>
        <span class="k">if</span> <span class="n">M</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">M</span><span class="o">.</span><span class="n">size</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)))</span>
                <span class="n">new_shape</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;M must have an even number of elements.&#39;</span><span class="p">)</span>
        <span class="c1"># Case 2D</span>
        <span class="k">elif</span> <span class="n">M</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                    <span class="n">new_shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The Jones vector must be a 2xN array&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># Case 3+D</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sh</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">:</span>
                <span class="c1"># Store the shape of the desired outputs</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">sh</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
                <span class="c1"># Store info</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="p">])</span>
                <span class="n">new_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;The Jones vector array must have one axis with 2 elements&#39;</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.from_list"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.from_list">[docs]</a>    <span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Jones_vector object from a list of size 2 or 2x1 arrays.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            l (list): list of vectors.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Preallocate memory</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
        <span class="c1"># Fill it</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
            <span class="n">M</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="c1"># Update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.from_distribution"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.from_distribution">[docs]</a>    <span class="k">def</span> <span class="nf">from_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">Ex</span><span class="p">,</span>
                          <span class="n">Ey</span><span class="p">,</span>
                          <span class="n">ind_d</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">method</span><span class="o">=</span><span class="s1">&#39;direct&#39;</span><span class="p">,</span>
                          <span class="n">N_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine Jones vector from a temporal or spatial electric field distribution [(Ex(t), Ey(t)].</span>

<span class="sd">        Parameters:</span>
<span class="sd">            Ex (numpy.ndarray or float): X component of the electric field</span>
<span class="sd">            Ey (numpy.ndarray or float): Y component of the electric field</span>
<span class="sd">            ind_d (int): Index of the spatial or temporal dimension. Default: -1.</span>
<span class="sd">            method (string): Method for calculating the field amplitude and delay: DIRECT or FIT. Default: direct.</span>
<span class="sd">            N_periods (float): Number of periods in the representation data. It is used by the fit algorithm (real case only) for calculating the frequency. If the value is not exact, convergency may decrease. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Measure sizes, dims, etc</span>
        <span class="n">Ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ex</span><span class="p">)</span>
        <span class="n">Ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ey</span><span class="p">)</span>
        <span class="n">dimsX</span><span class="p">,</span> <span class="n">dimsY</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ex</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="n">Ey</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dimsX</span><span class="p">,</span> <span class="n">dimsY</span><span class="p">)</span>
        <span class="n">shapeX</span><span class="p">,</span> <span class="n">shapeY</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ex</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ey</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ex</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">Ey</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">new_shape</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Check that the data is compatible</span>
        <span class="k">if</span> <span class="n">Nx</span> <span class="o">!=</span> <span class="n">Ny</span> <span class="ow">and</span> <span class="n">dimsX</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dimsY</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Ex and Ey components must have the same number of elements&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Nx</span> <span class="o">!=</span> <span class="n">Ny</span> <span class="ow">and</span> <span class="n">dimsX</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dimsY</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Ex and Ey components must have the same number of elements&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dimsX</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">shapeY</span><span class="p">[</span><span class="n">ind_d</span><span class="p">]</span> <span class="o">==</span> <span class="n">Nx</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Number of elements of X and Y components does not match&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dimsY</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">shapeX</span><span class="p">[</span><span class="n">ind_d</span><span class="p">]</span> <span class="o">==</span> <span class="n">Ny</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Number of elements of X and Y components does not match&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">shapeX</span><span class="p">[</span><span class="n">ind_d</span><span class="p">]</span> <span class="o">!=</span> <span class="n">shapeY</span><span class="p">[</span><span class="n">ind_d</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Temporal dimension of X and Y components does not match&#39;</span><span class="p">)</span>
        <span class="c1"># Check if the variables are real or complex</span>
        <span class="n">complex_X</span> <span class="o">=</span> <span class="n">Ex</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
        <span class="n">complex_Y</span> <span class="o">=</span> <span class="n">Ey</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">complex_X</span> <span class="o">==</span> <span class="n">complex_Y</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Both Ex and Ey must be in the same representation type: real or complex&#39;</span>
            <span class="p">)</span>

        <span class="c1"># Prepare the data as a 2D arrays</span>
        <span class="k">if</span> <span class="n">dimsX</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Nt</span> <span class="o">=</span> <span class="n">shapeX</span><span class="p">[</span><span class="n">ind_d</span><span class="p">]</span>
            <span class="n">NelemX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Nx</span> <span class="o">/</span> <span class="n">Nt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">complex_X</span><span class="p">:</span>
                <span class="n">ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span> <span class="n">NelemX</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span> <span class="n">NelemX</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="p">):</span>
                <span class="n">ex</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ind_d</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">new_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">shapeX</span><span class="p">,</span> <span class="n">ind_d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Nt</span> <span class="o">=</span> <span class="n">Nx</span>
            <span class="n">NelemX</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">dimsY</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">NelemY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ny</span> <span class="o">/</span> <span class="n">Nt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">complex_X</span><span class="p">:</span>
                <span class="n">ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span> <span class="n">NelemY</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nt</span><span class="p">,</span> <span class="n">NelemY</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="p">):</span>
                <span class="n">ey</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">Ey</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">ind_d</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">dimsY</span> <span class="o">&gt;</span> <span class="n">dimsX</span><span class="p">:</span>
                <span class="n">new_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">shapeY</span><span class="p">,</span> <span class="n">ind_d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Ey</span><span class="p">,</span> <span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">NelemY</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Calculate</span>
        <span class="k">if</span> <span class="n">complex_X</span><span class="p">:</span>
            <span class="c1"># Amplitude here is easy to extract</span>
            <span class="n">Ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">Ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="s1">&#39;FIT&#39;</span><span class="p">,</span> <span class="s1">&#39;Fit&#39;</span><span class="p">):</span>
                <span class="n">phaseX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">phaseY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ey</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">phaseX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">phaseX</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">phaseY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">phaseY</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Use just the first value</span>
                <span class="n">phaseX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
                <span class="n">phaseY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">ey</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Real evolution according to cos(k*x) or cos(w*t). Start by calculating the direct values</span>
            <span class="n">Ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">Ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">phaseX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">Ex</span><span class="p">)</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">ex</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="n">ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">phaseX</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">phaseX</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span>
            <span class="n">phaseY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">ey</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">Ey</span><span class="p">)</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">ey</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="n">ey</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">phaseY</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">phaseY</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span>
            <span class="c1"># If using fit, use those values as first guess</span>
            <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;fit&#39;</span><span class="p">,</span> <span class="s1">&#39;FIT&#39;</span><span class="p">,</span> <span class="s1">&#39;Fit&#39;</span><span class="p">):</span>
                <span class="c1"># Prepare variables for X fit</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">zero</span><span class="p">,</span> <span class="n">one</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
                <span class="n">cte</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">N_periods</span> <span class="o">/</span> <span class="n">ex</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">par0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">phaseX</span><span class="p">,</span> <span class="n">one</span> <span class="o">*</span> <span class="n">cte</span><span class="p">,</span> <span class="n">Ex</span><span class="p">))</span>
                <span class="n">min_limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">zero</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="n">zero</span><span class="p">))</span>
                <span class="n">max_limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">one</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">one</span><span class="p">,</span> <span class="n">Ex</span><span class="p">))</span>
                <span class="c1"># X fit</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">fit_distribution</span><span class="p">,</span>
                                                <span class="n">par0</span><span class="p">,</span>
                                                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                                <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">min_limit</span><span class="p">,</span> <span class="n">max_limit</span><span class="p">))</span>
                <span class="n">phaseX</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="n">s</span><span class="p">]</span>
                <span class="n">Ex</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="p">:]</span>
                <span class="c1"># prepare variables for Y fit</span>
                <span class="n">par0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">phaseY</span><span class="p">,</span> <span class="n">one</span> <span class="o">*</span> <span class="n">cte</span><span class="p">,</span> <span class="n">Ey</span><span class="p">))</span>
                <span class="n">max_limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">one</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">one</span><span class="p">,</span> <span class="n">Ey</span><span class="p">))</span>
                <span class="c1"># Y fit</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">fit_distribution</span><span class="p">,</span>
                                                <span class="n">par0</span><span class="p">,</span>
                                                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ey</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                                <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">min_limit</span><span class="p">,</span> <span class="n">max_limit</span><span class="p">))</span>
                <span class="n">phaseY</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="n">s</span><span class="p">]</span>
                <span class="n">Ey</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="p">:]</span>
        <span class="c1"># Finish calculations</span>
        <span class="n">Ex</span> <span class="o">=</span> <span class="n">Ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phaseX</span><span class="p">)</span>
        <span class="n">Ey</span> <span class="o">=</span> <span class="n">Ey</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phaseY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.from_Stokes"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.from_Stokes">[docs]</a>    <span class="k">def</span> <span class="nf">from_Stokes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Jones vector from a Stokes vector. This operation is only meaningful for pure (totally polarized) Stokes vectors. For the rest of them, only the polarized part is transformed, and a warning is printed.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            S (Stokes): Stokes vector object.</span>
<span class="sd">            shape_like (float or numpy.ndarray): Use the shape of this array. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract the totally polarized part</span>
        <span class="n">Sp</span><span class="p">,</span> <span class="n">Su</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">polarized_unpolarized</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                                    <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="c1"># Print a warning if the unpolarized part is meaningful</span>
        <span class="n">DOP</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_depolarization</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">DOP</span> <span class="o">&gt;</span> <span class="n">tol_default</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Non-totally polarized Stokes vector transformed into a Jones vector&#39;</span>
            <span class="p">)</span>
        <span class="c1"># Calculate required parameters of the polarized Stokes vector</span>
        <span class="n">intensity</span> <span class="o">=</span> <span class="n">Sp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">intensity</span><span class="p">()</span>
        <span class="n">azimuth</span> <span class="o">=</span> <span class="n">Sp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">azimuth</span><span class="p">()</span>
        <span class="n">ellipticity</span> <span class="o">=</span> <span class="n">Sp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ellipticity_angle</span><span class="p">()</span>
        <span class="n">global_phase</span> <span class="o">=</span> <span class="n">Sp</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">global_phase</span><span class="p">(</span><span class="n">give_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Generate a Jones vector from those parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_azimuth_ellipticity</span><span class="p">(</span><span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span>
                                         <span class="n">ellipticity</span><span class="o">=</span><span class="n">ellipticity</span><span class="p">,</span>
                                         <span class="n">intensity</span><span class="o">=</span><span class="n">intensity</span><span class="p">,</span>
                                         <span class="n">global_phase</span><span class="o">=</span><span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1"># @_actualize_</span>
    <span class="c1"># def to_Stokes(self, p=1):</span>
    <span class="c1">#     &quot;&quot;&quot;Function that converts Jones light states to Stokes states.</span>
    <span class="c1">#     Parameters:</span>
    <span class="c1">#         p (float or 1x2 float): Degree of polarization, or</span>
    <span class="c1">#             [linear, circular] degrees of polarization.</span>
    <span class="c1">#     Returns:</span>
    <span class="c1">#         S (Stokes object): Stokes state.&quot;&quot;&quot;</span>
    <span class="c1">#     # Check if we are using linear/circular or global polarization degree</span>
    <span class="c1">#</span>
    <span class="c1">#     if np.size(p) T 1:</span>
    <span class="c1">#         (p1, p2) = (p, p)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         (p1, p2) = (p[0], p[1])</span>
    <span class="c1">#</span>
    <span class="c1">#     E = self.M</span>
    <span class="c1">#     # Calculate the vector</span>
    <span class="c1">#     (Ex, Ey) = (E[0,:], E[1,:])</span>
    <span class="c1">#     S = np.zeros([1, 4])</span>
    <span class="c1">#     s0 = abs(Ex)**2 + abs(Ey)**2</span>
    <span class="c1">#     s1 = (abs(Ex)**2 - abs(Ey)**2) * p1</span>
    <span class="c1">#     s2 = 2 * np.real(Ex * np.conj(Ey)) * p1</span>
    <span class="c1">#     s3 = -2 * np.imag(Ex * np.conj(Ey)) * p2</span>
    <span class="c1">#</span>
    <span class="c1">#     S1 = Stokes(self.name)</span>
    <span class="c1">#     S1.from_elements(s0, s1, s2, s3)</span>
    <span class="c1">#     return S1</span>

<div class="viewcode-block" id="Jones_vector.linear_light"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.linear_light">[docs]</a>    <span class="k">def</span> <span class="nf">linear_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">amplitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                     <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Jones vector for polarizer linear light.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            amplitude (numpy.array or float): Array of electric field amplitude. Overrides inetnsity if it is different than None. Default: None.</span>
<span class="sd">            azimuth (numpy.array or float): Array of azimuths. Default: 0.</span>
<span class="sd">            intensity (numpy.array or float): Array of intensity. Default: 1.</span>
<span class="sd">            global_phase (float or numpy.ndarray): Adds a global phase to the Jones vector. Default: 0.</span>
<span class="sd">            length (int): If final object is of size 1, it is stretched to match this size. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use amplitude if specified</span>
        <span class="k">if</span> <span class="n">amplitude</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>
        <span class="c1"># Prepare variables</span>
        <span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">),</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">(</span>
            <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">],</span>
            <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add global Phase</span>
        <span class="k">if</span> <span class="n">global_phase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># Calculate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">),</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.circular_light"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.circular_light">[docs]</a>    <span class="k">def</span> <span class="nf">circular_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span>
                       <span class="n">amplitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Jones vector for polarizer circular light</span>

<span class="sd">        Parameters:</span>
<span class="sd">            kind (str): &#39;d&#39;,&#39;r&#39; - right, dextro.</span>
<span class="sd">                        &#39;l&#39;, &#39;i&#39; - left, levo.</span>
<span class="sd">            amplitude (numpy.array or float): Array of electric field amplitude. Overrides inetnsity if it is different than None. Default: None.</span>
<span class="sd">            intensity (numpy.array or float): Array of intensity. Default: 1.</span>
<span class="sd">            global_phase (float or numpy.ndarray): Adds a global phase to the Jones vector. Default: 0.</span>
<span class="sd">            length (int): If final object is of size 1, it is stretched to match this size. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use amplitude if specified</span>
        <span class="k">if</span> <span class="n">amplitude</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>
        <span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">),</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">(</span>
            <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">],</span>
            <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add global Phase</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">global_phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># Calculate</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="s1">&#39;drDR&#39;</span><span class="p">:</span>  <span class="c1"># derecha, right</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="s1">&#39;ilIL&#39;</span><span class="p">:</span>  <span class="c1"># izquierda, left</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">amplitude</span><span class="p">,</span> <span class="o">-</span><span class="n">amplitude</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;kind </span><span class="si">{}</span><span class="s1"> is not valid.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kind</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.elliptical_light"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.elliptical_light">[docs]</a>    <span class="k">def</span> <span class="nf">elliptical_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                         <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Jones vector of the most general light calculated from the polarization ellipse parameters.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            a (numpy.array or float): Array of electric amplitude of x axis. Default: 1.</span>
<span class="sd">            b (numpy.array or float): Array of electric amplitude of y axis. Default: 1.</span>
<span class="sd">            kind (str): &#39;d&#39;,&#39;r&#39; - right, dextro.</span>
<span class="sd">                        &#39;l&#39;, &#39;i&#39; - left, levo.</span>
<span class="sd">            azimuth (numpy.array or float): Angle of the a axis respect to the x axis. Default: 0.</span>
<span class="sd">            global_phase (float or numpy.ndarray): Adds a global phase to the Jones vector. Default: 0.</span>
<span class="sd">            length (int): If final object is of size 1, it is stretched to match this size. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">),</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">(</span>
            <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">],</span>
            <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add global Phase</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">global_phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># Create the Jones vectors</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="s1">&#39;drDR&#39;</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="s1">&#39;ilIL&#39;</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;kind </span><span class="si">{}</span><span class="s1"> is not valid.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kind</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.general_azimuth_ellipticity"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.general_azimuth_ellipticity">[docs]</a>    <span class="k">def</span> <span class="nf">general_azimuth_ellipticity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="n">ellipticity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="n">amplitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Jones vector from azimuth, ellipticity angle and amplitude parameters.</span>

<span class="sd">        References:</span>
<span class="sd">            J.J. Gil, R. Ossikovsky &quot;Polarized light and the Mueller Matrix approach&quot;, CRC Press (2016), pp 137.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            azimuth (numpy.array or float): [0, pi]: Azimuth. Default: 0.</span>
<span class="sd">            ellipticity (numpy.array or float): [-pi/4, pi/4]: Ellipticity angle. Default: 0.</span>
<span class="sd">            amplitude (numpy.array or float): Array of electric field amplitude. Overrides inetnsity if it is different than None. Default: None.</span>
<span class="sd">            intensity (numpy.array or float): Array of intensity. Default: 1.</span>
<span class="sd">            global_phase (float or numpy.ndarray): Adds a global phase to the Jones vector. Default: 0.</span>
<span class="sd">            length (int): If final object is of size 1, it is stretched to match this size. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use amplitude if specified</span>
        <span class="k">if</span> <span class="n">amplitude</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>
        <span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="p">,</span>
         <span class="n">global_phase</span><span class="p">),</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">(</span>
             <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">],</span>
             <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
             <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
             <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add global Phase</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">global_phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># NaN check</span>
        <span class="k">if</span> <span class="n">azimuth</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">and</span> <span class="n">ellipticity</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;general_azimuth_ellipticity: need total polarized light &quot;</span><span class="p">)</span>
        <span class="c1"># Azimuth can be NaN if ellipticity is +-45º</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ellipticity</span> <span class="o">-</span> <span class="mi">45</span> <span class="o">*</span> <span class="n">degrees</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="p">(</span><span class="n">ellipticity</span> <span class="o">+</span> <span class="mi">45</span> <span class="o">*</span> <span class="n">degrees</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">cond1</span> <span class="o">*</span> <span class="p">(</span><span class="n">cond2</span> <span class="o">+</span> <span class="n">cond3</span><span class="p">)</span>
        <span class="n">azimuth</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Calculate the field</span>
        <span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ellipticity</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ellipticity</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
        <span class="n">e2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ellipticity</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ellipticity</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">e1</span><span class="p">,</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">e2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Jones_vector.general_charac_angles"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Jones_vector.general_charac_angles">[docs]</a>    <span class="k">def</span> <span class="nf">general_charac_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">amplitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">global_phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Jones vector from characteristic angles and amplitude parameters.</span>

<span class="sd">        References:</span>
<span class="sd">            J.J. Gil, R. Ossikovsky &quot;Polarized light and the Mueller Matrix approach&quot;, CRC Press (2016), pp 137.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            alpha (numpy.ndarray or float): Ratio between amplitude of components Ex/Ey of electric field. Default:0</span>
<span class="sd">            delay (numpy.ndarray or float): Phase delay between Ex and Ey components of the electric field. Default: 0.</span>
<span class="sd">            amplitude (numpy.array or float): Array of electric field amplitude. Overrides inetnsity if it is different than None. Default: None.</span>
<span class="sd">            intensity (numpy.array or float): Array of intensity. Default: 1.</span>
<span class="sd">            global_phase (float or numpy.ndarray): Adds a global phase to the Jones vector. Default: 0.</span>
<span class="sd">            length (int): If final object is of size 1, it is stretched to match this size. Default: 1.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (Jones_vector): Created object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use amplitude if specified</span>
        <span class="k">if</span> <span class="n">amplitude</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span>
        <span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">),</span> <span class="n">new_shape</span> <span class="o">=</span> <span class="n">prepare_variables</span><span class="p">(</span>
            <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">amplitude</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">global_phase</span><span class="p">],</span>
            <span class="n">expand</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="n">give_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Add global Phase</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">global_phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">:</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="c1"># NaN check</span>
        <span class="k">if</span> <span class="n">delay</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">and</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;general_azimuth_ellipticity: need total polarized light &quot;</span><span class="p">)</span>
        <span class="c1"># Calculate the field</span>
        <span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">delay</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">e2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">delay</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">amplitude</span> <span class="o">*</span> <span class="n">e1</span><span class="p">,</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">e2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">amplitude</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                             <span class="n">shape_var</span><span class="o">=</span><span class="n">new_shape</span><span class="p">,</span>
                                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<span class="c1">################################################################################</span>
<span class="c1"># Parameters</span>
<span class="c1">################################################################################</span>


<div class="viewcode-block" id="Parameters_Jones_Vector"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector">[docs]</a><span class="k">class</span> <span class="nc">Parameters_Jones_Vector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for Jones vector parameters.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        jones_vector (Jones_vector): Jones Vector</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.M (Jones_vector)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Jones_vector</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">Jones_vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># self.dict_params[&#39;E0x&#39;] = float(np.abs(self.M[0, :]))</span>
        <span class="c1"># self.dict_params[&#39;E0y&#39;] = float(np.abs(self.M[1, :]))</span>
        <span class="c1"># self.dict_params[&#39;delay&#39;] = float(np.angle(self.M[1, :])) - float(</span>
        <span class="c1">#     np.angle(self.M[0]))</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints all the parameters&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_all</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

<div class="viewcode-block" id="Parameters_Jones_Vector.get_all"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.get_all">[docs]</a>    <span class="k">def</span> <span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a dictionary with all the parameters of Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            verbose (bool): If True, print all parameters. Default: False.</span>
<span class="sd">            draw (bool): If True, draw all plots/images of the parameters. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): Dictionary with parameters of Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;Ex&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;Ey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;E0x&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;E0y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitudes</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;irradiance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irradiance</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                         <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;azimuth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuth</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;ellipticity_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipticity_angle</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;global_phase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_phase</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                             <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_axes</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;ellipticity_param&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipticity_param</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;eccentricity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                             <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span>
            <span class="s1">&#39;degree_circular_polarization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree_circular_polarization</span><span class="p">(</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span>
            <span class="s1">&#39;degree_linear_polarization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree_linear_polarization</span><span class="p">(</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.matrix"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.matrix">[docs]</a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the numpy array of Jones vectors.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray): 2xN numpy array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shape</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">select_shape</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                                <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">M</span>
        <span class="k">return</span> <span class="n">M</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.components"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.components">[docs]</a>    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">give_Ez</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the x and y field components of the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            give_Ez (bool): If True, it returns the z component of the electric field (all values will be 0). Default: False.</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Ex (numpy.ndarray or float): Array of electric field along x axis.</span>
<span class="sd">            Ey (numpy.ndarray or float): Array of electric field along y axis.</span>
<span class="sd">            Ez (numpy.ndarray, optional): Array of electric field along z axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the components</span>
        <span class="n">Ex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="c1"># If the result is a number and the user asks for it, return a float</span>
        <span class="k">if</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="n">Ex</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Ex</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Ey</span> <span class="o">=</span> <span class="n">Ey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Calculate Ez and reshape if required</span>
        <span class="k">if</span> <span class="n">give_Ez</span><span class="p">:</span>
            <span class="n">Ez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Ex</span><span class="p">)</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">Ez</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">Ez</span><span class="p">],</span>
                                 <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                 <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                 <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">],</span>
                             <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                             <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                             <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The elctric field components of </span><span class="si">{}</span><span class="s1"> are (V/m):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">give_Ez</span><span class="p">:</span>
                <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">Ez</span><span class="p">),</span>
                           <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ex (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ez (V/m)&#39;</span><span class="p">),</span>
                           <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                           <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">),</span>
                           <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ex (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey (V/m)&#39;</span><span class="p">),</span>
                           <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                           <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">if</span> <span class="n">give_Ez</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">,</span> <span class="n">Ez</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.amplitudes"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.amplitudes">[docs]</a>    <span class="k">def</span> <span class="nf">amplitudes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">give_Ez</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the x and y field amplitudes of the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            give_Ez (bool): If True, it returns the z component of the electric field (all values will be 0). Default: False.</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            E0x (numpy.ndarray or float): Array of electric field amplitude along x axis.</span>
<span class="sd">            E0y (numpy.ndarray or float): Array of electric field amplitude along y axis.</span>
<span class="sd">            E0z (numpy.array, optional): Array of electric field amplitude along z axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate intensity</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="n">E0x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ex</span><span class="p">)</span>
        <span class="n">E0y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ey</span><span class="p">)</span>
        <span class="c1"># Calculate Ez and reshape if required</span>
        <span class="k">if</span> <span class="n">give_Ez</span><span class="p">:</span>
            <span class="n">E0z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">E0x</span><span class="p">)</span>
            <span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span><span class="p">,</span> <span class="n">E0z</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span><span class="p">,</span> <span class="n">E0z</span><span class="p">],</span>
                                    <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                    <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span><span class="p">],</span>
                               <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                               <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                               <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The elctric field amplitudes of </span><span class="si">{}</span><span class="s1"> are (V/m):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">give_Ez</span><span class="p">:</span>
                <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span><span class="p">,</span> <span class="n">E0z</span><span class="p">),</span>
                           <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ex (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ez (V/m)&#39;</span><span class="p">),</span>
                           <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                           <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span><span class="p">),</span>
                           <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ex (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ey (V/m)&#39;</span><span class="p">),</span>
                           <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                           <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">if</span> <span class="n">give_Ez</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span><span class="p">,</span> <span class="n">E0z</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.norm"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.norm">[docs]</a>    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the norm of the Jones vectors.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            intensity (numpy.ndarray or float): Array of intensities.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the norm</span>
        <span class="n">norma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Reshape if neccessary</span>
        <span class="n">norma</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">norma</span><span class="p">],</span>
                        <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                        <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                        <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="n">norma</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">norma</span> <span class="o">=</span> <span class="n">norma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The norm of </span><span class="si">{}</span><span class="s1"> is (a.u.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">norma</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Vector norm (a.u.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">norma</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.intensity"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.intensity">[docs]</a>    <span class="k">def</span> <span class="nf">intensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the intensity of the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            intensity (numpy.ndarray or float): Array of intensities.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate intensity</span>
        <span class="n">I</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                      <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                      <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The intensity of </span><span class="si">{}</span><span class="s1"> is (a.u.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">I</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Intensity (a.u.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">I</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.irradiance"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.irradiance">[docs]</a>    <span class="k">def</span> <span class="nf">irradiance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the intensity of the Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            n (float): Refractive index of the medium.</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            irradiance (numpy.ndarray or float): Array of irradiance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate irradiance</span>
        <span class="n">Irrad</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">eta</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
            <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The irradiance of </span><span class="si">{}</span><span class="s1"> is (W/m^2):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">Irrad</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Irradiance (W/m^2)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Irrad</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.alpha"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.alpha">[docs]</a>    <span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
              <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the angle ratio between amplitude of components Ex/Ey of electric field.</span>

<span class="sd">        References:</span>
<span class="sd">            D. Golstein &quot;Polarized light&quot; 2nd ed Marcel Dekker (2003), 3.4 eq.3-35</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            E0x (numpy.ndarray or float): Array of the electric field amplitude in x axis.</span>
<span class="sd">            E0y (numpy.ndarray or float): Array of the electric field amplitude in y axis.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate alpha</span>
        <span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitudes</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">E0y</span> <span class="o">/</span> <span class="n">E0x</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">put_in_limits</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="c1"># Reshape if neccessary</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">alpha</span><span class="p">],</span>
                        <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                        <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                        <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The ratio angle between electric field amplitudes of </span><span class="si">{}</span><span class="s1"> is (deg.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Alpha (deg.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">alpha</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.delay"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.delay">[docs]</a>    <span class="k">def</span> <span class="nf">delay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
              <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the delay (phase shift) between Ex and Ey components of the electric field.</span>

<span class="sd">        References:</span>
<span class="sd">            D. Golstein &quot;Polarized light&quot; 2nd ed Marcel Dekker (2003), 3.4 eq.3-33b.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or float) [0, 2*pi]: Array of delay angles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate delay</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Ey</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Ex</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">put_in_limits</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="c1"># Reshape if neccessary</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">delay</span><span class="p">],</span>
                        <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                        <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                        <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;Delay between electric field components of </span><span class="si">{}</span><span class="s1"> is (deg.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">delay</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Delay (deg.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">delay</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.delta"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.delta">[docs]</a>    <span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
              <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the delay (phase shift) between Ex and Ey components of the electric field. It is the same method as delay.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">        shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">        shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">        verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">        draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        delta (numpy.ndarray or float) [0, 2*pi]: Array of delay angles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                          <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">,</span>
                          <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                          <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                          <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.charac_angles"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.charac_angles">[docs]</a>    <span class="k">def</span> <span class="nf">charac_angles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the characteristic angles (alpha and delay) of a Jones vector.</span>

<span class="sd">        References:</span>
<span class="sd">            D. Golstein &quot;Polarized light&quot; 2nd ed Marcel Dekker (2003), 3.4 eq.3-33b.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            alpha (numpy.ndarray or float): [0, pi/2]: Array of alpha angles.</span>
<span class="sd">            delay (numpy.ndarray or float): [0, 2*pi]: Array of delay angles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                           <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                           <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                           <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                           <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The characteristic angles of </span><span class="si">{}</span><span class="s1"> are:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">delay</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Alpha (deg.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Delay (deg.)&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.azimuth"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.azimuth">[docs]</a>    <span class="k">def</span> <span class="nf">azimuth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates azimuth, that is, the orientation of the major axis.</span>

<span class="sd">        References:</span>
<span class="sd">            J. J. Gil, &quot;Polarized light and the Mueller Matrix approach&quot;, pp 137.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            azimuth (numpy.ndarray or float): [0, pi]: Array of azimuth angles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate azimuth</span>
        <span class="n">azimuth</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuth_ellipticity</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                                              <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                              <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The azimuth of </span><span class="si">{}</span><span class="s1"> is (deg.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">azimuth</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Azimuth (deg.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">azimuth</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.ellipticity_angle"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.ellipticity_angle">[docs]</a>    <span class="k">def</span> <span class="nf">ellipticity_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the ellipticity angle.</span>

<span class="sd">        References:</span>
<span class="sd">            J. J. Gil, &quot;Polarized light and the Mueller Matrix approach&quot;, pp 137.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ellipticity (numpy.ndarray or float) [-pi/4, pi/4]: Array of ellipticity angles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the ellipticity</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuth_ellipticity</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                                                  <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                                  <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The ellipticity angle of </span><span class="si">{}</span><span class="s1"> is (deg.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">ellipticity</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Ellipticity angle (deg.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ellipticity</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.azimuth_ellipticity"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.azimuth_ellipticity">[docs]</a>    <span class="k">def</span> <span class="nf">azimuth_ellipticity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the azimuth and ellipticity angle of a Jones vector.</span>

<span class="sd">        References:</span>
<span class="sd">            J. J. Gil, &quot;Polarized light and the Mueller Matrix approach&quot;, pp 137.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            azimuth (numpy.ndarray or float): [0, pi]: Array of azimuth angles.</span>
<span class="sd">            ellipticity (numpy.ndarray or float) [-pi/4, pi/4]: Array of ellipticity angles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate alpha and delta, then transform</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charac_angles</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">,</span>
                                          <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                          <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">=</span> <span class="n">charac_angles_2_azimuth_elipt</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The azimuth and ellipticity angles of </span><span class="si">{}</span><span class="s1"> are (deg.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">azimuth</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">ellipticity</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Azimuth (deg.)&#39;</span><span class="p">,</span> <span class="s1">&#39;Ellipticity angle (deg.)&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">ellipticity</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.global_phase"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.global_phase">[docs]</a>    <span class="k">def</span> <span class="nf">global_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the phase of the first component of the electric field (which is the reference for global phase in py_pol model).</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or float) [0, 2*pi]: Array of global phase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate phase</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Ex</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="c1"># Reshape if neccessary</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">phase</span><span class="p">],</span>
                        <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                        <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                        <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The global phase of </span><span class="si">{}</span><span class="s1"> is (deg.):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">phase</span> <span class="o">/</span> <span class="n">degrees</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Global phase (deg.)&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">phase</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.ellipse_axes"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.ellipse_axes">[docs]</a>    <span class="k">def</span> <span class="nf">ellipse_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the length of major and minor axis (a,b) of the polarization elipse.</span>

<span class="sd">        References:</span>
<span class="sd">            D. Golstein &quot;Polarized light&quot; 2nd ed Marcel Dekker (2003), 3.4 eq.3-30a and 3-30b</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            sort (bool): If True, it sorts a and b to be the major and minor axis respectively. Default: True. TODO: Check why this is neccessary.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a (numpy.ndarray or float): Major axis</span>
<span class="sd">            b (numpy.ndarray or float): Minor axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Precalculate necessary parameters</span>
        <span class="n">E0x</span><span class="p">,</span> <span class="n">E0y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amplitudes</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">azimuth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">azimuth</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Calculate the intensity of the axes</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">E0x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">E0y</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span>
            <span class="n">azimuth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">E0x</span> <span class="o">*</span> <span class="n">E0y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span>
                <span class="n">azimuth</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">E0x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">E0y</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span>
            <span class="n">azimuth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">E0x</span> <span class="o">*</span> <span class="n">E0y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span>
                <span class="n">azimuth</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        <span class="c1"># Remove points lower than 0 and calculate field</span>
        <span class="n">a2</span><span class="p">[</span><span class="n">a2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">b2</span><span class="p">[</span><span class="n">b2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">a_aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
        <span class="n">b_aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span>
        <span class="c1"># Order the axes</span>
        <span class="k">if</span> <span class="n">sort</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">a_aux</span><span class="p">,</span> <span class="n">b_aux</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">a_aux</span><span class="p">,</span> <span class="n">b_aux</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a_aux</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b_aux</span>
        <span class="c1"># If the result is a number and the user asks for it, return a float</span>
        <span class="k">if</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Reshape if neccessary</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span>
                       <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                       <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The ellipse axes of </span><span class="si">{}</span><span class="s1"> are (V/m):&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a (V/m)&#39;</span><span class="p">,</span> <span class="s1">&#39;b (V/m)&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.ellipticity_param"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.ellipticity_param">[docs]</a>    <span class="k">def</span> <span class="nf">ellipticity_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the ellipticity parameter: the ratio between the minos and major polarization ellipse axes. It&#39;s 0 for linearly polarized light and 1 for circulary polarized light.</span>

<span class="sd">        References:</span>
<span class="sd">            Handbook of Optics vol 2. 22.16 (eq.7)</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            e (numpy.ndarray or float): Array of length of tellipticity parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the ellipse axes</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_axes</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">a</span>
        <span class="c1"># Reshape if neccessary</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">e</span><span class="p">],</span>
                    <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                    <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The ellipticity parameter of </span><span class="si">{}</span><span class="s1"> is:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">e</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Ellipticity param.&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.eccentricity"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.eccentricity">[docs]</a>    <span class="k">def</span> <span class="nf">eccentricity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the eccentricity, the opposite to the ellipticity parameter. It&#39;s 1 for linearly polarized light and 0 for circulary polarized light.</span>

<span class="sd">        References:</span>
<span class="sd">            Handbook of Optics vol 2. 22.16 (eq.9)</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            e (numpy.ndarray or float): Array of length of tellipticity parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the ellipticity parameter</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipticity_param</span><span class="p">(</span><span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="n">ecc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Reshape if neccessary</span>
        <span class="n">ecc</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">ecc</span><span class="p">],</span>
                      <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                      <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                      <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The eccentricity of </span><span class="si">{}</span><span class="s1"> is:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">ecc</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Eccentricity&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ecc</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.degree_circular_polarization"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.degree_circular_polarization">[docs]</a>    <span class="k">def</span> <span class="nf">degree_circular_polarization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                     <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the degree of circular polarization: a coefficient that measures the amount of circular polarization in the beam.</span>

<span class="sd">        References:</span>
<span class="sd">            J. J. Gil, &quot;Polarized light and the Mueller Matrix approach&quot;, pp 39.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dcp (numpy.ndarray or float): Array of degree of circular polarization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the degree (take into account possible nans)</span>
        <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                 <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                 <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                           <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                           <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">I</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="n">dcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="n">dcp</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">Ex</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">Ey</span><span class="p">[</span><span class="n">cond</span><span class="p">]))</span> <span class="o">/</span> <span class="n">I</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span>
        <span class="c1"># If the result is a number and the user asks for it, return a float</span>
        <span class="k">if</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="n">dcp</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dcp</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The degree of circular polarization of </span><span class="si">{}</span><span class="s1"> is:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">dcp</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Degree circ. pol.&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dcp</span></div>

<div class="viewcode-block" id="Parameters_Jones_Vector.degree_linear_polarization"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Parameters_Jones_Vector.degree_linear_polarization">[docs]</a>    <span class="k">def</span> <span class="nf">degree_linear_polarization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the degree of linear polarization: a coefficient that measures the amount of linear polarization in the beam.</span>

<span class="sd">        References:</span>
<span class="sd">            J. J. Gil, &quot;Polarized light and the Mueller Matrix approach&quot;, pp 39.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dcp (numpy.ndarray or float): Array of degree of circular polarization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the degree</span>
        <span class="n">dcp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree_circular_polarization</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                                                <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                                                <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span>
        <span class="n">dlp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dcp</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;The degree of linear polarization of </span><span class="si">{}</span><span class="s1"> is:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">dlp</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Degree lin. pol.&#39;</span><span class="p">,</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dlp</span></div></div>


<span class="c1">################################################################################</span>
<span class="c1"># Checks</span>
<span class="c1">################################################################################</span>


<div class="viewcode-block" id="Checks_Jones_Vector"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Checks_Jones_Vector">[docs]</a><span class="k">class</span> <span class="nc">Checks_Jones_Vector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for Jones vector checks.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        jones_vector (Jones_vector): Parent object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        self.parent (Jones_vector): Parent object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Jones_vector</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">Jones_vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prints all the checks.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_all</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

<div class="viewcode-block" id="Checks_Jones_Vector.get_all"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Checks_Jones_Vector.get_all">[docs]</a>    <span class="k">def</span> <span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a dictionary with all the checks of Jones vector.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            verbose (bool): If True, print all parameters. Default: False.</span>
<span class="sd">            draw (bool): If True, draw all plots/images of the parameters. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): Dictionary with parameters of Jones vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;is_linear&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_linear</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;is_circular&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_circular</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                           <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;is_right_handed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_right_handed</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;is_left_handed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_left_handed</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span></div>

<div class="viewcode-block" id="Checks_Jones_Vector.is_linear"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Checks_Jones_Vector.is_linear">[docs]</a>    <span class="k">def</span> <span class="nf">is_linear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates if the Jones vector is linearly polarized.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or bool): Array of the condition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the degree of linear polarization</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_linear_polarization</span><span class="p">(</span>
                <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span> <span class="o">-</span>
            <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol_default</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is linearly polarized:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">cond</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Linearly polarized&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">cond</span></div>

<div class="viewcode-block" id="Checks_Jones_Vector.is_circular"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Checks_Jones_Vector.is_circular">[docs]</a>    <span class="k">def</span> <span class="nf">is_circular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates if the Jones vector is circularly polarized.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or bool): Array of the condition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate the degree of linear polarization</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">degree_circular_polarization</span><span class="p">(</span>
                <span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="n">out_number</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol_default</span>
        <span class="c1"># Calculate Ez and reshape if required</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">cond</span><span class="p">],</span>
                       <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                       <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is circcularly polarized:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">cond</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Circularly polarized&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">cond</span></div>

<div class="viewcode-block" id="Checks_Jones_Vector.is_right_handed"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Checks_Jones_Vector.is_right_handed">[docs]</a>    <span class="k">def</span> <span class="nf">is_right_handed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates if the Jones polarization rotation direction is right-handed.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or bool): Array of the condition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># No bool to allow nans</span>
        <span class="c1"># If the Jones vector is linearly polarized, right and left handed is not defined</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_linear</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cond</span><span class="p">[</span><span class="n">cond1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># If delay is between 0 and pi (not included), it is right handed</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="o">~</span><span class="n">cond1</span> <span class="o">*</span> <span class="p">(</span><span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">delay</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">cond</span><span class="p">[</span><span class="n">cond2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Give a number if required</span>
        <span class="k">if</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Calculate Ez and reshape if required</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">cond</span><span class="p">],</span>
                       <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                       <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is right handed:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">cond</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Right handed&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">cond</span></div>

<div class="viewcode-block" id="Checks_Jones_Vector.is_left_handed"><a class="viewcode-back" href="../../py_pol.html#py_pol.jones_vector.Checks_Jones_Vector.is_left_handed">[docs]</a>    <span class="k">def</span> <span class="nf">is_left_handed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">out_number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">shape_like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates if the Jones polarization rotation direction is left-handed.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            out_number (bool): if True and the result is a 1x1 array, return a number instead. Default: True.</span>
<span class="sd">            shape_like (numpy.ndarray or py_pol object): Use the shape of this object. Default: None.</span>
<span class="sd">            shape (tuple or list): If no shape_like array is given, use this shape instead. Default: None.</span>
<span class="sd">            verbose (bool): if True prints the parameter. Default: False.</span>
<span class="sd">            draw (bool): If True and the object is a 1D or 2D, plot it. Default: False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (numpy.ndarray or bool): Array of the condition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># No bool to allow nans</span>
        <span class="c1"># If the Jones vector is linearly polarized, right and left handed is not defined</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_linear</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cond</span><span class="p">[</span><span class="n">cond1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="c1"># If delay is between 0 and pi (not included), it is right handed</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_number</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="o">~</span><span class="n">cond1</span> <span class="o">*</span> <span class="p">(</span><span class="n">delay</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">delay</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">cond</span><span class="p">[</span><span class="n">cond2</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Give a number if required</span>
        <span class="k">if</span> <span class="n">out_number</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Calculate Ez and reshape if required</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">reshape</span><span class="p">([</span><span class="n">cond</span><span class="p">],</span>
                       <span class="n">shape_like</span><span class="o">=</span><span class="n">shape_like</span><span class="p">,</span>
                       <span class="n">shape_fun</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># Print the result if required</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">or</span> <span class="n">draw</span><span class="p">:</span>
            <span class="n">heading</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is left handed:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">PrintParam</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="p">(</span><span class="n">cond</span><span class="p">),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Left handed&#39;</span><span class="p">),</span>
                       <span class="n">heading</span><span class="o">=</span><span class="n">heading</span><span class="p">,</span>
                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                       <span class="n">draw</span><span class="o">=</span><span class="n">draw</span><span class="p">)</span>
        <span class="c1"># Return</span>
        <span class="k">return</span> <span class="n">cond</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Luis Miguel Sanchez Brea / Jesus del Hoyo

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>